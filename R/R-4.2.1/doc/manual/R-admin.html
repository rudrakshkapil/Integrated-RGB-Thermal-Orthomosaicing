<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This manual is for R, version 4.2.1 (2022-06-23).

Copyright (C) 2001-2022 R Core Team

Permission is granted to make and distribute verbatim copies of this
manual provided the copyright notice and this permission notice are
preserved on all copies.

Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the
entire resulting derived work is distributed under the terms of a
permission notice identical to this one.

Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions,
except that this permission notice may be stated in a translation
approved by the R Core Team. -->
<title>R Installation and Administration</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="R Installation and Administration">
<meta name="keywords" content="R Installation and Administration">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="#Top" rel="start" title="Top">
<link href="#Function-and-variable-index" rel="index" title="Function and variable index">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="#Obtaining-R" rel="next" title="Obtaining R">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
body {
    margin-left: 5%;
    margin-right: 5%;
}

h1 {             
    background: white;
    color: rgb(25%, 25%, 25%);
    font-family: monospace;
    font-size: xx-large;
    text-align: center;
}

h2 {
    background: white;
    color: rgb(40%, 40%, 40%);
    font-family: monospace;
    font-size: x-large;
    text-align: center;
}

h3 {
    background: white;
    color: rgb(40%, 40%, 40%);
    font-family: monospace;
    font-size: large;
}

h4 {
    background: white;
    color: rgb(40%, 40%, 40%);
    font-family: monospace;
}

span.samp {
    font-family: monospace;
}

span.command {
    font-family: monospace;
}

span.option {
    font-family: monospace;
}

span.file {
    font-family: monospace;
}

span.env {
    font-family: monospace;
}

ul {
    margin-top: 0.25ex;
    margin-bottom: 0.25ex;
}

li {
    margin-top: 0.25ex;
    margin-bottom: 0.25ex;
}

p {
    margin-top: 0.6ex;
    margin-bottom: 1.2ex;
}

#Top > .header, #Top > h1 {     /* for Texinfo 6.8 */
    display: none
}

-->
</style>


</head>

<body lang="en">
<h1 class="settitle" align="center">R Installation and Administration</h1>






















<div class="top" id="Top">
<div class="header">
<p>
Next: <a href="#Obtaining-R" accesskey="n" rel="next">Obtaining R</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="R-Installation-and-Administration"></span><h1 class="top">R Installation and Administration</h1>

<p>This is a guide to installation and administration for R.
</p>
<p>This manual is for R, version 4.2.1 (2022-06-23).
</p>
<p>Copyright &copy; 2001&ndash;2022 R Core Team
</p>
<blockquote>
<p>Permission is granted to make and distribute verbatim copies of this
manual provided the copyright notice and this permission notice are
preserved on all copies.
</p>
<p>Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the
entire resulting derived work is distributed under the terms of a
permission notice identical to this one.
</p>
<p>Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions,
except that this permission notice may be stated in a translation
approved by the R Core Team.
</p></blockquote>



<div class="Contents_element" id="SEC_Contents">
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">

<ul class="no-bullet">
  <li><a id="toc-Obtaining-R-1" href="#Obtaining-R">1 Obtaining R</a>
  <ul class="no-bullet">
    <li><a id="toc-Getting-and-unpacking-the-sources-1" href="#Getting-and-unpacking-the-sources">1.1 Getting and unpacking the sources</a></li>
    <li><a id="toc-Getting-patched-and-development-versions-1" href="#Getting-patched-and-development-versions">1.2 Getting patched and development versions</a>
    <ul class="no-bullet">
      <li><a id="toc-Using-Subversion-and-rsync-1" href="#Using-Subversion-and-rsync">1.2.1 Using Subversion and rsync</a></li>
    </ul></li>
  </ul></li>
  <li><a id="toc-Installing-R-under-Unix_002dalikes-1" href="#Installing-R-under-Unix_002dalikes">2 Installing R under Unix-alikes</a>
  <ul class="no-bullet">
    <li><a id="toc-Simple-compilation-1" href="#Simple-compilation">2.1 Simple compilation</a></li>
    <li><a id="toc-Help-options-1" href="#Help-options">2.2 Help options</a></li>
    <li><a id="toc-Making-the-manuals-1" href="#Making-the-manuals">2.3 Making the manuals</a></li>
    <li><a id="toc-Installation-1" href="#Installation">2.4 Installation</a></li>
    <li><a id="toc-Uninstallation-1" href="#Uninstallation">2.5 Uninstallation</a></li>
    <li><a id="toc-Sub_002darchitectures-1" href="#Sub_002darchitectures">2.6 Sub-architectures</a>
    <ul class="no-bullet">
      <li><a id="toc-Multilib-1" href="#Multilib">2.6.1 Multilib</a></li>
    </ul></li>
    <li><a id="toc-Other-Options-1" href="#Other-Options">2.7 Other Options</a>
    <ul class="no-bullet">
      <li><a id="toc-Debugging-Symbols-1" href="#Debugging-Symbols">2.7.1 Debugging Symbols</a></li>
      <li><a id="toc-OpenMP-Support-1" href="#OpenMP-Support">2.7.2 OpenMP Support</a></li>
      <li><a id="toc-C_002b_002b-Support-1" href="#C_002b_002b-Support">2.7.3 C++ Support</a></li>
      <li><a id="toc-Link_002dTime-Optimization-1" href="#Link_002dTime-Optimization">2.7.4 Link-Time Optimization</a>
      <ul class="no-bullet">
        <li><a id="toc-LTO-with-GCC-1" href="#LTO-with-GCC">2.7.4.1 LTO with GCC</a></li>
        <li><a id="toc-LTO-with-LLVM-1" href="#LTO-with-LLVM">2.7.4.2 LTO with LLVM</a></li>
        <li><a id="toc-LTO-for-package-checking-1" href="#LTO-for-package-checking">2.7.4.3 LTO for package checking</a></li>
      </ul></li>
    </ul></li>
    <li><a id="toc-Testing-an-Installation" href="#Testing-a-Unix_002dalike-Installation">2.8 Testing an Installation</a></li>
  </ul></li>
  <li><a id="toc-Installing-R-under-Windows-1" href="#Installing-R-under-Windows">3 Installing R under Windows</a>
  <ul class="no-bullet">
    <li><a id="toc-Building-from-source-1" href="#Building-from-source">3.1 Building from source</a>
    <ul class="no-bullet">
      <li><a id="toc-The-Windows-toolset-1" href="#The-Windows-toolset">3.1.1 The Windows toolset</a></li>
      <li><a id="toc-LaTeX" href="#LaTeX-on-Windows">3.1.2 LaTeX</a></li>
    </ul></li>
    <li><a id="toc-Checking-the-build-1" href="#Checking-the-build">3.2 Checking the build</a></li>
    <li><a id="toc-Testing-an-Installation-1" href="#Testing-a-Windows-Installation">3.3 Testing an Installation</a></li>
  </ul></li>
  <li><a id="toc-Installing-R-under-macOS-1" href="#Installing-R-under-macOS">4 Installing R under macOS</a>
  <ul class="no-bullet">
    <li><a id="toc-Running-R-under-macOS-1" href="#Running-R-under-macOS">4.1 Running R under macOS</a></li>
    <li><a id="toc-Uninstalling-under-macOS-1" href="#Uninstalling-under-macOS">4.2 Uninstalling under macOS</a></li>
    <li><a id="toc-Multiple-versions-1" href="#Multiple-versions">4.3 Multiple versions</a></li>
  </ul></li>
  <li><a id="toc-Running-R-1" href="#Running-R">5 Running R</a></li>
  <li><a id="toc-Add_002don-packages-1" href="#Add_002don-packages">6 Add-on packages</a>
  <ul class="no-bullet">
    <li><a id="toc-Default-packages-1" href="#Default-packages">6.1 Default packages</a></li>
    <li><a id="toc-Managing-libraries-1" href="#Managing-libraries">6.2 Managing libraries</a></li>
    <li><a id="toc-Installing-packages-1" href="#Installing-packages">6.3 Installing packages</a>
    <ul class="no-bullet">
      <li><a id="toc-Windows" href="#Windows-packages">6.3.1 Windows</a></li>
      <li><a id="toc-macOS-1" href="#macOS-packages">6.3.2 macOS</a></li>
      <li><a id="toc-Customizing-package-compilation-1" href="#Customizing-package-compilation">6.3.3 Customizing package compilation</a></li>
      <li><a id="toc-Multiple-sub_002darchitectures-1" href="#Multiple-sub_002darchitectures">6.3.4 Multiple sub-architectures</a></li>
      <li><a id="toc-Byte_002dcompilation-1" href="#Byte_002dcompilation">6.3.5 Byte-compilation</a></li>
      <li><a id="toc-External-software-1" href="#External-software">6.3.6 External software</a></li>
    </ul></li>
    <li><a id="toc-Updating-packages-1" href="#Updating-packages">6.4 Updating packages</a></li>
    <li><a id="toc-Removing-packages-1" href="#Removing-packages">6.5 Removing packages</a></li>
    <li><a id="toc-Setting-up-a-package-repository-1" href="#Setting-up-a-package-repository">6.6 Setting up a package repository</a></li>
    <li><a id="toc-Checking-installed-source-packages-1" href="#Checking-installed-source-packages">6.7 Checking installed source packages</a></li>
  </ul></li>
  <li><a id="toc-Internationalization-and-Localization" href="#Internationalization">7 Internationalization and Localization</a>
  <ul class="no-bullet">
    <li><a id="toc-Locales-1" href="#Locales">7.1 Locales</a>
    <ul class="no-bullet">
      <li><a id="toc-Locales-under-Unix_002dalikes-1" href="#Locales-under-Unix_002dalikes">7.1.1 Locales under Unix-alikes</a></li>
      <li><a id="toc-Locales-under-Windows-1" href="#Locales-under-Windows">7.1.2 Locales under Windows</a></li>
      <li><a id="toc-Locales-under-macOS-1" href="#Locales-under-macOS">7.1.3 Locales under macOS</a></li>
    </ul></li>
    <li><a id="toc-Localization-of-messages-1" href="#Localization-of-messages">7.2 Localization of messages</a></li>
  </ul></li>
  <li><a id="toc-Choosing-between-32_002d-and-64_002dbit-builds-1" href="#Choosing-between-32_002d-and-64_002dbit-builds">8 Choosing between 32- and 64-bit builds</a></li>
  <li><a id="toc-The-standalone-Rmath-library-1" href="#The-standalone-Rmath-library">9 The standalone Rmath library</a>
  <ul class="no-bullet">
    <li><a id="toc-Unix_002dalikes" href="#Unix_002dalike-standalone">9.1 Unix-alikes</a></li>
    <li><a id="toc-Windows-1" href="#Windows-standalone">9.2 Windows</a></li>
  </ul></li>
  <li><a id="toc-Essential-and-useful-other-programs-under-a-Unix_002dalike-1" href="#Essential-and-useful-other-programs-under-a-Unix_002dalike">Appendix A Essential and useful other programs under a Unix-alike</a>
  <ul class="no-bullet">
    <li><a id="toc-Essential-programs-and-libraries-1" href="#Essential-programs-and-libraries">A.1 Essential programs and libraries</a></li>
    <li><a id="toc-Useful-libraries-and-programs-1" href="#Useful-libraries-and-programs">A.2 Useful libraries and programs</a>
    <ul class="no-bullet">
      <li><a id="toc-Tcl_002fTk-1" href="#Tcl_002fTk">A.2.1 Tcl/Tk</a></li>
      <li><a id="toc-Java-support-1" href="#Java-support">A.2.2 Java support</a></li>
      <li><a id="toc-Other-compiled-languages-1" href="#Other-compiled-languages">A.2.3 Other compiled languages</a></li>
    </ul></li>
    <li><a id="toc-Linear-algebra-1" href="#Linear-algebra">A.3 Linear algebra</a>
    <ul class="no-bullet">
      <li><a id="toc-BLAS-1" href="#BLAS">A.3.1 BLAS</a>
      <ul class="no-bullet">
        <li><a id="toc-ATLAS-1" href="#ATLAS">A.3.1.1 ATLAS</a></li>
        <li><a id="toc-OpenBLAS-and-BLIS-1" href="#OpenBLAS-and-BLIS">A.3.1.2 OpenBLAS and BLIS</a></li>
        <li><a id="toc-Intel-MKL" href="#MKL">A.3.1.3 Intel MKL</a></li>
        <li><a id="toc-Shared-BLAS-1" href="#Shared-BLAS">A.3.1.4 Shared BLAS</a></li>
      </ul></li>
      <li><a id="toc-LAPACK-1" href="#LAPACK">A.3.2 LAPACK</a></li>
      <li><a id="toc-Caveats-1" href="#Caveats">A.3.3 Caveats</a></li>
    </ul></li>
  </ul></li>
  <li><a id="toc-Configuration-on-a-Unix_002dalike-1" href="#Configuration-on-a-Unix_002dalike">Appendix B Configuration on a Unix-alike</a>
  <ul class="no-bullet">
    <li><a id="toc-Configuration-options-1" href="#Configuration-options">B.1 Configuration options</a></li>
    <li><a id="toc-Internationalization-support-1" href="#Internationalization-support">B.2 Internationalization support</a></li>
    <li><a id="toc-Configuration-variables-1" href="#Configuration-variables">B.3 Configuration variables</a>
    <ul class="no-bullet">
      <li><a id="toc-Setting-paper-size-1" href="#Setting-paper-size">B.3.1 Setting paper size</a></li>
      <li><a id="toc-Setting-the-browsers-1" href="#Setting-the-browsers">B.3.2 Setting the browsers</a></li>
      <li><a id="toc-Compilation-flags-1" href="#Compilation-flags">B.3.3 Compilation flags</a></li>
      <li><a id="toc-Making-manuals-1" href="#Making-manuals">B.3.4 Making manuals</a></li>
    </ul></li>
    <li><a id="toc-Setting-the-shell-1" href="#Setting-the-shell">B.4 Setting the shell</a></li>
    <li><a id="toc-Using-make-1" href="#Using-make">B.5 Using make</a></li>
    <li><a id="toc-Using-Fortran-1" href="#Using-Fortran">B.6 Using Fortran</a></li>
    <li><a id="toc-Compile-and-load-flags-1" href="#Compile-and-load-flags">B.7 Compile and load flags</a></li>
    <li><a id="toc-Maintainer-mode-1" href="#Maintainer-mode">B.8 Maintainer mode</a></li>
  </ul></li>
  <li><a id="toc-Platform-notes-1" href="#Platform-notes">Appendix C Platform notes</a>
  <ul class="no-bullet">
    <li><a id="toc-X11-issues-1" href="#X11-issues">C.1 X11 issues</a></li>
    <li><a id="toc-Linux-1" href="#Linux">C.2 Linux</a>
    <ul class="no-bullet">
      <li><a id="toc-Clang-1" href="#Clang">C.2.1 Clang</a></li>
      <li><a id="toc-Intel-compilers-1" href="#Intel-compilers">C.2.2 Intel compilers</a></li>
    </ul></li>
    <li><a id="toc-macOS-2" href="#macOS">C.3 macOS</a>
    <ul class="no-bullet">
      <li><a id="toc-Prerequisites-1" href="#Prerequisites">C.3.1 Prerequisites</a>
      <ul class="no-bullet">
        <li><a id="toc-Note-for-Catalina-and-later-1" href="#Note-for-Catalina-and-later">C.3.1.1 Note for Catalina and later</a></li>
      </ul></li>
      <li><a id="toc-Fortran-compilers-1" href="#Fortran-compilers">C.3.2 Fortran compilers</a></li>
      <li><a id="toc-Cairo-graphics-1" href="#Cairo-graphics">C.3.3 Cairo graphics</a></li>
      <li><a id="toc-Other-C_002fC_002b_002b-compilers-1" href="#Other-C_002fC_002b_002b-compilers">C.3.4 Other C/C++ compilers</a></li>
      <li><a id="toc-Other-libraries-1" href="#Other-libraries">C.3.5 Other libraries</a></li>
      <li><a id="toc-Tcl_002fTk-headers-and-libraries-1" href="#Tcl_002fTk-headers-and-libraries">C.3.6 Tcl/Tk headers and libraries</a></li>
      <li><a id="toc-Java" href="#Java-_0028macOS_0029">C.3.7 Java</a></li>
      <li><a id="toc-Frameworks-1" href="#Frameworks">C.3.8 Frameworks</a></li>
      <li><a id="toc-Building-R_002eapp-1" href="#Building-R_002eapp">C.3.9 Building R.app</a></li>
      <li><a id="toc-Building-binary-packages-1" href="#Building-binary-packages">C.3.10 Building binary packages</a></li>
      <li><a id="toc-Building-for-Intel-on-arm64-1" href="#Building-for-Intel-on-arm64">C.3.11 Building for Intel on &lsquo;<samp>arm64</samp>&rsquo;</a></li>
      <li><a id="toc-Installer-1" href="#Installer">C.3.12 Installer</a></li>
    </ul></li>
    <li><a id="toc-FreeBSD-1" href="#FreeBSD">C.4 FreeBSD</a></li>
    <li><a id="toc-OpenBSD-1" href="#OpenBSD">C.5 OpenBSD</a></li>
    <li><a id="toc-Cygwin-1" href="#Cygwin">C.6 Cygwin</a></li>
    <li><a id="toc-New-platforms-1" href="#New-platforms">C.7 New platforms</a></li>
  </ul></li>
  <li><a id="toc-Function-and-variable-index-1" href="#Function-and-variable-index" rel="index">Function and variable index</a></li>
  <li><a id="toc-Concept-index-1" href="#Concept-index" rel="index">Concept index</a></li>
  <li><a id="toc-Environment-variable-index-1" href="#Environment-variable-index" rel="index">Environment variable index</a></li>
</ul>
</div>
</div>
<hr>
<div class="chapter" id="Obtaining-R">
<div class="header">
<p>
Next: <a href="#Installing-R-under-Unix_002dalikes" accesskey="n" rel="next">Installing R under Unix-alikes</a>, Previous: <a href="#Top" accesskey="p" rel="prev">R Installation and Administration</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Obtaining-R-1"></span><h2 class="chapter">1 Obtaining R</h2>
<span id="index-Obtaining-R"></span>

<p>Sources, binaries and documentation for R can be obtained via
<acronym>CRAN</acronym>, the &ldquo;Comprehensive R Archive Network&rdquo; whose current
members are listed at <a href="https://CRAN.R-project.org/mirrors.html">https://CRAN.R-project.org/mirrors.html</a>.
</p>

<ul class="section-toc">
<li><a href="#Getting-and-unpacking-the-sources" accesskey="1">Getting and unpacking the sources</a></li>
<li><a href="#Getting-patched-and-development-versions" accesskey="2">Getting patched and development versions</a></li>
</ul>
<hr>
<div class="section" id="Getting-and-unpacking-the-sources">
<div class="header">
<p>
Next: <a href="#Getting-patched-and-development-versions" accesskey="n" rel="next">Getting patched and development versions</a>, Previous: <a href="#Obtaining-R" accesskey="p" rel="prev">Obtaining R</a>, Up: <a href="#Obtaining-R" accesskey="u" rel="up">Obtaining R</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Getting-and-unpacking-the-sources-1"></span><h3 class="section">1.1 Getting and unpacking the sources</h3>
<span id="index-Sources-for-R"></span>

<p>The simplest way is to download the most recent
<samp>R-<var>x</var>.<var>y</var>.<var>z</var>.tar.gz</samp> file, and unpack it with
</p>
<div class="example">
<pre class="example">tar -xf R-<var>x</var>.<var>y</var>.<var>z</var>.tar.gz
</pre></div>

<p>on systems that have a suitable<a id="DOCF1" href="#FOOT1"><sup>1</sup></a>
<code>tar</code> installed.  On other systems you need to have the
<code>gzip</code> program installed, when you can use
</p>
<div class="example">
<pre class="example">gzip -dc R-<var>x</var>.<var>y</var>.<var>z</var>.tar.gz | tar -xf -
</pre></div>

<p>The pathname of the directory into which the sources are unpacked should
not contain spaces, as most <code>make</code> programs (and specifically
<acronym>GNU</acronym> <code>make</code>) do not expect spaces.
</p>
<p>If you want the build to be usable by a group of users, set <code>umask</code>
before unpacking so that the files will be readable by the target group
(e.g., <code>umask 022</code> to be usable by all users).  Keep this
setting of <code>umask</code> whilst building and installing.
</p>
<p>If you use a fairly recent <acronym>GNU</acronym> version of <code>tar</code> and do
this as a root account (which on Windows includes accounts with
administrator privileges) you may see many warnings about changing
ownership.  In which case you can use
</p>
<div class="example">
<pre class="example">tar --no-same-owner -xf R-<var>x</var>.<var>y</var>.<var>z</var>.tar.gz
</pre></div>

<p>and perhaps also include the option <samp>--no-same-permissions</samp>.
<span id="index-TAR_005fOPTIONS"></span>
(These options can also be set in the <code>TAR_OPTIONS</code> environment
variable: if more than one option is included they should be separated
by spaces.)
</p>


<hr>
</div>
<div class="section" id="Getting-patched-and-development-versions">
<div class="header">
<p>
Previous: <a href="#Getting-and-unpacking-the-sources" accesskey="p" rel="prev">Getting and unpacking the sources</a>, Up: <a href="#Obtaining-R" accesskey="u" rel="up">Obtaining R</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Getting-patched-and-development-versions-1"></span><h3 class="section">1.2 Getting patched and development versions</h3>

<p>A patched version of the current release, &lsquo;<samp>r-patched</samp>&rsquo;, and the
current development version, &lsquo;<samp>r-devel</samp>&rsquo;, are available as daily
tarballs and via access to the R Subversion repository.  (For the two
weeks prior to the release of a minor (4.x.0) version, &lsquo;<samp>r-patched</samp>&rsquo;
tarballs may refer to beta/release candidates of the upcoming release,
the patched version of the current release being available via
Subversion.)
</p>
<p>The tarballs are available from
<a href="https://stat.ethz.ch/R/daily/">https://stat.ethz.ch/R/daily/</a>.  Download
<samp>R-patched.tar.gz</samp> or <samp>R-devel.tar.gz</samp> (or the <samp>.tar.bz2</samp>
versions) and unpack as described in the previous section.  They are
built in exactly the same way as distributions of R releases.
</p>

<ul class="section-toc">
<li><a href="#Using-Subversion-and-rsync" accesskey="1">Using Subversion and rsync</a></li>
</ul>
<hr>
<div class="subsection" id="Using-Subversion-and-rsync">
<div class="header">
<p>
Previous: <a href="#Getting-patched-and-development-versions" accesskey="p" rel="prev">Getting patched and development versions</a>, Up: <a href="#Getting-patched-and-development-versions" accesskey="u" rel="up">Getting patched and development versions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Using-Subversion-and-rsync-1"></span><h4 class="subsection">1.2.1 Using Subversion and rsync</h4>
<span id="index-Subversion"></span>

<p>Sources are also available via <a href="https://svn.R-project.org/R/">https://svn.R-project.org/R/</a>, the
R Subversion repository.  If you have a Subversion client (see
<a href="https://subversion.apache.org/">https://subversion.apache.org/</a>), you can check out and update the
current &lsquo;<samp>r-devel</samp>&rsquo; from
<a href="https://svn.r-project.org/R/trunk/">https://svn.r-project.org/R/trunk/</a> and the current
&lsquo;<samp>r-patched</samp>&rsquo; from
&lsquo;<samp>https://svn.r-project.org/R/branches/R-<var>x</var>-<var>y</var>-branch/</samp>&rsquo;
(where <var>x</var> and <var>y</var> are the major and minor number of the current
released version of R).  E.g., use
</p>
<div class="example">
<pre class="example">svn checkout https://svn.r-project.org/R/trunk/ <var>path</var>
</pre></div>

<p>to check out &lsquo;<samp>r-devel</samp>&rsquo; into directory <var>path</var> (which will be
created if necessary).  The alpha, beta and RC versions of an upcoming
<var>x.y.0</var> release are available from
&lsquo;<samp>https://svn.r-project.org/R/branches/R-<var>x</var>-<var>y</var>-branch/</samp>&rsquo; in
the four-week period prior to the release.
</p>
<p>Note that &lsquo;<samp>https:</samp>&rsquo; is required<a id="DOCF2" href="#FOOT2"><sup>2</sup></a>,
and that the SSL certificate for the Subversion server of the R
project should be recognized as from a trusted source.
</p>
<p>Note that retrieving the sources by e.g. <code>wget -r</code> or
<code>svn export</code> from that URL will not work (and will give a error
early in the <code>make</code> process): the Subversion information is
needed to build R.
</p>
<p>The Subversion repository does not contain the current sources for the
recommended packages, which can be obtained by <code>rsync</code> or
downloaded from <acronym>CRAN</acronym>.  To use <code>rsync</code> to install the
appropriate sources for the recommended packages, run
<code>./tools/rsync-recommended</code> from the top-level directory of the
R sources.
</p>
<p>If downloading manually from <acronym>CRAN</acronym>, do ensure that you have the
correct versions of the recommended packages: if the number in the file
<samp>VERSION</samp> is &lsquo;<samp><var>x</var>.<var>y</var>.<var>z</var></samp>&rsquo; you need to download
the contents of &lsquo;<samp>https://CRAN.R-project.org/src/contrib/<var>dir</var></samp>&rsquo;,
where <var>dir</var> is &lsquo;<samp><var>x</var>.<var>y</var>.<var>z</var>/Recommended</samp>&rsquo; for
r-devel or <samp><var>x</var>.<var>y</var>-patched/Recommended</samp> for r-patched,
respectively, to directory <samp>src/library/Recommended</samp> in the sources
you have unpacked.  After downloading manually you need to execute
<code>tools/link-recommended</code> from the top level of the sources to
make the requisite links in <samp>src/library/Recommended</samp>.  A suitable
incantation from the top level of the R sources using <code>wget</code>
might be (for the correct value of <samp><var>dir</var></samp>)
</p>
<div class="example">
<pre class="example">wget -r -l1 --no-parent -A\*.gz -nd -P src/library/Recommended \
  https://CRAN.R-project.org/src/contrib/<var>dir</var>
./tools/link-recommended
</pre></div>



<hr>
</div>
</div>
</div>
<div class="chapter" id="Installing-R-under-Unix_002dalikes">
<div class="header">
<p>
Next: <a href="#Installing-R-under-Windows" accesskey="n" rel="next">Installing R under Windows</a>, Previous: <a href="#Obtaining-R" accesskey="p" rel="prev">Obtaining R</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Installing-R-under-Unix_002dalikes-1"></span><h2 class="chapter">2 Installing R under Unix-alikes</h2>
<span id="index-Installing-under-Unix_002dalikes"></span>

<p>R will configure and build under most common Unix and Unix-alike
platforms including &lsquo;<samp><var>cpu</var>-*-linux-gnu</samp>&rsquo; for the
&lsquo;<samp>alpha</samp>&rsquo;, &lsquo;<samp>arm64</samp>&rsquo;, &lsquo;<samp>hppa</samp>&rsquo;, &lsquo;<samp>ix86</samp>&rsquo;,
&lsquo;<samp>m68k</samp>&rsquo;, &lsquo;<samp>mips</samp>&rsquo;, &lsquo;<samp>mipsel</samp>&rsquo;#, &lsquo;<samp>ppc64</samp>&rsquo;,
&lsquo;<samp>s390x</samp>&rsquo;, &lsquo;<samp>sparc64</samp>&rsquo;, and &lsquo;<samp>x86_64</samp>&rsquo; <acronym>CPU</acronym>s,
&lsquo;<samp>x86_64-apple-darwin</samp>&rsquo; and
&lsquo;<samp>aarch64-apple-darwin</samp>&rsquo;<a id="DOCF3" href="#FOOT3"><sup>3</sup></a>  as well as perhaps (it is
tested less frequently on these platforms) &lsquo;<samp>i386-sun-solaris</samp>&rsquo;,
&lsquo;<samp>i386-*-freebsd</samp>&rsquo;, &lsquo;<samp>x86_64-*-freebsd</samp>&rsquo;,
&lsquo;<samp>i386-*-netbsd</samp>&rsquo;, &lsquo;<samp>x86_64-*-openbsd</samp>&rsquo; and
&lsquo;<samp>powerpc-ibm-aix6*</samp>&rsquo;
</p>
<span id="index-Linux"></span>
<span id="index-macOS"></span>
<p>In addition, binary distributions are available for some common Linux
distributions (see the <acronym>FAQ</acronym> for current details) and for
macOS.  These are installed in platform-specific ways, so for the rest
of this chapter we consider only building from the sources.
</p>
<p>Cross-building is not possible: installing R builds a minimal version
of R and then runs many R scripts to complete the build.
</p>

<ul class="section-toc">
<li><a href="#Simple-compilation" accesskey="1">Simple compilation</a></li>
<li><a href="#Help-options" accesskey="2">Help options</a></li>
<li><a href="#Making-the-manuals" accesskey="3">Making the manuals</a></li>
<li><a href="#Installation" accesskey="4">Installation</a></li>
<li><a href="#Uninstallation" accesskey="5">Uninstallation</a></li>
<li><a href="#Sub_002darchitectures" accesskey="6">Sub-architectures</a></li>
<li><a href="#Other-Options" accesskey="7">Other Options</a></li>
<li><a href="#Testing-a-Unix_002dalike-Installation" accesskey="8">Testing an Installation</a></li>
</ul>
<hr>
<div class="section" id="Simple-compilation">
<div class="header">
<p>
Next: <a href="#Help-options" accesskey="n" rel="next">Help options</a>, Previous: <a href="#Installing-R-under-Unix_002dalikes" accesskey="p" rel="prev">Installing R under Unix-alikes</a>, Up: <a href="#Installing-R-under-Unix_002dalikes" accesskey="u" rel="up">Installing R under Unix-alikes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Simple-compilation-1"></span><h3 class="section">2.1 Simple compilation</h3>

<p>First review the essential and useful tools and libraries in
<a href="#Essential-and-useful-other-programs-under-a-Unix_002dalike">Essential and useful other programs under a Unix-alike</a>, and install
those you
<span id="index-TMPDIR"></span>
want or need.  Ensure that either the environment variable <code>TMPDIR</code>
is either unset (and <samp>/tmp</samp> exists and can be written in and
scripts can be executed from) or points to the absolute path to a valid
temporary directory (one from which execution of scripts is allowed)
which does not contain spaces.<a id="DOCF4" href="#FOOT4"><sup>4</sup></a>
</p>
<span id="index-R_005fHOME"></span>
<p>Choose a directory to install the R tree (R is not just a binary, but
has additional data sets, help files, font metrics etc).  Let us call
this place <var>R_HOME</var>.  Untar the source code.  This should create
directories <samp>src</samp>, <samp>doc</samp>, and several more under a top-level
directory: change to that top-level directory (At this point North
American readers should consult <a href="#Setting-paper-size">Setting paper size</a>.)  Issue the
following commands:
</p>
<span id="index-configure"></span>

<div class="example">
<pre class="example">./configure
make
</pre></div>

<p>(See <a href="#Using-make">Using make</a> if your make is not called &lsquo;<samp>make</samp>&rsquo;.)  Users of
Debian-based 64-bit systems<a id="DOCF5" href="#FOOT5"><sup>5</sup></a> may need
</p>
<div class="example">
<pre class="example">./configure LIBnn=lib
make
</pre></div>


<p>Then check the built system works correctly by
</p>
<div class="example">
<pre class="example">make check
</pre></div>

<p>Failures are not necessarily problems as they might be caused by missing
functionality, but you should look carefully at any reported
discrepancies.  (Some non-fatal errors are expected in locales that do
not support Latin-1, in particular in true <code>C</code> locales and
non-UTF-8 non-Western-European locales.)  A failure in
<samp>tests/ok-errors.R</samp> may indicate inadequate resource limits
(see <a href="#Running-R">Running R</a>).
</p>
<p>More comprehensive testing can be done by
</p>
<div class="example">
<pre class="example">make check-devel
</pre></div>

<p>or
</p>
<div class="example">
<pre class="example">make check-all
</pre></div>

<p>see file <samp>tests/README</samp> and <a href="#Testing-a-Unix_002dalike-Installation">Testing an Installation</a>
for the possibilities of doing this in parallel.  Note that these checks
are only run completely if the recommended packages are installed.  If
you have a local CRAN mirror, these checks can be speeded up by either
setting environment variable <code>R_CRAN_WEB</code> to its URL, or having a
file <samp>.R/repositories</samp> specifying it (see <code>?setRepositories</code>).
</p>
<p>If the <code>configure</code> and <code>make</code> commands execute
successfully, a shell-script front-end called <samp>R</samp> will be created
and copied to <samp><var>R_HOME</var>/bin</samp>.  You can link or copy this script
to a place where users can invoke it, for example to
<samp>/usr/local/bin/R</samp>.  You could also copy the man page <samp>R.1</samp> to
a place where your <code>man</code> reader finds it, such as
<samp>/usr/local/man/man1</samp>.  If you want to install the complete R
tree to, e.g., <samp>/usr/local/lib/R</samp>, see <a href="#Installation">Installation</a>.  Note:
you do not <em>need</em> to install R: you can run it from where it was
built.
</p>
<p>You do not necessarily have to build R in the top-level source
directory (say, <samp><var>TOP_SRCDIR</var></samp>).  To build in
<samp><var>BUILDDIR</var></samp>, run
</p>
<span id="index-configure-1"></span>

<div class="example">
<pre class="example">cd <var>BUILDDIR</var>
<var>TOP_SRCDIR</var>/configure
make
</pre></div>

<p>and so on, as described further below.  This has the advantage of always
keeping your source tree clean and is particularly recommended when you
work with a version of R from Subversion.  (You may need
<acronym>GNU</acronym> <code>make</code> to allow this, and you will need no spaces
in the path to the build directory.  It is unlikely to work if the
source directory has previously been used for a build.)
</p>
<p>There are many settings which can be customized when building R and
most are described in the file <samp>config.site</samp> in the top-level
source directory.  This can be edited, but for an installation using
<samp><var>BUILDDIR</var></samp> it is better to put the changed settings in a
newly-created file <samp>config.site</samp> in the build directory.
</p>



<p>Now <code>rehash</code> if necessary, type <kbd>R</kbd>, and read the R manuals
and the R <acronym>FAQ</acronym> (files <samp>FAQ</samp> or
<samp>doc/manual/R-FAQ.html</samp>, or
<a href="https://CRAN.R-project.org/doc/FAQ/R-FAQ.html">https://CRAN.R-project.org/doc/FAQ/R-FAQ.html</a> which always
has the version for the latest release of R).
</p>
<p>Note: if you already have R installed, check that where you installed
R replaces or comes earlier in your path than the previous
installation.  Some systems are set up to have <samp>/usr/bin</samp> (the
standard place for a system installation) ahead of <samp>/usr/local/bin</samp>
(the default place for installation of R) in their default path, and
some do not have <samp>/usr/local/bin</samp> on the default path.
</p>
<hr>
</div>
<div class="section" id="Help-options">
<div class="header">
<p>
Next: <a href="#Making-the-manuals" accesskey="n" rel="next">Making the manuals</a>, Previous: <a href="#Simple-compilation" accesskey="p" rel="prev">Simple compilation</a>, Up: <a href="#Installing-R-under-Unix_002dalikes" accesskey="u" rel="up">Installing R under Unix-alikes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Help-options-1"></span><h3 class="section">2.2 Help options</h3>

<p>R by default provides help pages as plain text displayed in a pager,
with the options (see the help for <code>help</code>) of displaying help as
HTML or PDF.
</p>
<p>By default <acronym>HTML</acronym> help pages are created when needed rather than being
built at install time.
</p>
<p>If you need to disable the server and want <acronym>HTML</acronym> help, there is the
option to build <acronym>HTML</acronym> pages when packages are installed
(including those installed with R).  This is enabled by the
<code>configure</code> option <samp>--enable-prebuilt-html</samp>.  Whether
<code>R CMD INSTALL</code> (and hence <code>install.packages</code>) pre-builds
<acronym>HTML</acronym> pages is determined by looking at the R installation and is
reported by <code>R CMD INSTALL --help</code>: it can be overridden by
specifying one of the <code>INSTALL</code> options <samp>--html</samp> or
<samp>--no-html</samp>.
</p>
<p>The server is disabled by setting the environment variable
<span id="index-R_005fDISABLE_005fHTTPD"></span>
<code>R_DISABLE_HTTPD</code> to a non-empty value, either before R is
started or within the R session before <acronym>HTML</acronym> help (including
<code>help.start</code>) is used.  It is also possible that system security
measures will prevent the server from being started, for example if the
loopback interface has been disabled.  See
<code>?tools::startDynamicHelp</code> for more details.
</p>
<hr>
</div>
<div class="section" id="Making-the-manuals">
<div class="header">
<p>
Next: <a href="#Installation" accesskey="n" rel="next">Installation</a>, Previous: <a href="#Help-options" accesskey="p" rel="prev">Help options</a>, Up: <a href="#Installing-R-under-Unix_002dalikes" accesskey="u" rel="up">Installing R under Unix-alikes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Making-the-manuals-1"></span><h3 class="section">2.3 Making the manuals</h3>
<span id="index-Manuals"></span>

<p>There is a set of manuals that can be built from the sources,
</p>
<dl compact="compact">
<dt><span>&lsquo;<samp>fullrefman</samp>&rsquo;</span></dt>
<dd><p>Printed versions of all the help pages for base and recommended packages
(around 3750 pages).
</p></dd>
<dt><span>&lsquo;<samp>refman</samp>&rsquo;</span></dt>
<dd><p>Printed versions of the help pages for selected base packages (around
2200 pages)
</p></dd>
<dt><span>&lsquo;<samp>R-FAQ</samp>&rsquo;</span></dt>
<dd><p>R <acronym>FAQ</acronym>
</p></dd>
<dt><span>&lsquo;<samp>R-intro</samp>&rsquo;</span></dt>
<dd><p>&ldquo;An Introduction to R&rdquo;.
</p></dd>
<dt><span>&lsquo;<samp>R-data</samp>&rsquo;</span></dt>
<dd><p>&ldquo;R Data Import/Export&rdquo;.
</p></dd>
<dt><span>&lsquo;<samp>R-admin</samp>&rsquo;</span></dt>
<dd><p>&ldquo;R Installation and Administration&rdquo;, this manual.
</p></dd>
<dt><span>&lsquo;<samp>R-exts</samp>&rsquo;</span></dt>
<dd><p>&ldquo;Writing R Extensions&rdquo;.
</p></dd>
<dt><span>&lsquo;<samp>R-lang</samp>&rsquo;</span></dt>
<dd><p>&ldquo;The R Language Definition&rdquo;.
</p></dd>
</dl>

<p>To make these (with &lsquo;<samp>fullrefman</samp>&rsquo; rather than &lsquo;<samp>refman</samp>&rsquo;), use
</p>
<div class="example">
<pre class="example">make pdf      <span class="roman">to create PDF versions</span>
make info     <span class="roman">to create info files (not &lsquo;<samp>refman</samp>&rsquo; nor &lsquo;<samp>fullrefman</samp>&rsquo;).</span>
</pre></div>

<p>You will not be able to build any of these unless you have
<code>texi2any</code> version 5.1 or later installed, and for PDF you must
have <code>texi2dvi</code> and <samp>texinfo.tex</samp> installed (which are part
of the <acronym>GNU</acronym> <strong>texinfo</strong> distribution but are, especially
<samp>texinfo.tex</samp>, often made part of the TeX package in
re-distributions).  The path to <code>texi2any</code> can be set by macro
&lsquo;<samp>TEXI2ANY</samp>&rsquo; in <samp>config.site</samp>.  NB: <code>texi2any</code> requires
<code>perl</code>.
</p>
<p>The PDF versions can be viewed using any recent PDF viewer: they have
hyperlinks that can be followed.  The info files are suitable for
reading online with Emacs or the standalone <acronym>GNU</acronym> <code>info</code>
program.  The PDF versions will be created using the paper size selected
at configuration (default ISO a4): this can be overridden by setting
<code>R_PAPERSIZE</code>
<span id="index-R_005fPAPERSIZE"></span>
on the <code>make</code> command line, or setting <code>R_PAPERSIZE</code> in the
environment and using <code>make -e</code>.  (If re-making the manuals for
a different paper size, you should first delete the file
<samp>doc/manual/version.texi</samp>.  The usual value for North America would
be &lsquo;<samp>letter</samp>&rsquo;.)
</p>
<p>There are some issues with making the PDF reference manual,
<samp>fullrefman.pdf</samp> or <samp>refman.pdf</samp>.  The help files contain both
non-ASCII characters (e.g. in <samp>text.Rd</samp>) and upright quotes,
neither of which are contained in the standard LaTeX Computer Modern
fonts.  We have provided the following alternatives:
</p>
<dl compact="compact">
<dt><span><code>times</code></span></dt>
<dd><p>(The default.) Using standard PostScript fonts, Times Roman, Helvetica
and Courier.  This works well both for on-screen viewing and for
printing.  One disadvantage is that the Usage and Examples sections may
come out rather wide: this can be overcome by using <em>in addition</em>
either of the options <code>inconsolata</code> (on a Unix-alike only if found
by <code>configure</code>) or <code>beramono</code>, which replace the Courier
monospaced font by Inconsolata or Bera Sans mono respectively.  (You
will need the LaTeX package <strong>inconsolata</strong><a id="DOCF6" href="#FOOT6"><sup>6</sup></a> or
<strong>bera</strong> installed.)
</p>
<p>Note that in most LaTeX installations this will not actually use the
standard fonts for PDF, but rather embed the URW clones NimbusRom,
NimbusSans and (for Courier, if used) NimbusMon.
</p>
<p>This needs LaTeX packages <strong>times</strong>, <strong>helvetic</strong> and (if used)
<strong>courier</strong> installed.
</p>
</dd>
<dt><span><code>lm</code></span></dt>
<dd><p>Using the <em>Latin Modern</em> fonts.  These are not often installed as
part of a TeX distribution, but can obtained from
<a href="https://www.ctan.org/tex-archive/fonts/ps-type1/lm/">https://www.ctan.org/tex-archive/fonts/ps-type1/lm/</a> and
mirrors.  This uses fonts rather similar to Computer Modern, but is not
so good on-screen as <code>times</code>.
</p>
</dd>
</dl>

<p>The default can be overridden by setting the environment variable
<span id="index-R_005fRD4PDF"></span>
<code>R_RD4PDF</code>.  (On Unix-alikes, this will be picked up at install time
and stored in <samp>etc/Renviron</samp>, but can still be overridden when the
manuals are built, using <code>make -e</code>.)  The usual<a id="DOCF7" href="#FOOT7"><sup>7</sup></a>  default value for <code>R_RD4PDF</code> is
&lsquo;<samp>times,inconsolata,hyper</samp>&rsquo;: omit &lsquo;<samp>inconsolata</samp>&rsquo; if you do not have
LaTeX package <strong>inconsolata</strong> installed. As from R 4.2.0,
&lsquo;<samp>hyper</samp>&rsquo; is always enabled (with a fallback if LaTeX package
<strong>hyperref</strong> is not installed).
</p>
<p>Further options, e.g for <strong>hyperref</strong>, can be included in a file
<samp>Rd.cfg</samp> somewhere on your LaTeX search path.  For example, if
you prefer to hyperlink the text and not the page number in the table of
contents use
</p><div class="example">
<pre class="example">\ifthenelse{\boolean{Rd@use@hyper}}{\hypersetup{linktoc=section}}{}
</pre></div>

<p>or 
</p><div class="example">
<pre class="example">\ifthenelse{\boolean{Rd@use@hyper}}{\hypersetup{linktoc=all}}{}
</pre></div>

<p>to hyperlink both text and page number.
</p>
<p>Ebook versions of most of the manuals in one or both of <samp>.epub</samp> and
<samp>.mobi</samp> formats can be made by running in <samp>doc/manual</samp> one of
</p><div class="example">
<pre class="example">make ebooks
make epub
make mobi
</pre></div>

<p>This requires <code>ebook-convert</code> from
<a href="https://calibre-ebook.com/download"><code>Calibre</code></a>, or from
most Linux distributions.  If necessary the path to
<code>ebook-convert</code> can be set as make macro <code>EBOOK</code> by editing
<samp>doc/manual/Makefile</samp> (which contains a commented value suitable
for macOS) or using <code>make -e</code>.
</p>

<hr>
</div>
<div class="section" id="Installation">
<div class="header">
<p>
Next: <a href="#Uninstallation" accesskey="n" rel="next">Uninstallation</a>, Previous: <a href="#Making-the-manuals" accesskey="p" rel="prev">Making the manuals</a>, Up: <a href="#Installing-R-under-Unix_002dalikes" accesskey="u" rel="up">Installing R under Unix-alikes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Installation-1"></span><h3 class="section">2.4 Installation</h3>
<span id="index-Installation"></span>

<p>To ensure that the installed tree is usable by the right group of users,
set <code>umask</code> appropriately (perhaps to &lsquo;<samp>022</samp>&rsquo;) before unpacking
the sources and throughout the build process.
</p>
<p>After
</p>
<span id="index-configure-2"></span>
<div class="example">
<pre class="example">./configure
make
make check
</pre></div>

<p>(or, when building outside the source,
<code><var>TOP_SRCDIR</var>/configure</code>, etc) have been completed
successfully, you can install the complete R tree to your system by
typing
</p>
<div class="example">
<pre class="example">make install
</pre></div>

<p>A parallel make can be used (but run <code>make</code> before <code>make
install</code>).  Those using GNU <code>make</code> 4.0 or later may want to use
<code>make -j <var>n</var> -O</code> to avoid interleaving of output.
</p>
<p>This will install to the following directories:
</p>
<dl compact="compact">
<dt><span><samp><var>prefix</var>/bin</samp> or <samp><var>bindir</var></samp></span></dt>
<dd><p>the front-end shell script and other scripts and executables
</p></dd>
<dt><span><samp><var>prefix</var>/man/man1</samp> or <samp><var>mandir</var>/man1</samp></span></dt>
<dd><p>the man page
</p></dd>
<dt><span><samp><var>prefix</var>/<var>LIBnn</var>/R</samp> or <samp><var>libdir</var>/R</samp></span></dt>
<dd><p>all the rest (libraries, on-line help system, &hellip;).  Here
<var>LIBnn</var> is usually &lsquo;<samp>lib</samp>&rsquo;, but may be &lsquo;<samp>lib64</samp>&rsquo; on some
64-bit Linux systems.  This is known as the R home directory.
</p></dd>
</dl>

<p>where <var>prefix</var> is determined during configuration (typically
<samp>/usr/local</samp>) and can be set by running <code>configure</code> with
the option <samp>--prefix</samp>, as in
</p>
<span id="index-configure-3"></span>
<div class="example">
<pre class="example">./configure --prefix=/where/you/want/R/to/go
</pre></div>

<p>where the value should be an absolute path.  This causes <code>make
install</code> to install the R script to
<samp>/where/you/want/R/to/go/bin</samp>, and so on.  The prefix of the
installation directories can be seen in the status message that is
displayed at the end of <code>configure</code>.  The installation may need
to be done by the owner of <samp><var>prefix</var></samp>, often a root account.
</p>
<p>There is the option of using <code>make install-strip</code> (see <a href="#Debugging-Symbols">Debugging Symbols</a>).
</p>

<p>You can install into another directory tree by using
</p>
<div class="example">
<pre class="example">make prefix=/path/to/here install
</pre></div>

<p>at least with <acronym>GNU</acronym> <code>make</code> (but not some other Unix
makes).
</p>
<p>More precise control is available at configure time via options: see
<code>configure --help</code> for details.  (However, most of the &lsquo;Fine
tuning of the installation directories&rsquo; options are not used by R.)
</p>
<p>Configure options <samp>--bindir</samp> and <samp>--mandir</samp> are supported
and govern where a copy of the <code>R</code> script and the <code>man</code>
page are installed.
</p>
<p>The configure option <samp>--libdir</samp> controls where the main R
files are installed: the default is &lsquo;<samp><var>eprefix</var>/<var>LIBnn</var></samp>&rsquo;,
where <var>eprefix</var> is the prefix used for installing
architecture-dependent files, defaults to <var>prefix</var>, and can be set
via the configure option <samp>--exec-prefix</samp>.
</p>
<p>Each of <code>bindir</code>, <code>mandir</code> and <code>libdir</code> can also be
specified on the <code>make install</code> command line (at least for
<acronym>GNU</acronym> <code>make</code>).
</p>
<p>The <code>configure</code> or <code>make</code> variables <code>rdocdir</code> and
<code>rsharedir</code> can be used to install the system-independent
<samp>doc</samp> and <samp>share</samp> directories to somewhere other than
<code>libdir</code>.  The C header files can be installed to the value of
<code>rincludedir</code>: note that as the headers are not installed into a
subdirectory you probably want something like
<code>rincludedir=/usr/local/include/R-4.2.1</code>.
</p>
<p>If you want the R home to be something other than
<samp><var>libdir</var>/R</samp>, use <samp>rhome</samp>: for example
</p>
<div class="example">
<pre class="example">make install rhome=/usr/local/lib64/R-4.2.1
</pre></div>

<p>will use a version-specific R home on a non-Debian Linux 64-bit
system.
</p>
<p>If you have made R as a shared/static library you can install it in
your system&rsquo;s library directory by
</p>
<div class="example">
<pre class="example">make prefix=/path/to/here install-libR
</pre></div>

<p>where <code>prefix</code> is optional, and <code>libdir</code> will give more
precise control.<a id="DOCF8" href="#FOOT8"><sup>8</sup></a>  However, you should not install
to a directory mentioned in <code>LDPATHS</code> (e.g.
<samp>/usr/local/lib64</samp>) if you intend to work with multiple versions of
R, since that directory may be given precedence over the <samp>lib</samp>
directory of other R installations.
</p>
<div class="example">
<pre class="example">make install-strip
</pre></div>

<p>will install stripped executables, and on platforms where this is
supported, stripped libraries in directories <samp>lib</samp> and
<samp>modules</samp> and in the standard packages.
</p>
<p>Note that installing R into a directory whose path contains spaces is
not supported, and some aspects (such as installing source packages)
will not work.
</p>
<span id="index-Manuals_002c-installing"></span>

<p>To install info and PDF versions of the manuals, use one or both of
</p>
<div class="example">
<pre class="example">make install-info
make install-pdf
</pre></div>

<p>Once again, it is optional to specify <code>prefix</code>, <code>libdir</code> or
<code>rhome</code> (the PDF manuals are installed under the R home
directory).  
</p>
<p>More precise control is possible.  For info, the setting used is that of
<code>infodir</code> (default <samp><var>prefix</var>/info</samp>, set by configure
option <samp>--infodir</samp>).  The PDF files are installed into the R
<samp>doc</samp> tree, set by the <code>make</code> variable <code>rdocdir</code>.
</p>
<p>A staged installation is possible, that it is installing R into a
temporary directory in order to move the installed tree to its final
destination.  In this case <code>prefix</code> (and so on) should reflect the
<span id="index-DESTDIR"></span>
final destination, and <code>DESTDIR</code> should be used: see
<a href="https://www.gnu.org/prep/standards/html_node/DESTDIR.html">https://www.gnu.org/prep/standards/html_node/DESTDIR.html</a>.
</p>
<p>You can optionally install the run-time tests that are part of
<code>make check-all</code> by
</p>
<div class="example">
<pre class="example">make install-tests
</pre></div>

<p>which populates a <samp>tests</samp> directory in the installation.
</p>

<hr>
</div>
<div class="section" id="Uninstallation">
<div class="header">
<p>
Next: <a href="#Sub_002darchitectures" accesskey="n" rel="next">Sub-architectures</a>, Previous: <a href="#Installation" accesskey="p" rel="prev">Installation</a>, Up: <a href="#Installing-R-under-Unix_002dalikes" accesskey="u" rel="up">Installing R under Unix-alikes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Uninstallation-1"></span><h3 class="section">2.5 Uninstallation</h3>

<p>You can uninstall R by
</p>
<div class="example">
<pre class="example">make uninstall
</pre></div>

<p>optionally specifying <code>prefix</code> etc in the same way as specified for
installation.
</p>
<p>This will also uninstall any installed manuals.  There are specific
targets to uninstall info and PDF manuals in file
<samp>doc/manual/Makefile</samp>.
</p>
<p>Target <code>uninstall-tests</code> will uninstall any installed tests, as
well as removing the directory <samp>tests</samp> containing the test results.
</p>
<p>An installed shared/static <code>libR</code> can be uninstalled by
</p>
<div class="example">
<pre class="example">make prefix=/path/to/here uninstall-libR
</pre></div>


<hr>
</div>
<div class="section" id="Sub_002darchitectures">
<div class="header">
<p>
Next: <a href="#Other-Options" accesskey="n" rel="next">Other Options</a>, Previous: <a href="#Uninstallation" accesskey="p" rel="prev">Uninstallation</a>, Up: <a href="#Installing-R-under-Unix_002dalikes" accesskey="u" rel="up">Installing R under Unix-alikes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Sub_002darchitectures-1"></span><h3 class="section">2.6 Sub-architectures</h3>

<p>Some platforms can support closely related builds of R which can
share all but the executables and dynamic objects.  Examples include
builds under Linux for different <acronym>CPU</acronym>s or 32- and 64-bit
builds.
</p>
<p>R supports the idea of architecture-specific builds, specified by
adding &lsquo;<samp>r_arch=<var>name</var></samp>&rsquo; to the <code>configure</code> line.  Here
<var>name</var> can be anything non-empty, and is used to name subdirectories
of <samp>lib</samp>, <samp>etc</samp>, <samp>include</samp> and the package <samp>libs</samp>
subdirectories.  Example names from other software are the use of
<samp>sparcv9</samp> on Sparc Solaris and <samp>32</samp> by <code>gcc</code> on
&lsquo;<samp>x86_64</samp>&rsquo; Linux.
</p>
<p>If you have two or more such builds you can install them over each other
(and for 32/64-bit builds on one architecture, one build can be done
without &lsquo;<samp>r_arch</samp>&rsquo;).  The space savings can be considerable: on
&lsquo;<samp>x86_64</samp>&rsquo; Linux a basic install (without debugging symbols) took
74Mb, and adding a 32-bit build added 6Mb.  If you have installed
multiple builds you can select which build to run by
</p>
<div class="example">
<pre class="example">R --arch=<var>name</var>
</pre></div>

<p>and just running &lsquo;<samp>R</samp>&rsquo; will run the last build that was installed.
</p>
<p><code>R CMD INSTALL</code> will detect if more than one build is installed and
try to install packages with the appropriate library objects for each.
This will not be done if the package has an executable <code>configure</code>
script or a <samp>src/Makefile</samp> file.  In such cases you can install for
extra builds by
</p>
<div class="example">
<pre class="example">R --arch=<var>name</var> CMD INSTALL --libs-only <var>pkg1</var> <var>pkg2</var> &hellip;
</pre></div>

<p>If you want to mix sub-architectures compiled on different platforms
(for example &lsquo;<samp>x86_64</samp>&rsquo; Linux and &lsquo;<samp>i686</samp>&rsquo; Linux), it is
wise to use explicit names for each, and you may also need to set
<samp>libdir</samp> to ensure that they install into the same place.
</p>
<p>When sub-architectures are used the version of <code>Rscript</code> in
e.g. <samp>/usr/bin</samp> will be the last installed, but
architecture-specific versions will be available in e.g.
<samp>/usr/lib64/R/bin/exec${<var>R_ARCH</var>}</samp>.  Normally all installed
architectures will run on the platform so the architecture of
<code>Rscript</code> itself does not matter.  The executable
<code>Rscript</code> will run the <code>R</code> script, and at that time the
<span id="index-R_005fARCH"></span>
setting of the <code>R_ARCH</code> environment variable determines the
architecture which is run.
</p>
<p>When running post-install tests with sub-architectures, use
</p>
<div class="example">
<pre class="example">R --arch=<var>name</var> CMD make check[-devel|all]
</pre></div>

<p>to select a sub-architecture to check.
</p>
<p>Sub-architectures are also used on Windows, but by selecting executables
within the appropriate <samp>bin</samp> directory,
<samp><var>R_HOME</var>/bin/x64</samp>.  For
backwards compatibility there are executables
<samp><var>R_HOME</var>/bin/R.exe</samp> and <samp><var>R_HOME</var>/bin/Rscript.exe</samp>:
these will run an executable from one of the subdirectories, which one
being taken first from the
<span id="index-R_005fARCH-1"></span>
<code>R_ARCH</code> environment variable, then from the
<samp>--arch</samp> command-line option<a id="DOCF9" href="#FOOT9"><sup>9</sup></a> and finally from the
installation default (which is 32-bit for a combined 32/64 bit R
installation). R 4.2.0 follows the scheme, but supports and includes
only 64-bit builds.
</p>

<ul class="section-toc">
<li><a href="#Multilib" accesskey="1">Multilib</a></li>
</ul>
<hr>
<div class="subsection" id="Multilib">
<div class="header">
<p>
Previous: <a href="#Sub_002darchitectures" accesskey="p" rel="prev">Sub-architectures</a>, Up: <a href="#Sub_002darchitectures" accesskey="u" rel="up">Sub-architectures</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Multilib-1"></span><h4 class="subsection">2.6.1 Multilib</h4>

<p>For some Linux distributions<a id="DOCF10" href="#FOOT10"><sup>10</sup></a>, there is an alternative mechanism for mixing
32-bit and 64-bit libraries known as <em>multilib</em>. If the Linux
distribution supports multilib, then parallel builds of R may be
installed in the sub-directories <samp>lib</samp> (32-bit) and <samp>lib64</samp>
(64-bit).  The build to be run may then be selected using the
<code>setarch</code> command. For example, a 32-bit build may be run by
</p>
<div class="example">
<pre class="example">setarch i686 R
</pre></div>

<p>The <code>setarch</code> command is only operational if both 32-bit and
64-bit builds are installed. If there is only one installation of R,
then this will always be run regardless of the architecture specified
by the <code>setarch</code> command.
</p>
<p>There can be problems with installing packages on the non-native
architecture.  It is a good idea to run e.g. <code>setarch i686 R</code> for
sessions in which packages are to be installed, even if that is the only
version of R installed (since this tells the package installation
code the architecture needed).
</p>
<p>There is a potential problem with packages using Java, as the
post-install for a &lsquo;<samp>i686</samp>&rsquo; RPM on &lsquo;<samp>x86_64</samp>&rsquo; Linux
reconfigures Java and will find the &lsquo;<samp>x86_64</samp>&rsquo; Java.  If you know
where a 32-bit Java is installed you may be able to run (as root)
</p>
<div class="example">
<pre class="example">export JAVA_HOME=&lt;path to jre directory of 32-bit Java&gt;
setarch i686 R CMD javareconf
</pre></div>

<p>to get a suitable setting.
</p>
<p>When this mechanism is used, the version of <code>Rscript</code> in
e.g. <samp>/usr/bin</samp> will be the last installed, but an
architecture-specific version will be available in
e.g. <samp>/usr/lib64/R/bin</samp>.  Normally all installed architectures
will run on the platform so the architecture of <code>Rscript</code> does
not matter.
</p>
<hr>
</div>
</div>
<div class="section" id="Other-Options">
<div class="header">
<p>
Next: <a href="#Testing-a-Unix_002dalike-Installation" accesskey="n" rel="next">Testing an Installation</a>, Previous: <a href="#Sub_002darchitectures" accesskey="p" rel="prev">Sub-architectures</a>, Up: <a href="#Installing-R-under-Unix_002dalikes" accesskey="u" rel="up">Installing R under Unix-alikes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Other-Options-1"></span><h3 class="section">2.7 Other Options</h3>

<p>There are many other installation options, most of which are listed by
<code>configure --help</code>.  Almost all of those not listed elsewhere in
this manual are either standard <code>autoconf</code> options not relevant
to R or intended for specialist uses by the R developers.
</p>
<p>One that may be useful when working on R itself is the option
<samp>--disable-byte-compiled-packages</samp>, which ensures that the base
and recommended packages are not byte-compiled.  (Alternatively the
(make or environment) variable <code>R_NO_BASE_COMPILE</code> can be set to a
non-empty value for the duration of the build.)
</p>
<p>Option <samp>--with-internal-tzcode</samp> makes use of R&rsquo;s own code and
copy of the IANA database for managing timezones.  This will be
preferred where there are issues with the system implementation, usually
involving times after 2037 or before 1916.  An alternative time-zone
directory<a id="DOCF11" href="#FOOT11"><sup>11</sup></a> can be used, pointed
to by environment variable <code>TZDIR</code>: this should contain files such
as <samp>Europe/London</samp>.  On all tested OSes the system timezone was
deduced correctly, but if necessary it can be set as the value of
environment variable <code>TZ</code>.
</p>
<p>Options <samp>--with-internal-iswxxxxx</samp>,
<samp>--with-internal-towlower</samp> and <samp>--with-internal-wcwidth</samp>
were introduced in R 4.1.0.  These control the replacement of the
system wide-character classification (such as <code>iswprint</code>),
case-changing (<code>wctrans</code>) and width (<code>wcwidth</code> and
<code>wcswidth</code>) functions by ones contained in the R sources.
Replacement of the classification functions has been done for many years
on macOS and AIX (and Windows): option <samp>--with-internal-iswxxxxx</samp>
allows this to be suppressed on those platforms or used on others.
Replacing the case-changing functions was new in R 4.1.0 and the
default on macOS (and on Windows since R 4.2.0).  Replacement of the
width functions has also been done for many years and remains the
default.  These options will only matter to those working with non-ASCII
character data, especially in languages written in a non-Western
script<a id="DOCF12" href="#FOOT12"><sup>12</sup></a> (which includes
&lsquo;symbols&rsquo; such as emoji).  Note that one of those <code>iswxxxxx</code> is
<code>iswprint</code> which is used to decide whether to output a character as
a glyph or as a &lsquo;<samp>\U{xxxxxx}</samp>&rsquo; escape&mdash;for example, try
&lsquo;<samp>&quot;\U1f600&quot;</samp>&rsquo;, an emoji.  The width functions are of most importance
in East Asian locale: their values differ between such locales.
(Replacing the system functions provides a degree of
plaform-independence (including to OS updates) but replaces it with a
dependence on the R version.)
</p>

<ul class="section-toc">
<li><a href="#Debugging-Symbols" accesskey="1">Debugging Symbols</a></li>
<li><a href="#OpenMP-Support" accesskey="2">OpenMP Support</a></li>
<li><a href="#C_002b_002b-Support" accesskey="3">C++ Support</a></li>
<li><a href="#Link_002dTime-Optimization" accesskey="4">Link-Time Optimization</a></li>
</ul>
<hr>
<div class="subsection" id="Debugging-Symbols">
<div class="header">
<p>
Next: <a href="#OpenMP-Support" accesskey="n" rel="next">OpenMP Support</a>, Previous: <a href="#Other-Options" accesskey="p" rel="prev">Other Options</a>, Up: <a href="#Other-Options" accesskey="u" rel="up">Other Options</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Debugging-Symbols-1"></span><h4 class="subsection">2.7.1 Debugging Symbols</h4>

<p>By default, <code>configure</code> adds a flag (usually <samp>-g</samp>) to the
compilation flags for C, Fortran and CXX sources.  This will slow down
compilation and increase object sizes of both R and packages, so it
may be a good idea to change those flags (set &lsquo;<samp>CFLAGS</samp>&rsquo; etc in
<samp>config.site</samp> before configuring, or edit files <samp>Makeconf</samp>
and <samp>etc/Makeconf</samp> between running <code>configure</code> and
<code>make</code>).
</p>
<p>Having debugging symbols available is useful both when running R under a
debugger (e.g., <code>R -d gdb</code>) and when using sanitizers and
<code>valgrind</code>, all things intended for experts.
</p>
<p>Debugging symbols (and some others) can be &lsquo;stripped&rsquo; on installation by
using
</p><div class="example">
<pre class="example">make install-strip
</pre></div>
<p>How well this is supported depends on the platform: it works best on
those using GNU <code>binutils</code>.  On &lsquo;<samp>x86_64</samp>&rsquo; Linux a typical
reduction in overall size was from 92MB to 66MB.   On macOS debugging
symbols are not by default included in <samp>.dylib</samp> and <samp>.so</samp>
files, so there is negligible difference.
</p>
<hr>
</div>
<div class="subsection" id="OpenMP-Support">
<div class="header">
<p>
Next: <a href="#C_002b_002b-Support" accesskey="n" rel="next">C++ Support</a>, Previous: <a href="#Debugging-Symbols" accesskey="p" rel="prev">Debugging Symbols</a>, Up: <a href="#Other-Options" accesskey="u" rel="up">Other Options</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="OpenMP-Support-1"></span><h4 class="subsection">2.7.2 OpenMP Support</h4>

<p>By default <code>configure</code> searches for suitable flags<a id="DOCF13" href="#FOOT13"><sup>13</sup></a>
for OpenMP support for the C, C++ (default standard) and Fortran
compilers.
</p>
<p>Only the C result is currently used for R itself, and only if
<code>MAIN_LD</code>/<code>DYLIB_LD</code> were not specified.  This can be
overridden by specifying
</p><div class="example">
<pre class="example">R_OPENMP_CFLAGS
</pre></div>

<p>Use for packages has similar restrictions (involving <code>SHLIB_LD</code> and
similar: note that as Fortran code is by default linked by the C (or
C++) compiler, both need to support OpenMP) and can be overridden by
specifying some of
</p><div class="example">
<pre class="example">SHLIB_OPENMP_CFLAGS
SHLIB_OPENMP_CXXFLAGS
SHLIB_OPENMP_FFLAGS
</pre></div>

<p>Setting these to an empty value will disable OpenMP for that compiler
(and configuring with <samp>--disable-openmp</samp> will disable all
detection<a id="DOCF14" href="#FOOT14"><sup>14</sup></a> of OpenMP).  The
<code>configure</code> detection test is to compile and link a standalone
OpenMP program, which is not the same as compiling a shared object and
loading it into the C program of R&rsquo;s executable.  Note that
overridden values are not tested.
</p>
<hr>
</div>
<div class="subsection" id="C_002b_002b-Support">
<div class="header">
<p>
Next: <a href="#Link_002dTime-Optimization" accesskey="n" rel="next">Link-Time Optimization</a>, Previous: <a href="#OpenMP-Support" accesskey="p" rel="prev">OpenMP Support</a>, Up: <a href="#Other-Options" accesskey="u" rel="up">Other Options</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="C_002b_002b-Support-1"></span><h4 class="subsection">2.7.3 C++ Support</h4>

<p>C++ is not used by R itself, but support is provided for installing
packages with C++ code via <code>make</code> macros defined in file
<samp>etc/Makeconf</samp> (and with explanations in file <samp>config.site</samp>):
</p><div class="example">
<pre class="example">CXX
CXXFLAGS
CXXPICFLAGS
CXXSTD

CXX11
CXX11STD
CXX11FLAGS
CXX11PICFLAGS

CXX14
CXX14STD
CXX14FLAGS
CXX14PICFLAGS

CXX17
CXX17STD
CXX17FLAGS
CXX17PICFLAGS

CXX20
CXX20STD
CXX20FLAGS
CXX20PICFLAGS
</pre></div>
<p>The macros <code>CXX</code> etc are those used by default for C++ code.
<code>configure</code> will attempt to set the rest suitably, choosing for
<code>CXXSTD</code> and <code>CXX11STD</code> a suitable flag such as
<samp>-std=c++11</samp> for C++11 support (which is required if C++ is to be
supported at all).  Similarly, <code>configure</code> will if possible
choose for <code>CXX14STD</code> a flag<a id="DOCF15" href="#FOOT15"><sup>15</sup></a> such as <samp>-std=c++14</samp> for C++14 support,
<samp>-std=c++17</samp> or <samp>-std=c++1z</samp> for support for C++17 and
<samp>-std=c++20</samp> or <samp>-std=c++2a</samp> for support for C++20..  The
inferred values can be overridden in file <samp>config.site</samp> or on the
<code>configure</code> command line: user-supplied values will be tested by
compiling some C++11/14/17/20 code.
</p>
<p>It may be that there is no suitable flag for C++14/17/20 support with
the default compiler, in which case a different compiler could be
selected for <code>CXX14</code> or <code>CXX17</code> or <code>CXX20</code> with its
corresponding flags.
</p>
<p>The <samp>-std</samp> flag is supported by the GCC, <code>clang++</code> and
Intel compilers.  Currently accepted values are (plus some synonyms)
</p><div class="example">
<pre class="example">g++:     c++11 gnu+11 c++14 gnu++14 c++17 gnu++17 c++2a gnu++2a (from 8)
         c++20 gnu++20 (from 10)
Intel:   c++11 c++14 (from 16.0) c++17 (from 17.0) c++20 (from 19.0?)
</pre></div>
<p>(Those for <code>clang++</code> are documented at
<a href="https://clang.llvm.org/cxx_status.html">https://clang.llvm.org/cxx_status.html</a>, and follow <code>g++</code>:
<code>-std=c++20</code> is supported from Clang 10.)
</p>

<p>&lsquo;Standards&rsquo; for <code>g++</code> starting with &lsquo;<samp>gnu</samp>&rsquo; enable &lsquo;GNU
extensions&rsquo;: what those are is hard to track down.
</p>
<p>For the use of C++11 and later in R packages see the &lsquo;Writing R
Extensions&rsquo; manual.  Prior to R 3.6.0 the default C++ standard was
that of the compiler used: currently it is C++14 (if available): this
can be overridden by setting &lsquo;<samp>CXXSTD</samp>&rsquo; when R is configured.
</p>
<p><a href="https://en.cppreference.com/w/cpp/compiler_support">https://en.cppreference.com/w/cpp/compiler_support</a> indicates
which versions of common compilers support (parts of) which C++
standards.
</p>
<hr>
</div>
<div class="subsection" id="Link_002dTime-Optimization">
<div class="header">
<p>
Previous: <a href="#C_002b_002b-Support" accesskey="p" rel="prev">C++ Support</a>, Up: <a href="#Other-Options" accesskey="u" rel="up">Other Options</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Link_002dTime-Optimization-1"></span><h4 class="subsection">2.7.4 Link-Time Optimization</h4>

<p>There is support for using link-time optimization (LTO) if the toolchain
supports it: configure with flag <samp>--enable-lto</samp>.  When LTO is
enabled it is used for compiled code in add-on packages unless the flag
<samp>--enable-lto=R</samp> is used<a id="DOCF16" href="#FOOT16"><sup>16</sup></a>.
</p>
<p>The main benefit seen to date from LTO has been detecting long-standing
bugs in the ways packages pass arguments to compiled code and between
compilation units.  Benchmarking in 2020 with
<code>gcc</code>/<code>gfortran</code>&nbsp;10 showed gains of a few percent
in increased performance and reduction in installed size for builds
without debug symbols, but large size reductions for some
packages<a id="DOCF17" href="#FOOT17"><sup>17</sup></a> with debug symbols.  (Performance and size gains are said to be
most often seen in complex C++ builds.)
</p>
<p>Whether toolchains support LTO is often unclear: all of the C compiler,
the Fortran compiler<a id="DOCF18" href="#FOOT18"><sup>18</sup></a> and linker have
to support it, and support it by the same mechanism (so mixing compiler
families may not work and a non-default linker may be needed).  It has
been supported by the GCC and LLVM projects for some years with
diverging implementations.
</p>
<p>LTO support was added in 2011 for GCC&nbsp;4.5 on Linux but was little
used before 2019: compiler support has steadily improved over those
years and <samp>--enable-lto=R</samp> is nowadays used for some routine
<acronym>CRAN</acronym> checking.
</p>
<p>Unfortunately <samp>--enable-lto</samp> may be accepted but silently do
nothing useful if some of the toolchain does not support LTO: this is
less common than it once was.
</p>
<p>Various macros can be set in file <samp>config.site</samp> to customize how
LTO is used.  If the Fortran compiler is not of the same family as the
C/C++ compilers, set macro &lsquo;<samp>LTO_FC</samp>&rsquo; (probably to empty).  Macro
&lsquo;<samp>LTO_LD</samp>&rsquo; can be used to select an alternative linker should that be
needed.
</p>


<ul class="section-toc">
<li><a href="#LTO-with-GCC" accesskey="1">LTO with GCC</a></li>
<li><a href="#LTO-with-LLVM" accesskey="2">LTO with LLVM</a></li>
<li><a href="#LTO-for-package-checking" accesskey="3">LTO for package checking</a></li>
</ul>
<hr>
<div class="subsubsection" id="LTO-with-GCC">
<div class="header">
<p>
Next: <a href="#LTO-with-LLVM" accesskey="n" rel="next">LTO with LLVM</a>, Previous: <a href="#Link_002dTime-Optimization" accesskey="p" rel="prev">Link-Time Optimization</a>, Up: <a href="#Link_002dTime-Optimization" accesskey="u" rel="up">Link-Time Optimization</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="LTO-with-GCC-1"></span><h4 class="subsubsection">2.7.4.1 LTO with GCC</h4>

<p>This has been tested on Linux with
<code>gcc</code>/<code>gfortran</code>&nbsp;8 and later: that needed setting
(e.g. in <samp>config.site</samp>)
</p><div class="example">
<pre class="example">AR=gcc-ar
RANLIB=gcc-ranlib
</pre></div>
<p>For non-system compilers or if those wrappers have not been installed
one may need something like
</p><div class="example">
<pre class="example">AR=&quot;ar --plugin=/path/to/liblto_plugin.so&quot;
RANLIB=&quot;ranlib --plugin=/path/to/liblto_plugin.so&quot;
</pre></div>
<p>amd <code>NM</code> may be needed to be set analogously. (If using an
LTO-enabled build to check packages, set environment variable
<code>UserNM</code><a id="DOCF19" href="#FOOT19"><sup>19</sup></a> to &lsquo;<samp>gcc-nm</samp>&rsquo;.)
</p>
<p>With GCC 5 and later it is possible to parallelize parts of the LTO
linking process: set the make macro &lsquo;<samp>LTO</samp>&rsquo; to something like
&lsquo;<samp>LTO=-flto=8</samp>&rsquo; (to use 8 threads), for example in file
<samp>config.site</samp>.
</p>
<p>Under some circumstances and for a few packages, the PIC flags have
needed overriding on Linux with GCC 9 and later: e.g use in
<samp>config.site</samp>:
</p><div class="example">
<pre class="example">CPICFLAGS=-fPIC
CXXPICFLAGS=-fPIC
CXX11PICFLAGS=-fPIC
CXX14PICFLAGS=-fPIC
CXX17PICFLAGS=-fPIC
CXX20PICFLAGS=-fPIC
FPICFLAGS=-fPIC
</pre></div>
<p>We suggest only using these if the problem is encountered (it was not
seen on <acronym>CRAN</acronym> with GCC 10 at the time of writing).
</p>
<p>Note that R may need to be re-compiled after even a minor update to
the compiler (e.g. from 10.1 to 10.2) but this may not be clear from
confused compiler messages.
</p>
<hr>
</div>
<div class="subsubsection" id="LTO-with-LLVM">
<div class="header">
<p>
Next: <a href="#LTO-for-package-checking" accesskey="n" rel="next">LTO for package checking</a>, Previous: <a href="#LTO-with-GCC" accesskey="p" rel="prev">LTO with GCC</a>, Up: <a href="#Link_002dTime-Optimization" accesskey="u" rel="up">Link-Time Optimization</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="LTO-with-LLVM-1"></span><h4 class="subsubsection">2.7.4.2 LTO with LLVM</h4>

<p>LLVM supports another type of LTO called &lsquo;Thin LTO&rsquo; as well as a similar
implementation to GCC, sometimes called &lsquo;Full LTO&rsquo;.  (See
<a href="https://clang.llvm.org/docs/ThinLTO.html">https://clang.llvm.org/docs/ThinLTO.html</a>.)  Currently the only
LLVM compiler relevant to R is <code>clang</code> for which this can be
selected by setting macro &lsquo;<samp>LTO=-flto=thin</samp>&rsquo;.  LLVM has
</p><div class="example">
<pre class="example">AR=llvm-ar
RANLIB=llvm-ranlib
</pre></div>
<p>(but macOS does not, and these are not needed there).  Where the linker
supports a parallel backend for Thin LTO this can be specified <em>via</em>
the macro &lsquo;<samp>LTO_LD</samp>&rsquo;: see the URL above for per-linker settings and
further linking optimizations.)
</p>
<p>For example, on macOS one might use
</p><div class="example">
<pre class="example">LTO=-flto=thin
LTO_FC=
LTO_LD=-Wl,-mllvm,-threads=4
</pre></div>
<p>to use Thin LTO with 4 threads for C/C++ code, but skip LTO for Fortran
code compiled with <code>gfortran</code>.
</p>
<p>It is said to be particularly beneficial to use <samp>-O3</samp> for
<code>clang</code> in conjunction with LTO.
</p>
<hr>
</div>
<div class="subsubsection" id="LTO-for-package-checking">
<div class="header">
<p>
Previous: <a href="#LTO-with-LLVM" accesskey="p" rel="prev">LTO with LLVM</a>, Up: <a href="#Link_002dTime-Optimization" accesskey="u" rel="up">Link-Time Optimization</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="LTO-for-package-checking-1"></span><h4 class="subsubsection">2.7.4.3 LTO for package checking</h4>

<p>LTO effectively compiles all the source code in a package as a single
compilation unit and so allows the compiler (with sufficient diagnostic
flags such as <samp>-Wall</samp>) to check consistency between what are
normally separate compilation units.
</p>
<p>With <code>gcc</code>/<code>gfortran</code> 9.x and later<a id="DOCF20" href="#FOOT20"><sup>20</sup></a> LTO will flag inconsistencies in calls to Fortran
subroutines/functions, both between Fortran source files and between
Fortran and C/C++.  <code>gfortran</code> 8.4, 9.2 and later can help
understanding these by extracting C prototypes from Fortran source files
with option <samp>-fc-prototypes-external</samp>, e.g. that (at the time
of writing) Fortran <code>LOGICAL</code> corresponds to <code>int_least32_t *</code>
in C.
</p>
<p>On some systems it is possible to build the BLAS, LINPACK and LAPACK
support as static libraries containing intermediate-level code that LTO
will compile for all objects linked against these libraries, by
configuring R with <samp>--enable-lto=check</samp>.  This checks the
consistency of calls to BLAS/LINPACK/LAPACK in any packages installed
using the build. <strong>NB:</strong> as its name suggests, this option is
intended only for checking installation of R and packages: it
includes these library routines (those called directly and all they
depend on) in each package.  This is unlikely to work in conjunction
with non-default options for BLAS and LAPACK, and &lsquo;linking&rsquo; against
these libraries may be very slow.
</p>
<hr>
</div>
</div>
</div>
<div class="section" id="Testing-a-Unix_002dalike-Installation">
<div class="header">
<p>
Previous: <a href="#Other-Options" accesskey="p" rel="prev">Other Options</a>, Up: <a href="#Installing-R-under-Unix_002dalikes" accesskey="u" rel="up">Installing R under Unix-alikes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Testing-an-Installation"></span><h3 class="section">2.8 Testing an Installation</h3>

<p>Full post-installation testing is possible only if the test files have
been installed with
</p>
<div class="example">
<pre class="example">make install-tests
</pre></div>

<p>which populates a <samp>tests</samp> directory in the installation.
</p>
<p>If this has been done, two testing routes are available.  The first is
to move to the home directory of the R installation (as given by
<code>R RHOME</code> or from R as <code>R.home()</code>) and run
</p>
<div class="example">
<pre class="example">cd tests
## followed by one of
../bin/R CMD make check
../bin/R CMD make check-devel
../bin/R CMD make check-all
</pre></div>

<p>and other useful targets are <code>test-BasePackages</code> and
<code>test-Recommended</code> to run tests of the standard and recommended
packages (if installed) respectively.
</p>
<p>This re-runs all the tests relevant to the installed R (including for
example the code in the package vignettes), but not for example the ones
checking the example code in the manuals nor making the standalone Rmath
library.  This can occasionally be useful when the operating environment
has been changed, for example by OS updates or by substituting the
<acronym>BLAS</acronym> (see <a href="#Shared-BLAS">Shared BLAS</a>).
</p>
<p>Parallel checking of packages may be possible: set the environment
variable <code>TEST_MC_CORES</code> to the maximum number of processes to be
run in parallel.  This affects both checking the package examples (part
of <code>make check</code>) and package sources (part of <code>make
check-devel</code> and <code>make check-recommended</code>).  It does require a
<code>make</code> command which supports the <code>make -j <var>n</var></code>
option: most do.
</p>

<p>Alternatively, the installed R can be run, preferably with
<samp>--vanilla</samp>.  Then
<span id="index-LC_005fCOLLATE"></span>
</p>
<div class="example">
<pre class="example">pdf(&quot;tests.pdf&quot;) ## optional, but prevents flashing graphics windows
Sys.setenv(LC_COLLATE = &quot;C&quot;, LC_TIME = &quot;C&quot;, LANGUAGE = &quot;en&quot;)
tools::testInstalledBasic(&quot;both&quot;)
tools::testInstalledPackages(scope = &quot;base&quot;)
tools::testInstalledPackages(scope = &quot;recommended&quot;)
</pre></div>

<p>runs the basic tests and then all the tests on the standard and
recommended packages.  These tests can be run from anywhere: the basic
tests write their results in the <samp>tests</samp> folder of the R home
directory and run fewer tests than the first approach: in particular
they do not test things which need Internet access&mdash;that can be tested
by
</p><div class="example">
<pre class="example">tools::testInstalledBasic(&quot;internet&quot;)
</pre></div>

<p>It is possible to test the installed packages (but not their
package-specific tests) by <code>testInstalledPackages</code> even if
<code>make install-tests</code> was not run. The outputs are written under the
current directory unless a different one is specified by <code>outDir</code>.
</p>
<p>Note that the results may depend on the language set for times and
messages: for maximal similarity to reference results you may want to
try setting (before starting the R session)
</p>
<div class="example">
<pre class="example">LANGUAGE=en
</pre></div>

<p>and use a UTF-8 or Latin-1 locale.
</p>

<hr>
</div>
</div>
<div class="chapter" id="Installing-R-under-Windows">
<div class="header">
<p>
Next: <a href="#Installing-R-under-macOS" accesskey="n" rel="next">Installing R under macOS</a>, Previous: <a href="#Installing-R-under-Unix_002dalikes" accesskey="p" rel="prev">Installing R under Unix-alikes</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Installing-R-under-Windows-1"></span><h2 class="chapter">3 Installing R under Windows</h2>
<span id="index-Installing-under-Windows"></span>

<p>[The rest of this paragraph is only relevant after release.]
The <samp>bin/windows</samp> directory of a <acronym>CRAN</acronym> site contains
binaries for a base distribution and a large number of add-on packages
from <acronym>CRAN</acronym> to run on 64-bit Windows.
</p>
<p>R is best tested on current versions of Windows 10 and Windows Server 2022
with UTF-8 as the charset encoding. It runs on older versions of Windows,
but normally with other charset encoding and may require manual installation
of the Universal C Runtime (UCRT). 
</p>
<p>Your file system must allow long file names (as is likely except
perhaps for some network-mounted systems).  If it does not also support
conversion to short name equivalents (a.k.a. DOS 8.3 names), then R
<em>must</em> be installed in a path that does not contain spaces.
</p>
<p>Installation is <em>via</em> the installer
<samp>R-4.2.1-win.exe</samp>.  Just double-click on the icon and
follow the instructions. You can uninstall R from the Control Panel.
</p>
<p>You will be asked to choose a language for installation: that choice
applies to both installation and un-installation but not to running R
itself.
</p>
<p>See the <a href="https://CRAN.R-project.org/bin/windows/base/rw-FAQ.html">R
Windows <acronym>FAQ</acronym></a> for more details on the binary installer and for
information on use on older Windows systems.
</p>

<ul class="section-toc">
<li><a href="#Building-from-source" accesskey="1">Building from source</a></li>
<li><a href="#Checking-the-build" accesskey="2">Checking the build</a></li>
<li><a href="#Testing-a-Windows-Installation" accesskey="3">Testing an Installation</a></li>
</ul>
<hr>
<div class="section" id="Building-from-source">
<div class="header">
<p>
Next: <a href="#Checking-the-build" accesskey="n" rel="next">Checking the build</a>, Previous: <a href="#Installing-R-under-Windows" accesskey="p" rel="prev">Installing R under Windows</a>, Up: <a href="#Installing-R-under-Windows" accesskey="u" rel="up">Installing R under Windows</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Building-from-source-1"></span><h3 class="section">3.1 Building from source</h3>

<p>It is possible to use other 64-bit toolchains (including &lsquo;MSYS2&rsquo;) with UCRT
support to build R, but this manual only documents that used for binary
distributions of R 4.2.x.  When using other toolchains, makefiles of R
and packages may need to be adapted.
</p>

<ul class="section-toc">
<li><a href="#The-Windows-toolset" accesskey="1">The Windows toolset</a></li>
<li><a href="#LaTeX-on-Windows" accesskey="2">LaTeX</a></li>
</ul>
<hr>
<div class="subsection" id="The-Windows-toolset">
<div class="header">
<p>
Next: <a href="#LaTeX-on-Windows" accesskey="n" rel="next">LaTeX</a>, Previous: <a href="#Building-from-source" accesskey="p" rel="prev">Building from source</a>, Up: <a href="#Building-from-source" accesskey="u" rel="up">Building from source</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="The-Windows-toolset-1"></span><h4 class="subsection">3.1.1 The Windows toolset</h4>

<p>The binary distribution of R is currently built with tools
from
<a href="https://cran.r-project.org/bin/windows/Rtools/rtools42/rtools.html">Rtools42
for Windows</a>. See 
<a href="https://cran.r-project.org/bin/windows/base/howto-R-4.2.html">Building
R and packages</a> for more details on how to use it.
</p>
<p>The toolset includes compilers (GCC version 10.3.0 with selected additional
patches) and runtime libraries from <a href="http://mingw-w64.org/">the
&lsquo;MinGW-w64&rsquo; project</a> and a number of pre-compiled static libraries and
headers used by R and R packages, compiled by
<a href="https://mxe.cc/">&rsquo;MXE&rsquo;</a> (M cross environment, with updates by Tomas
Kalibera).  The toolset also includes build tools from the
<a href="https://www.msys2.org/">the &rsquo;MSYS2&rsquo; project</a>.  Additional build tools
packaged by &rsquo;MSYS2&rsquo; may be installed via a package manager (&lsquo;<samp>pacman</samp>&rsquo;).
</p>
<p>The toolsets used for 64-bit Windows from 2008&ndash;22 were based on
MinGW-w64.  The assistance of Yu Gong at a crucial step in porting R
to MinGW-w64 is gratefully acknowledged, as well as help from Kai Tietz,
the lead developer of the MinGW-w64 project and from Martin Storsjo.
</p>
<hr>
</div>
<div class="subsection" id="LaTeX-on-Windows">
<div class="header">
<p>
Previous: <a href="#The-Windows-toolset" accesskey="p" rel="prev">The Windows toolset</a>, Up: <a href="#Building-from-source" accesskey="u" rel="up">Building from source</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="LaTeX"></span><h4 class="subsection">3.1.2 LaTeX</h4>

<p>Both building R and checking packages need a distribution of LaTeX
installed, with the directory containing <code>pdflatex</code> on the path.
</p>
<p>The &lsquo;<samp>MiKTeX</samp>&rsquo; (<a href="https://miktex.org/">https://miktex.org/</a>) distribution of
LaTeX is that used on <acronym>CRAN</acronym>.  This can be set up to install
extra packages &lsquo;on the fly&rsquo; (without asking), which is the simplest way
to use it.  The &lsquo;basic&rsquo; version of &lsquo;<samp>MiKTeX</samp>&rsquo; will need to add some
packages.<a id="DOCF21" href="#FOOT21"><sup>21</sup></a>  In any case ensure that the
<strong>inconsolata</strong> package is installed&mdash;you can check with the
&lsquo;<samp>MiKTeX</samp>&rsquo; Package Manager.
</p>
<p>It is also possible to use the TeX Live distribution from
<a href="https://www.tug.org/texlive/">https://www.tug.org/texlive/</a>.  (The <acronym>CRAN</acronym> package
<a href="https://CRAN.R-project.org/package=tinytex"><strong>tinytex</strong></a> can install and manage a subset of TeX Live.)
</p>
<hr>
</div>
</div>
<div class="section" id="Checking-the-build">
<div class="header">
<p>
Next: <a href="#Testing-a-Windows-Installation" accesskey="n" rel="next">Testing an Installation</a>, Previous: <a href="#Building-from-source" accesskey="p" rel="prev">Building from source</a>, Up: <a href="#Installing-R-under-Windows" accesskey="u" rel="up">Installing R under Windows</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Checking-the-build-1"></span><h3 class="section">3.2 Checking the build</h3>

<p>You can test a build by running
</p>
<div class="example">
<pre class="example">make check
</pre></div>

<p>The recommended packages can be checked by
</p>
<div class="example">
<pre class="example">make check-recommended
</pre></div>

<p>Other levels of checking are
</p>
<div class="example">
<pre class="example">make check-devel
</pre></div>

<p>for a more thorough check of the R functionality, and
</p>
<div class="example">
<pre class="example">make check-all
</pre></div>

<p>for both <code>check-devel</code> and <code>check-recommended</code>.
</p>
<p>If a test fails, there will almost always be a <samp>.Rout.fail</samp> file in
the directory being checked (often <samp>tests/Examples</samp> or
<samp>tests</samp>): examine the file to help pinpoint the problem.
</p>
<p>Parallel checking of package sources (part of <code>make check-devel</code>
and <code>make check-recommended</code>) is possible: see the environment
variable <code>TEST_MC_CORES</code> to the maximum number of processes to be
run in parallel.
</p>
<hr>
</div>
<div class="section" id="Testing-a-Windows-Installation">
<div class="header">
<p>
Previous: <a href="#Checking-the-build" accesskey="p" rel="prev">Checking the build</a>, Up: <a href="#Installing-R-under-Windows" accesskey="u" rel="up">Installing R under Windows</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Testing-an-Installation-1"></span><h3 class="section">3.3 Testing an Installation</h3>

<p>The Windows installer contains a set of test files used when building
R.
</p>
<p>The toolset is not needed to run these tests, but more comprehensive
analysis of errors will be given if <code>diff</code> is in the path.
</p>
<p>Launch either <code>Rgui</code> or <code>Rterm</code> (preferred), preferably with
<samp>--vanilla</samp>.  Then run
</p>
<div class="example">
<pre class="example">Sys.setenv(LC_COLLATE = &quot;C&quot;, LC_TIME=&quot;C&quot;, LANGUAGE = &quot;en&quot;)
tools::testInstalledBasic(&quot;both&quot;)
tools::testInstalledPackages(scope = &quot;base&quot;)
tools::testInstalledPackages(scope = &quot;recommended&quot;)
</pre></div>

<p>runs the basic tests and then all the tests on the standard and recommended
packages.  These tests can be run from anywhere: <code>testInstalledBasic</code>
writes results in the <samp>tests</samp> folder of the R home directory (as
given by <code>R.home()</code>) and <code>testInstalledPackages</code> under the current
directory unless a different one is specified by <code>outDir</code>.
</p>
<p>For the <samp>tests</samp> folder to be writeable, one normally needs to install
R to a directory other than the default <samp>C:\Program Files</samp>.  The
installer also allows to install R without Administrator privileges, see
the <a href="https://CRAN.R-project.org/bin/windows/base/rw-FAQ.html">R Windows
<acronym>FAQ</acronym></a> for more details.
</p>
<p>The results of <code>example(md5sums)</code> when testing <strong>tools</strong> may
differ from the reference output as some files are installed with
Windows&rsquo; CRLF line endings. Also, expect differences in
<samp>reg-plot-latin1.pdf</samp>.
</p>
<p>One can also run tests from the toolset shell (e.g.  <code>bash</code>) similarly
to a Unix-like installation.  Move to the home directory of the R
installation (as given by <code>R RHOME</code> or from R as <code>R.home()</code>)
and run
</p>
<div class="example">
<pre class="example">cd tests
## followed by one of
../bin/R CMD make check
../bin/R CMD make check-devel
../bin/R CMD make check-all
</pre></div>

<p>Remember that LaTeX needs to be on the path.
</p>
<hr>
</div>
</div>
<div class="chapter" id="Installing-R-under-macOS">
<div class="header">
<p>
Next: <a href="#Running-R" accesskey="n" rel="next">Running R</a>, Previous: <a href="#Installing-R-under-Windows" accesskey="p" rel="prev">Installing R under Windows</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Installing-R-under-macOS-1"></span><h2 class="chapter">4 Installing R under macOS</h2>
<span id="index-macOS-1"></span>


<p>[The rest of this paragraph is only relevant after release.]
The front page of a <acronym>CRAN</acronym> site has a link &lsquo;Download R for (Mac)
OS X&rsquo; which takes you to a new page. Two files are offered for download,
<samp>R-4.2.1.pkg</samp> and <samp>R-4.2.1-arm64.pkg</samp>.
The first runs on macOS 10.13 and later on &lsquo;<samp>x86_64</samp>&rsquo; (Intel) CPU
(High Sierra, Mojave, Catalina, Big Sur, Monterey, Ventura, &hellip;).  Package
<samp>R-4.2.1-arm64.pkg</samp> is a &lsquo;native&rsquo; build for &lsquo;Apple
Silicon&rsquo; (aka &lsquo;M1&rsquo;) Macs and runs on macOS 11 or later (Big Sur,
Monterey, Ventura, &hellip;).
</p>
<p><samp>R-4.2.1.pkg</samp> also be installed on &lsquo;Apple Silicon&rsquo; CPUs
using &lsquo;Rosetta&rsquo; emulation<a id="DOCF22" href="#FOOT22"><sup>22</sup></a>, but the native build is preferred.
It is a little faster (and for some tasks, considerably so) but may give
different numerical results from the more common &lsquo;<samp>x86_64</samp>&rsquo;
platforms (on Windows, Linux, &hellip; as well as macOS) as ARM hardware
lacks extended-precision floating-point operations.
</p>
<p>It is important that if you use a binary installer package that your OS
is fully updated: look at &lsquo;Software Update&rsquo; in &rsquo;System Preferences&rsquo;
(&lsquo;Updates&rsquo; from the &lsquo;App Store&rsquo; on Mojave and earlier) to be sure.
</p>
<p>To install, just double-click on the icon of the file you downloaded.
At the &lsquo;Installation Type&rsquo; stage, note the option to &lsquo;Customize&rsquo;.  This
currently shows four components: everyone will need the &lsquo;R Framework&rsquo;
component: the remaining components are optional. (The &lsquo;Tcl/Tk&rsquo;
component is needed to use package <strong>tcltk</strong>. The &lsquo;Texinfo&rsquo; component
is only needed by those installing source packages or R from its
sources.)
</p>
<p>These are Apple Installer packages.  If you encounter any problem during
the installation, please check the Installer log by clicking on the
&ldquo;Window&rdquo; menu and item &ldquo;Installer Log&rdquo;. The full output (select
&ldquo;Show All Log&rdquo;) is useful for tracking down problems.  Note the the
installer is clever enough to try to upgrade the last-installed version
of the application where you installed it (which may not be where you
want this time &hellip;).
</p>
<p>Various parts of the build require XQuartz to be installed: see
<a href="https://www.xquartz.org/releases/">https://www.xquartz.org/releases/</a>.<a id="DOCF23" href="#FOOT23"><sup>23</sup></a>
These include the <strong>tcltk</strong> package and the <code>X11</code> graphics device:
attempting to use these without XQuartz will if possible remind
you.<a id="DOCF24" href="#FOOT24"><sup>24</sup></a>  This is also needed for some
<span id="index-Cairo"></span>
builds of the cairographics-based devices (which are not often used on
macOS) such as <code>png(type = &quot;cairo&quot;)</code> and <code>svg()</code> and some
third-party packages (e.g. <a href="https://CRAN.R-project.org/package=rgl"><strong>rgl</strong></a>).
</p>
<p>If you update your macOS version, you should re-install R (and
perhaps XQuartz): the installer may tailor the installation to the
current version of the OS.
</p>
<p>Installers for R-patched and R-devel are usually available from
<a href="https://mac.R-project.org">https://mac.R-project.org</a>.  (Some of these packages may be
unsigned/not notarized: to install those Control/right/two-finger click,
select &lsquo;<samp>Open With</samp>&rsquo; and &lsquo;<samp>Installer</samp>&rsquo;.)
</p>
<p>For building R from source, see <a href="#macOS">macOS</a>.  This can in principle
be done for some older versions of the OS (it is little tested).
</p>



<ul class="section-toc">
<li><a href="#Running-R-under-macOS" accesskey="1">Running R under macOS</a></li>
<li><a href="#Uninstalling-under-macOS" accesskey="2">Uninstalling under macOS</a></li>
<li><a href="#Multiple-versions" accesskey="3">Multiple versions</a></li>
</ul>
<hr>
<div class="section" id="Running-R-under-macOS">
<div class="header">
<p>
Next: <a href="#Uninstalling-under-macOS" accesskey="n" rel="next">Uninstalling under macOS</a>, Previous: <a href="#Installing-R-under-macOS" accesskey="p" rel="prev">Installing R under macOS</a>, Up: <a href="#Installing-R-under-macOS" accesskey="u" rel="up">Installing R under macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Running-R-under-macOS-1"></span><h3 class="section">4.1 Running R under macOS</h3>

<p>There are two ways to run R on macOS from a <acronym>CRAN</acronym> binary
distribution.
</p>
<p>There is a GUI console normally installed with the R icon in
<samp>/Applications</samp> which you can run by double-clicking (e.g. from
Launchpad or Finder).  (If you cannot find it there it was possibly
installed elsewhere so try searching for it in Spotlight.) This is
usually referred to as <small>R.APP</small> to distinguish it from command-line R:
its user manual is currently part of the macOS FAQ at
<a href="https://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html">https://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html</a> and
can be viewed from <small>R.APP</small>&rsquo;s &lsquo;Help&rsquo; menu.
</p>

<p>You can run command-line R and <code>Rscript</code> from a
Terminal<a id="DOCF25" href="#FOOT25"><sup>25</sup></a> so these can be typed as commands
as on any other Unix-alike: see the next chapter of this manual.  There
are some small differences which may surprise users of R on other
platforms, notably the default location of the personal library
directory (under <samp>~/Library/R</samp>, e.g.
<samp>~/Library/R/x86_64/4.2/library</samp>), and that warnings, messages and
other output to <samp>stderr</samp> are highlighted in bold.
</p>
<p>Those using the <code>zsh</code> shell (the default for new user accounts
as from Catalina) might find the command <code>R</code> being masked by the
<code>zsh</code> builtin <code>r</code> (which recalls commands).  One can use
a full path to R in an alias, or add <code>disable r</code> to
<samp>~/.zshrc</samp>.
</p>
<p>If you have installed both installer packages on an <code>arm64</code> Mac,
the last installed will be used.
</p>
<p>It has been reported that running <small>R.APP</small> may fail if no preferences are
stored, so if it fails when launched for the very first time, try it
again (the first attempt will store some preferences).
</p>
<p>Users of <small>R.APP</small> need to be aware of the &lsquo;App Nap&rsquo; feature
(<a href="https://developer.apple.com/library/archive/releasenotes/MacOSX/WhatsNewInOSX/Articles/MacOSX10_9.html">https://developer.apple.com/library/archive/releasenotes/MacOSX/WhatsNewInOSX/Articles/MacOSX10_9.html</a>)
which can cause R tasks to appear to run very slowly when not
producing output in the console.  Here are ways to avoid it:
</p>
<ul>
<li> Ensure that the console is completely visible (or at least the activity
indicator at the top right corner is visible).

</li><li> In a Terminal, run
<div class="example">
<pre class="example">defaults write org.R-project.R NSAppSleepDisabled -bool YES
</pre></div>

<p>(see <a href="https://developer.apple.com/library/archive/releasenotes/MacOSX/WhatsNewInOSX/Articles/MacOSX10_9.html">https://developer.apple.com/library/archive/releasenotes/MacOSX/WhatsNewInOSX/Articles/MacOSX10_9.html</a>).
</p></li></ul>

<p>Using the <code>X11</code> graphics device or the X11-based versions of <code>View()</code>
and <code>edit()</code> for data frames and matrices (the latter are the
default for command-line R but not <small>R.APP</small>) requires
<a href="https://www.xquartz.org/">XQuartz</a> to be installed.
</p>
<p>Under some rather nebulous circumstances messages have been seen from
<code>fontconfig</code> about missing/unreadable configuration files when
using cairo-based devices, especially <code>X11(type = &quot;cairo&quot;)</code>.  With
XQuartz installed there are two <code>fontconfig</code> areas from different
versions and it can help to set
</p><div class="example">
<pre class="example">setenv FONTCONFIG_PATH /opt/X11/lib/X11/fontconfig
</pre></div>
<p>Another symptom has been that italic/oblique fonts are replaced by
upright ones.
</p>
<hr>
</div>
<div class="section" id="Uninstalling-under-macOS">
<div class="header">
<p>
Next: <a href="#Multiple-versions" accesskey="n" rel="next">Multiple versions</a>, Previous: <a href="#Running-R-under-macOS" accesskey="p" rel="prev">Running R under macOS</a>, Up: <a href="#Installing-R-under-macOS" accesskey="u" rel="up">Installing R under macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Uninstalling-under-macOS-1"></span><h3 class="section">4.2 Uninstalling under macOS</h3>

<p>R for macOS consists of two parts: the GUI (<small>R.APP</small>) and the R
framework. Un-installation is as simple as removing those folders
(e.g. by dragging them onto the Trash aka Bin). The typical installation will
install the GUI into the <samp>/Applications/R.app</samp> folder and the R
framework into the <samp>/Library/Frameworks/R.framework</samp> folder.  The
links to <samp>R</samp> and <samp>Rscript</samp> in <samp>/usr/local/bin</samp> should
also be removed.
</p>
<p>If you want to get rid of R more completely using a Terminal, simply
run:
</p>
<div class="example">
<pre class="example">sudo rm -Rf /Library/Frameworks/R.framework /Applications/R.app \
   /usr/local/bin/R /usr/local/bin/Rscript
</pre></div>

<p>The installation consists of up to four Apple packages:<a id="DOCF26" href="#FOOT26"><sup>26</sup></a> for the Intel build, <code>org.R-project.R.fw.pkg</code>,
<code>org.R-project.R.GUI.pkg</code>, <code>org.r-project.x86_64.tcltk.x11</code>
and <code>org.r-project.x86_64.texinfo</code>. You can use <code>sudo pkgutil
--forget</code> if you want the Apple Installer to forget about the package
without deleting its files (useful for the R framework when
installing multiple R versions in parallel), or after you have
deleted the files. <strong>NB:</strong> the package names are case-sensitive and
the R domain is given inconsistently.
</p>
<p>Uninstalling the Tcl/Tk and Texinfo components (which are installed under
<samp>/usr/local</samp> on a &lsquo;<samp>x86_64</samp>&rsquo; build and <samp>/opt/R/arm64</samp>
for an &lsquo;<samp>arm64</samp>&rsquo; one) is not as simple.  You can list the files
they installed in a Terminal by e.g.
</p>
<div class="example">
<pre class="example">pkgutil --files org.r-project.x86_64.tcltk.x11
pkgutil --files org.r-project.x86_64.texinfo
</pre></div>

<p>(For the &lsquo;Apple Silicon&rsquo; build, replace <code>x86_64</code> by <code>arm64</code>.)
These are paths relative to <samp>/</samp>, the root of the file system.
</p>


<hr>
</div>
<div class="section" id="Multiple-versions">
<div class="header">
<p>
Previous: <a href="#Uninstalling-under-macOS" accesskey="p" rel="prev">Uninstalling under macOS</a>, Up: <a href="#Installing-R-under-macOS" accesskey="u" rel="up">Installing R under macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Multiple-versions-1"></span><h3 class="section">4.3 Multiple versions</h3>

<p>The installer will remove any previous version<a id="DOCF27" href="#FOOT27"><sup>27</sup></a> of the R framework which it finds
installed.  This can be avoided by using <code>pkgutil --forget</code> (see
the previous section).  However, note that different versions are
installed under <samp>/Library/Frameworks/R.framework/Versions</samp> as
<samp>4.2</samp> (or <samp>4.2-arm64</samp>), <samp>4.1</samp> and so on, so it is not
possible to have different &lsquo;<samp>4.x.y</samp>&rsquo; versions installed for the same
&lsquo;<samp>x</samp>&rsquo; and CPU type.
</p>
<p><small>R.APP</small> will always run the &lsquo;current&rsquo; version, that is the last
installed version.
</p>

<hr>
</div>
</div>
<div class="chapter" id="Running-R">
<div class="header">
<p>
Next: <a href="#Add_002don-packages" accesskey="n" rel="next">Add-on packages</a>, Previous: <a href="#Installing-R-under-macOS" accesskey="p" rel="prev">Installing R under macOS</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Running-R-1"></span><h2 class="chapter">5 Running R</h2>

<p>How to start R and what command-line options are available is discussed
in <a data-manual="R-intro" href="https://cran.r-project.org/doc/manuals/R-intro.html#Invoking-R">Invoking R</a> in <cite>An Introduction to R</cite>.
</p>
<p>You should ensure that the shell has set adequate resource limits: R
expects a stack size of at least 8MB and to be able to open at least 256
file descriptors.  (Any modern OS should have default limits at least as
large as these, but apparently NetBSD may not.  Use the shell command
<code>ulimit</code> (<code>sh</code>/<code>bash</code>) or <code>limit</code>
(<code>csh</code>/<code>tcsh</code>) to check.)  For some
compilers<a id="DOCF28" href="#FOOT28"><sup>28</sup></a> and packages a larger
stack size has been needed: 20-25MB has sufficed to date.
</p>
<p>R makes use of a number of environment variables, the default values
of many of which are set in file <samp><var>R_HOME</var>/etc/Renviron</samp> (there
are none set by default on Windows and hence no such file).  These are
set at <code>configure</code> time, and you would not normally want to
<span id="index-R_005fPAPERSIZE-1"></span>
change them &ndash; a possible exception is <code>R_PAPERSIZE</code> (see <a href="#Setting-paper-size">Setting paper size</a>).  The paper size will be deduced from the &lsquo;<samp>LC_PAPER</samp>&rsquo;
locale category if it exists and <code>R_PAPERSIZE</code> is unset, and this
will normally produce the right choice from &lsquo;<samp>a4</samp>&rsquo; and &lsquo;<samp>letter</samp>&rsquo;
on modern Unix-alikes (but can always be overridden by setting
<code>R_PAPERSIZE</code>).
</p>
<p>Various environment variables can be set to determine where R creates
its per-session temporary directory.  The environment variables
<span id="index-TMPDIR-1"></span>
<span id="index-TMP"></span>
<span id="index-TEMP"></span>
<code>TMPDIR</code>, <code>TMP</code> and <code>TEMP</code> are searched in turn and the
first one which is set and points to a writable area is used.  If none
do, the final default is <samp>/tmp</samp> on Unix-alikes and the value of
<span id="index-R_005fUSER"></span>
<code>R_USER</code> on Windows.  The path should be an absolute path not
containing spaces (and it is best to avoid non-alphanumeric characters
such as <code>+</code>).
</p>
<p>Some Unix-alike systems are set up to remove files and directories
periodically from <samp>/tmp</samp>, for example by a <code>cron</code> job
<span id="index-TMPDIR-2"></span>
running <code>tmpwatch</code>.  Set <code>TMPDIR</code> to another directory
before starting long-running jobs on such a system.
</p>
<p>Note that <code>TMPDIR</code> will be used to execute <code>configure</code>
scripts when installing packages, so if <samp>/tmp</samp> has been mounted as
&lsquo;<samp>noexec</samp>&rsquo;, <code>TMPDIR</code> needs to be set to a directory from which
execution is allowed.
</p>
<hr>
</div>
<div class="chapter" id="Add_002don-packages">
<div class="header">
<p>
Next: <a href="#Internationalization" accesskey="n" rel="next">Internationalization and Localization</a>, Previous: <a href="#Running-R" accesskey="p" rel="prev">Running R</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Add_002don-packages-1"></span><h2 class="chapter">6 Add-on packages</h2>
<span id="index-Packages"></span>
<span id="index-Libraries"></span>


<p>It is helpful to use the correct terminology.  A <em>package</em> is
loaded from a <em>library</em> by the function <code>library()</code>.  Thus a
library is a directory containing installed packages; the main library
is <samp><var>R_HOME</var>/library</samp>, but others can be used, for example by
<span id="index-R_005fLIBS"></span>
setting the environment variable <code>R_LIBS</code> or using the R function
<code>.libPaths()</code>.  To avoid any confusion you will often see a library
directory referred to as a &lsquo;library tree&rsquo;.
</p>
<ul class="section-toc">
<li><a href="#Default-packages" accesskey="1">Default packages</a></li>
<li><a href="#Managing-libraries" accesskey="2">Managing libraries</a></li>
<li><a href="#Installing-packages" accesskey="3">Installing packages</a></li>
<li><a href="#Updating-packages" accesskey="4">Updating packages</a></li>
<li><a href="#Removing-packages" accesskey="5">Removing packages</a></li>
<li><a href="#Setting-up-a-package-repository" accesskey="6">Setting up a package repository</a></li>
<li><a href="#Checking-installed-source-packages" accesskey="7">Checking installed source packages</a></li>
</ul>
<hr>
<div class="section" id="Default-packages">
<div class="header">
<p>
Next: <a href="#Managing-libraries" accesskey="n" rel="next">Managing libraries</a>, Previous: <a href="#Add_002don-packages" accesskey="p" rel="prev">Add-on packages</a>, Up: <a href="#Add_002don-packages" accesskey="u" rel="up">Add-on packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Default-packages-1"></span><h3 class="section">6.1 Default packages</h3>
<span id="index-Packages_002c-default"></span>

<p>The set of packages loaded on startup is by default
</p>
<div class="example">
<pre class="example">&gt; getOption(&quot;defaultPackages&quot;)
[1] &quot;datasets&quot;  &quot;utils&quot;     &quot;grDevices&quot; &quot;graphics&quot;  &quot;stats&quot;     &quot;methods&quot;
</pre></div>

<p>(plus, of course, <strong>base</strong>) and this can be changed by setting the
option in startup code (e.g. in <samp>~/.Rprofile</samp>).  It is initially
<span id="index-R_005fDEFAULT_005fPACKAGES"></span>
set to the value of the environment variable <code>R_DEFAULT_PACKAGES</code> if
set (as a comma-separated list).  Setting <code>R_DEFAULT_PACKAGES=NULL</code>
ensures that only package <strong>base</strong> is loaded.
</p>
<p>Changing the set of default packages is normally used to reduce the set
for speed when scripting: in particular not using <strong>methods</strong> will
reduce the start-up time by a factor of up to two.  But it can also be
used to customize R, e.g. for class use. <code>Rscript</code>
also checks the environment variable <code>R_SCRIPT_DEFAULT_PACKAGES</code>;
<span id="index-R_005fSCRIPT_005fDEFAULT_005fPACKAGES"></span>
if set, this takes precedence over <code>R_DEFAULT_PACKAGES</code>.
</p>

<hr>
</div>
<div class="section" id="Managing-libraries">
<div class="header">
<p>
Next: <a href="#Installing-packages" accesskey="n" rel="next">Installing packages</a>, Previous: <a href="#Default-packages" accesskey="p" rel="prev">Default packages</a>, Up: <a href="#Add_002don-packages" accesskey="u" rel="up">Add-on packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Managing-libraries-1"></span><h3 class="section">6.2 Managing libraries</h3>
<span id="index-Libraries_002c-managing"></span>

<p>R packages are installed into <em>libraries</em>, which are
directories in the file system containing a subdirectory for each
package installed there.
</p>
<p>R comes with a single library, <samp><var>R_HOME</var>/library</samp> which is
the value of the R object &lsquo;<samp>.Library</samp>&rsquo; containing the standard and
recommended<a id="DOCF29" href="#FOOT29"><sup>29</sup></a>  packages.
Both sites and users can create others and make use of them (or not) in
an R session.  At the lowest level &lsquo;<samp>.libPaths()</samp>&rsquo; can be used to
add paths to the collection of libraries or to report the current
collection.
</p>
<span id="index-Libraries_002c-site"></span>
<span id="index-Site-libraries"></span>
<p>R will automatically make use of a site-specific library
<samp><var>R_HOME</var>/site-library</samp> if this exists (it does not in a
vanilla R installation).  This location can be overridden by
setting<a id="DOCF30" href="#FOOT30"><sup>30</sup></a> &lsquo;<samp>.Library.site</samp>&rsquo; in
<samp><var>R_HOME</var>/etc/Rprofile.site</samp>, or (not recommended) by setting
the
<span id="index-R_005fLIBS_005fSITE"></span>
environment variable <code>R_LIBS_SITE</code>.
</p>
<span id="index-Libraries_002c-user"></span>
<span id="index-User-libraries"></span>
<span id="index-R_005fLIBS_005fUSER"></span>
<p>Users can have one or more libraries, normally specified by the
environment variable <code>R_LIBS_USER</code>.  This has a default value (to
see it, use &lsquo;<samp>Sys.getenv(&quot;R_LIBS_USER&quot;)</samp>&rsquo; within an R session),
but that is only used if the corresponding directory actually exists
(which by default it will not).
</p>
<p>Both <code>R_LIBS_USER</code> and <code>R_LIBS_SITE</code> can specify multiple
library paths, separated by colons (semicolons on Windows).
</p>

<hr>
</div>
<div class="section" id="Installing-packages">
<div class="header">
<p>
Next: <a href="#Updating-packages" accesskey="n" rel="next">Updating packages</a>, Previous: <a href="#Managing-libraries" accesskey="p" rel="prev">Managing libraries</a>, Up: <a href="#Add_002don-packages" accesskey="u" rel="up">Add-on packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Installing-packages-1"></span><h3 class="section">6.3 Installing packages</h3>
<span id="index-Packages_002c-installing"></span>



<p>Packages may be distributed in source form or compiled binary form.
Installing source packages which contain C/C++/Fortran code requires
that compilers and related tools be installed.  Binary packages are
platform-specific and generally need no special tools to install, but
see the documentation for your platform for details.
</p>
<p>Note that you may need to specify implicitly or explicitly the library to
which the package is to be installed.  This is only an issue if you have
more than one library, of course.
</p>

<span id="index-TMPDIR-3"></span>
<p>Ensure that the environment variable <code>TMPDIR</code> is either unset (and
<samp>/tmp</samp> exists and can be written in and executed from) or is the
absolute path to a valid temporary directory, not containing spaces.
</p>
<p>For most users it suffices to call
&lsquo;<samp>install.packages(<var>pkgname</var>)</samp>&rsquo; or its GUI equivalent if the
intention is to install a <acronym>CRAN</acronym> package and internet access is
available.<a id="DOCF31" href="#FOOT31"><sup>31</sup></a>  On most systems &lsquo;<samp>install.packages()</samp>&rsquo;
will allow packages to be selected from a list box (typically with
thousands of items).
</p>
<p>To install packages from source on a Unix-alike use in a terminal
</p>
<div class="example">
<pre class="example">R CMD INSTALL -l /path/to/library <var>pkg1</var> <var>pkg2</var> &hellip;
</pre></div>

<p>The part &lsquo;<samp>-l /path/to/library</samp>&rsquo; can be omitted, in which case the
first library of a normal R session is used (that shown by
<code>.libPaths()[1]</code>).
</p>
<p>There are a number of options available: use <code>R CMD INSTALL --help</code>
to see the current list.
</p>
<span id="index-install_002epackages"></span>
<p>Alternatively, packages can be downloaded and installed from within
R.  First choose your nearest <acronym>CRAN</acronym> mirror using
<code>chooseCRANmirror()</code>.  Then download and install packages
<strong>pkg1</strong> and <strong>pkg2</strong> by
</p>
<div class="example">
<pre class="example">&gt; install.packages(c(&quot;pkg1&quot;, &quot;pkg2&quot;))
</pre></div>

<p>The essential dependencies of the specified packages will also be fetched.
Unless the library is specified (argument <code>lib</code>) the first library
in the library search path is used: if this is not writable, R will
ask the user (in an interactive session) if the default personal library
should be created, and if allowed to will install the packages there.
</p>

<p>If you want to fetch a package and all those it depends on (in any way)
that are not already installed, use e.g.
</p>
<div class="example">
<pre class="example">&gt; install.packages(&quot;Rcmdr&quot;, dependencies = TRUE)
</pre></div>

<p><code>install.packages</code> can install a source package from a local
<samp>.tar.gz</samp> file (or a URL to such a file) by setting argument
<code>repos</code> to <code>NULL</code>: this will be selected automatically if the
name given is a single <samp>.tar.gz</samp> file.
</p>
<p><code>install.packages</code> can look in several repositories, specified as a
character vector by the argument <code>repos</code>: these can include a
<acronym>CRAN</acronym> mirror, Bioconductor, R-forge, rforge.net,
local archives, local files, &hellip;).  Function
<code>setRepositories()</code> can select amongst those repositories that the
R installation is aware of.
</p>
<p>Something which sometimes puzzles users is that <code>install.packages()</code>
may report that a package which they believe should be available is not
found.  Some possible reasons:
</p><ul>
<li> The package, such as <strong>grid</strong> or <strong>tcltk</strong>, is part of R
itself and not otherwise available.

</li><li> The package is not in the available repositories, so check which have been
selected by
<div class="example">
<pre class="example">getOption(&quot;repos&quot;)
</pre></div>

</li><li> The package is available, but not for the current version of R or for
the type of OS (Unix/Windows).  To retrieve the information on available
versions of package <code><var>pkg</var></code>, use

<div class="example">
<pre class="example">av &lt;- available.packages(filters=list())
av[av[, &quot;Package&quot;] == <var>pkg</var>, ]
</pre></div>

<p>in your R session, and look at the &lsquo;<samp>Depends</samp>&rsquo; and &lsquo;<samp>OS_type</samp>&rsquo;
fields (there may be more than one matching entry).  If the package
depends on a version of R later than the one in use, it is possible
that an earlier version is available which will work with your version
of R: for <acronym>CRAN</acronym> look for &lsquo;Old sources&rsquo; on the package&rsquo;s
<acronym>CRAN</acronym> landing page and manually retrieve an appropriate version (of
comparable age to your version of R).
</p></li></ul>

<p>Naive users sometimes forget that as well as installing a package, they
have to use <code>library</code> to make its functionality available.
</p>
<ul class="section-toc">
<li><a href="#Windows-packages" accesskey="1">Windows</a></li>
<li><a href="#macOS-packages" accesskey="2">macOS</a></li>
<li><a href="#Customizing-package-compilation" accesskey="3">Customizing package compilation</a></li>
<li><a href="#Multiple-sub_002darchitectures" accesskey="4">Multiple sub-architectures</a></li>
<li><a href="#Byte_002dcompilation" accesskey="5">Byte-compilation</a></li>
<li><a href="#External-software" accesskey="6">External software</a></li>
</ul>
<hr>
<div class="subsection" id="Windows-packages">
<div class="header">
<p>
Next: <a href="#macOS-packages" accesskey="n" rel="next">macOS</a>, Previous: <a href="#Installing-packages" accesskey="p" rel="prev">Installing packages</a>, Up: <a href="#Installing-packages" accesskey="u" rel="up">Installing packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Windows"></span><h4 class="subsection">6.3.1 Windows</h4>

<p>What <code>install.packages</code> does by default is different on Unix-alikes
(except macOS) and Windows.  On Unix-alikes it consults the list of
available <em>source</em> packages on <acronym>CRAN</acronym> (or other
repository/ies), downloads the latest version of the package sources,
and installs them (via <code>R CMD INSTALL</code>).  On Windows it looks (by
default) first at the list of <em>binary</em> versions of packages
available for your version of R and downloads the latest versions (if
any).  If no binary version is available or the source version is newer,
it will install the source versions of packages without compiled
C/C++/Fortran code, and offer to do so for those with, if <code>make</code>
is available (and this can be tuned by option
<code>&quot;install.packages.compile.from.source&quot;</code>).
</p>
<p>On Windows <code>install.packages</code> can also install a binary package
from a local <samp>zip</samp> file (or the URL of such a file) by setting
argument <code>repos</code> to <code>NULL</code>.  <code>Rgui.exe</code> has a menu
<code>Packages</code> with a GUI interface to <code>install.packages</code>,
<code>update.packages</code> and <code>library</code>.
</p>
<p>Windows binary packages for R are distributed as a single binary
containing either or both architectures (32- and 64-bit). From R 4.2.0,
they always contain only the 64-bit architecture.
</p>

<p><code>R CMD INSTALL</code> works in Windows to install source packages.  No
additional tools are needed if the package does not contain compiled
code, and <code>install.packages(type=&quot;source&quot;)</code> will work for such
packages. Those with compiled code need the tools (see <a href="#The-Windows-toolset">The Windows toolset</a>). The tools are found automatically by R when installed by
the toolset installer. See
<a href="https://cran.r-project.org/bin/windows/base/howto-R-4.2.html">Building
R and packages</a> for more details.
</p>
<p>Occasional permission problems after unpacking source packages have been
seen on some systems: these have been circumvented by setting the
environment variable <code>R_INSTALL_TAR</code> to &lsquo;<samp>tar.exe</samp>&rsquo;.
<span id="index-R_005fINSTALL_005fTAR"></span>
</p>
<p>If you have only a source package that is known to work with current
R and just want a binary Windows build of it, you could make use of
the building service offered at
<a href="https://win-builder.r-project.org/">https://win-builder.r-project.org/</a>.
</p>
<p>For almost all packages <code>R CMD INSTALL</code> will attempt to install
both 32- and 64-bit builds of a package if run from a 32/64-bit install
of R (only 64-bit builds and installs are supported since R 4.2.0).
It will report success if the installation of the architecture
of the running <code>R</code> succeeded, whether or not the other
architecture was successfully installed.  The exceptions are packages
with a non-empty <samp>configure.win</samp> script or which make use of
<samp>src/Makefile.win</samp>.  If <samp>configure.win</samp> does something
appropriate to both architectures use<a id="DOCF32" href="#FOOT32"><sup>32</sup></a> option
<samp>--force-biarch</samp>: otherwise <code>R CMD INSTALL
--merge-multiarch</code> can be applied to a source tarball to merge separate
32- and 64-bit installs.  (This can only be applied to a tarball, and
will only succeed if both installs succeed.)
</p>
<p>If you have a package without compiled code and no Windows-specific
help, you can zip up an installation on another OS and install from that
zip file on Windows.  However, such a package can be installed from the
sources on Windows without any additional tools.
</p>

<hr>
</div>
<div class="subsection" id="macOS-packages">
<div class="header">
<p>
Next: <a href="#Customizing-package-compilation" accesskey="n" rel="next">Customizing package compilation</a>, Previous: <a href="#Windows-packages" accesskey="p" rel="prev">Windows</a>, Up: <a href="#Installing-packages" accesskey="u" rel="up">Installing packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="macOS-1"></span><h4 class="subsection">6.3.2 macOS</h4>

<p>On macOS <code>install.packages</code> works as it does on other Unix-alike
systems, but there is an additional type <code>mac.binary</code> (available
for the <acronym>CRAN</acronym> distribution but not when compiling R from
source) which can be passed to <code>install.packages</code> in order to
download and install binary packages from a suitable repository.  These
binary package files for macOS have the extension &lsquo;<samp>.tgz</samp>&rsquo;.  The
<small>R.APP</small> GUI provides menus for installation of either binary or source
packages, from <acronym>CRAN</acronym>, other repositories or local files.
</p>
<p>On R builds using binary packages, the default is type <code>both</code>:
this looks first at the list of binary packages available for your
version of R and installs the latest versions (if any).  If no binary
version is available or the source version is newer, it will install the
source versions of packages without compiled C/C++/Fortran code and offer
to do so for those with, if <code>make</code> is available.
</p>
<p>Note that most binary packages which include compiled code are tied to a
particular series (e.g. R 4.1.x or 4.2.x) of R.
</p>
<p>Installing source packages which do not contain compiled code should
work with no additional tools. For others you will need the
&lsquo;Command Line Tools&rsquo; for <code>Xcode</code> and compilers which match those
used to build R: see <a href="#macOS">macOS</a>.
</p>
<p>Package <a href="https://CRAN.R-project.org/package=rJava"><strong>rJava</strong></a> and those which depend on it need a Java runtime
installed and several packages need X11 installed, including those using
Tk.  See <a href="#macOS">macOS</a> and <a href="#Java-_0028macOS_0029">Java</a>.  Package <a href="https://CRAN.R-project.org/package=rjags"><strong>rjags</strong></a>
needs a build of JAGS installed under <samp>/usr/local</samp>, such as those
at
<a href="https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/Mac%20OS%20X/">https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/Mac%20OS%20X/</a>.
</p>
<p>Tcl/Tk extension <code>BWidget</code> used to be
distributed with R but no longer is; <code>Tktable</code> has been
distributed with most versions of R (but not 4.0.0 and not
&lsquo;<samp>arm64</samp>&rsquo; builds of 4.1.0 or 4.1.1).
</p>
<p>A few of the binary packages need other software to be installed on your
system.  In particular packages using Gtk+ (<a href="https://CRAN.R-project.org/package=RGtk2"><strong>RGtk2</strong></a>,
<a href="https://CRAN.R-project.org/package=cairoDevice"><strong>cairoDevice</strong></a> and those that depend on them) need the GTK
framework installed from <a href="https://mac.R-project.org/libs/">https://mac.R-project.org/libs/</a>: the
appropriate version at the time of writing was
<a href="https://mac.R-project.org/libs/GTK_2.24.17-X11.pkg">https://mac.R-project.org/libs/GTK_2.24.17-X11.pkg</a>.
</p>
<p>The same instructions apply when installing binary packages into the
<acronym>CRAN</acronym> distribution of R running on an &lsquo;<samp>arm64</samp>&rsquo; (aka
&lsquo;Apple Silicon&rsquo; aka &lsquo;M1&rsquo;) Mac.
</p>
<p>The default compilers specified are shown in file
<samp>/Library/Frameworks/R.framework/Resources/etc/Makeconf</samp>.  At
the time of writing those settings assumed that the C, Fortran and C++
compilers were on the path, using <code>gfortran</code> 8.2.0 (see
<a href="#macOS">macOS</a>).  The settings can be changed, either by editing that file
or in a file such as <samp>~/.R/Makevars</samp> (see the next section).
Entries which may need to be changed include &lsquo;<samp>CC</samp>&rsquo;, &lsquo;<samp>CXX</samp>&rsquo;,
&lsquo;<samp>FC</samp>&rsquo;, &lsquo;<samp>FLIBS</samp>&rsquo; and the corresponding flags, and perhaps
&lsquo;<samp>CXXCPP</samp>&rsquo;, &lsquo;<samp>DYLIB_LD</samp>&rsquo;, &lsquo;<samp>MAIN_LD</samp>&rsquo;, &lsquo;<samp>SHLIB_CXXLD</samp>&rsquo; and
&lsquo;<samp>SHLIB_LD</samp>&rsquo;, as well as the &lsquo;<samp>CXX11</samp>&rsquo;, &lsquo;<samp>CXX14</samp>&rsquo;,
&lsquo;<samp>CXX17</samp>&rsquo; and &lsquo;<samp>CXX20</samp>&rsquo; variants
</p>
<p>So for example on Mojave or later you could select a specific LLVM
<code>clang</code> for both C and C++ with extensive checking by having in
<samp>~/.R/Makevars</samp>
</p><div class="example">
<pre class="example">CC = /usr/local/clang/bin/clang -isysroot
  /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk
CXX = /usr/local/clang/bin/clang++ -isysroot
  /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk
CXX11 = $CXX
CXX14 = $CXX
CXX17 = $CXX
CXX20 = $CXX
CFLAGS = -g -O2 -Wall -pedantic -Wconversion -Wno-sign-conversion
CXXFLAGS = -g -O2 -Wall -pedantic -Wconversion -Wno-sign-conversion
CXX11FLAGS = $CXXFLAGS
CXX14FLAGS = $CXXFLAGS
CXX17FLAGS = $CXXFLAGS
CXX20FLAGS = $CXXFLAGS
</pre></div>
<p>(long lines split for the manual only) and <code>gfortran</code> by
</p><div class="example">
<pre class="example">FC = /usr/local/gfortran/bin/gfortran
FLIBS = -L/usr/local/gfortran/lib/gcc/x86_64-apple-darwin18/8.2.0
  -L/usr/local/gfortran/lib -lgfortran -lquadmath -lm
</pre></div>
<p>(with lines broken here for legibility).  If that <code>clang</code> build
supports OpenMP, you can add
</p><div class="example">
<pre class="example">SHLIB_OPENMP_CFLAGS = -fopenmp
SHLIB_OPENMP_CXXFLAGS = -fopenmp
</pre></div>
<p>to compile OpenMP-using packages.  It will also be necessary to arrange
for the <code>libomp.dylib</code> library to be found at both install time and run
time, for example by copying/linking it somewhere that is searched such
as <samp>/usr/local/lib</samp>.
</p>



<p>Apple includes many Open Source libraries in macOS but increasingly
without the corresponding headers (not even in Xcode nor the Command
Line Tools): they are often rather old versions.  If installing packages
from source using them it is usually easiest to install a
statically-linked up-to-date copy of the Open Source package from its
sources or from <a href="https://mac.r-project.org/bin/darwin17/x86_64/">https://mac.r-project.org/bin/darwin17/x86_64/</a>.
But sometimes it is desirable/necessary to use Apple&rsquo;s dynamically
linked library, in which case appropriate headers could be extracted
from the sources<a id="DOCF33" href="#FOOT33"><sup>33</sup></a> available <em>via</em>
<a href="https://opensource.apple.com">https://opensource.apple.com</a> &ndash; this has been used for
<code>OpenSSL</code><a id="DOCF34" href="#FOOT34"><sup>34</sup></a> and
<code>iodbc</code>.
</p>
<p>Those using Command Line Tools / Xcode 12 or later (as released for
macOS 11 &lsquo;Big Sur&rsquo;) probably want to arrange that the flag
</p>
<div class="example">
<pre class="example">-Wno-implicit-function-declaration
</pre></div>

<p>is part of <code>CFLAGS</code>.  Apple has changed the default to make
implicit declarations a compilation error (something seen in no other
compiler) and understandably authors of packages and external software
have been unaware that this might be done &mdash; most issues seen were in
<code>configure</code> scripts.
</p>
<p>Some care may be needed with selecting compilers when installing external
software for use with packages.  The &lsquo;system&rsquo; compilers as used when
building R are <code>clang</code> and <code>clang++</code>, but the Apple
toolchain also provides compilers called <code>gcc</code> and <code>g++</code>
which despite their names are based on LLVM and <code>libc++</code> like the
system ones and which behave in almost the same way as the system ones.
Most Open Source software has a <code>configure</code> script developed
using GNU <code>autoconf</code> and hence will select <code>gcc</code> and
<code>g++</code> as the default compilers: this usually works fine.  For
consistency one can use
</p>
<div class="example">
<pre class="example">./configure CC=clang CFLAGS=-O2 CXX=clang++ CXXFLAGS=-O2
</pre></div>

<p>(avoiding <code>autoconf</code>&rsquo;s default <samp>-g</samp>).  Be careful if you
put the <samp>/usr/local/gfortran/bin</samp> directory on your path as that
contains (real) <code>gcc</code> and <code>g++</code> which may be found
rather the Apple-provided commands, and may not be able to find the
headers and libraries<a id="DOCF35" href="#FOOT35"><sup>35</sup></a> of the SDK.
</p>
<p>For &lsquo;<samp>arm64</samp>&rsquo;, not all configure scripts have been updated to
recognize the platform and so might need the flag
<samp>--build=aarch64-apple-darwin20.1.0</samp>.  Also, be aware that
running the compilers from a &lsquo;<samp>x86_64</samp>&rsquo; application switches them
to generating code for that CPU: this applies to a Terminal, a shell,
older <code>cmake</code> or (non-system) <code>make</code>, and from
<code>R CMD INSTALL</code> or <code>install.packages()</code>.  One can use
</p>
<div class="example">
<pre class="example">./configure CC=&quot;clang -arch arm64&quot; CFLAGS=-O2 CXX=&quot;clang++ -arch arm64&quot; CXXFLAGS=-O2
</pre></div>

<p>to force &lsquo;<samp>arm64</samp>&rsquo; code.
</p>

<hr>
</div>
<div class="subsection" id="Customizing-package-compilation">
<div class="header">
<p>
Next: <a href="#Multiple-sub_002darchitectures" accesskey="n" rel="next">Multiple sub-architectures</a>, Previous: <a href="#macOS-packages" accesskey="p" rel="prev">macOS</a>, Up: <a href="#Installing-packages" accesskey="u" rel="up">Installing packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Customizing-package-compilation-1"></span><h4 class="subsection">6.3.3 Customizing package compilation</h4>

<p>The R system and package-specific compilation flags can be overridden
or added to by setting the appropriate Make variables in the personal
file <samp><var>HOME</var>/.R/Makevars-<var>R_PLATFORM</var></samp> (but
<samp><var>HOME</var>/.R/Makevars.win</samp> or <samp><var>HOME</var>/.R/Makevars.win64</samp>
on Windows), or if that does not exist, <samp><var>HOME</var>/.R/Makevars</samp>,
where &lsquo;<samp>R_PLATFORM</samp>&rsquo; is the platform for which R was built, as
available in the <code>platform</code> component of the R variable
<code>R.version</code>.  The full path to an alternative personal
file<a id="DOCF36" href="#FOOT36"><sup>36</sup></a> can be specified <em>via</em> the environment variable
<code>R_MAKEVARS_USER</code>.
</p>
<p>Package developers are encouraged to use this mechanism to enable a
reasonable amount of diagnostic messaging (&ldquo;warnings&rdquo;) when compiling,
such as e.g. <samp>-Wall -pedantic</samp> for tools from GCC, the GNU
Compiler Collection, or for <code>clang</code>.
</p>
<p>Note that this mechanism can also be used when it necessary to change
the optimization level whilst installing a particular package.  For
example
</p>
<div class="example">
<pre class="example">## <span class="roman">for C code</span>
CFLAGS = -g -O -mtune=native
## <span class="roman">for C++ code</span>
CXXFLAGS = -g -O -mtune=native
## <span class="roman">for fixed-form Fortran code</span>
FFLAGS = -g -O -mtune=native
</pre></div>

<p>Another use is to override the settings in a binary installation of R.
For example, to use a different Fortran compiler on macOS
</p>
<div class="example">
<pre class="example">FC = /usr/local/gfortran/bin/gfortran
FLIBS = -L/usr/local/gfortran/lib/gcc/x86_64-apple-darwin16/6.3.0 
  -L/usr/local/gfortran/lib -lgfortran -lquadmath -lm
</pre></div>

<p>(line split for legibility here).
</p>
<p>There is also provision for a site-wide <samp>Makevars.site</samp> file under
<samp><var>R_HOME</var>/etc</samp> (in a sub-architecture-specific directory if
appropriate).  This is read immediately after <samp>Makeconf</samp>, and the
path to an alternative file can be specified by environment variable
<code>R_MAKEVARS_SITE</code>.
</p>
<p>Note that these mechanisms do not work with packages which fail to pass
settings down to sub-makes, perhaps reading <samp>etc/Makeconf</samp> in
makefiles in subdirectories.  Fortunately such packages are unusual.
</p>
<hr>
</div>
<div class="subsection" id="Multiple-sub_002darchitectures">
<div class="header">
<p>
Next: <a href="#Byte_002dcompilation" accesskey="n" rel="next">Byte-compilation</a>, Previous: <a href="#Customizing-package-compilation" accesskey="p" rel="prev">Customizing package compilation</a>, Up: <a href="#Installing-packages" accesskey="u" rel="up">Installing packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Multiple-sub_002darchitectures-1"></span><h4 class="subsection">6.3.4 Multiple sub-architectures</h4>

<p>When installing packages from their sources, there are some extra
considerations on installations which use sub-architectures.  These are
commonly used on Windows but can in principle be used on other
platforms.
</p>
<p>When a source package is installed by a build of R which supports
multiple sub-architectures, the normal installation process installs the
packages for all sub-architectures.  The exceptions are
</p>
<dl compact="compact">
<dt><span><em>Unix-alikes</em></span></dt>
<dd>
<p>where there is an <samp>configure</samp> script, or a file <samp>src/Makefile</samp>.
</p>
</dd>
<dt><span><em>Windows</em></span></dt>
<dd>
<p>where there is a non-empty <samp>configure.win</samp> script, or a file
<samp>src/Makefile.win</samp> (with some exceptions where the package is known
to have an architecture-independent <samp>configure.win</samp>, or if
<samp>--force-biarch</samp> or field &lsquo;<samp>Biarch</samp>&rsquo; in the <samp>DESCRIPTION</samp>
file is used to assert so).
</p>
</dd>
</dl>

<p>In those cases only the current architecture is installed.  Further
sub-architectures can be installed by
</p>
<div class="example">
<pre class="example">R CMD INSTALL --libs-only <var>pkg</var>
</pre></div>

<p>using the path to <code>R</code> or <code>R --arch</code> to select the
additional sub-architecture.  There is also <code>R CMD INSTALL
--merge-multiarch</code> to build and merge the two architectures, starting
with a source tarball.
</p>
<hr>
</div>
<div class="subsection" id="Byte_002dcompilation">
<div class="header">
<p>
Next: <a href="#External-software" accesskey="n" rel="next">External software</a>, Previous: <a href="#Multiple-sub_002darchitectures" accesskey="p" rel="prev">Multiple sub-architectures</a>, Up: <a href="#Installing-packages" accesskey="u" rel="up">Installing packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Byte_002dcompilation-1"></span><h4 class="subsection">6.3.5 Byte-compilation</h4>

<p>As from R 3.6.0, all packages are by default byte-compiled.
</p>
<p>Byte-compilation can be controlled on a per-package basis by the
&lsquo;<samp>ByteCompile</samp>&rsquo; field in the <samp>DESCRIPTION</samp> file.
</p>
<hr>
</div>
<div class="subsection" id="External-software">
<div class="header">
<p>
Previous: <a href="#Byte_002dcompilation" accesskey="p" rel="prev">Byte-compilation</a>, Up: <a href="#Installing-packages" accesskey="u" rel="up">Installing packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="External-software-1"></span><h4 class="subsection">6.3.6 External software</h4>

<p>Some R packages contain compiled code which links to external
software libraries.  Unless the external library is statically linked
(which is done as much as possible for binary packages on Windows and
macOS), the libraries have to be found when the package is loaded and
not just when it is installed.  How this should be done depends on the
OS (and in some cases the version).
</p>
<p>For Unix-alikes except macOS the primary mechanism is the <code>ld.so</code>
cache controlled by <code>ldconfig</code>: external dynamic libraries
recorded in that cache will be found.  Standard library locations will
be covered by the cache, and well-designed software will add its
locations (as for example <strong>openmpi</strong> does on Fedora).  The secondary
mechanism is to consult the environment variable <code>LD_LIBRARY_PATH</code>.
The R script controls that variable, and sets it to the concatenation
of <code>R_LD_LIBRARY_PATH</code>, <code>R_JAVA_LD_LIBRARY_PATH</code> and the
environment value of <code>LD_LIBRARY_PATH</code>.  The first two have defaults
which are normally set when R is installed (but can be overridden in
the environment) so <code>LD_LIBRARY_PATH</code> is the best choice for a user
to set.
</p>
<p>On macOS the primary mechanism is to embed the absolute path to
dependent dynamic libraries into an object when it is compiled.  Few
R packages arrange to do so, but it can be edited<a id="DOCF37" href="#FOOT37"><sup>37</sup></a> <em>via</em>
<code>install_name_tool</code> &mdash; that only deals with direct dependencies
and those would also need to be compiled to include the absolute paths
of their dependencies.  If the choice of absolute path is to be deferred
to load time, how they are resolved is described in <code>man dyld</code>:
the role of <code>LD_LIBRARY_PATH</code> is replaced on macOS by
<code>DYLD_LIBRARY_PATH</code> and <code>DYLD_FALLBACK_LIBRARY_PATH</code>.  Running
<code>R CMD otool -L</code> on the package shared object will show where
(if anywhere) its dependencies are
resolved.  <code>DYLD_FALLBACK_LIBRARY_PATH</code> is preferred (and it is that
which is manipulated by the R script), but as from 10.11 (&lsquo;El
Capitan&rsquo;) the default behaviour had been changed for security reasons to
discard these environment variables when invoking a shell script (and
<samp>R</samp> is a shell script).  That makes the only portable option to set
<code>R_LD_LIBRARY_PATH</code> in the environment, something like
</p>
<div class="example">
<pre class="example">export R_LD_LIBRARY_PATH=&quot;`R RHOME`/lib:/opt/local/lib&quot;
</pre></div>

<p>The precise rules for where Windows looks for DLLs are complex and
depend on the version of Windows.  But for present purposes the main
solution is to put the directories containing the DLLs the package
links to (and any those DLLs link to) on the <code>PATH</code>.  64-bit
versions of Windows will ignore 32-bit DLLs from 64-bit R and
<em>vice versa</em>.
</p>
<p>The danger with any of the methods which involve setting environment
variables is of inadvertently masking a system library.  This is less
for <code>DYLD_FALLBACK_LIBRARY_PATH</code> and for <em>appending</em> to
<code>PATH</code> on Windows (as it should already contain the system library
paths).
</p>
<hr>
</div>
</div>
<div class="section" id="Updating-packages">
<div class="header">
<p>
Next: <a href="#Removing-packages" accesskey="n" rel="next">Removing packages</a>, Previous: <a href="#Installing-packages" accesskey="p" rel="prev">Installing packages</a>, Up: <a href="#Add_002don-packages" accesskey="u" rel="up">Add-on packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Updating-packages-1"></span><h3 class="section">6.4 Updating packages</h3>
<span id="index-update_002epackages"></span>
<span id="index-Packages_002c-updating"></span>

<p>The command <code>update.packages()</code> is the simplest way to ensure that
all the packages on your system are up to date.  It downloads the list
of available packages and their current versions, compares it with those
installed and offers to fetch and install any that have later versions
on the repositories.
</p>
<p>An alternative interface to keeping packages up-to-date is provided by
the command <code>packageStatus()</code>, which returns an object with
information on all installed packages and packages available at multiple
repositories.  The <code>print</code> and <code>summary</code> methods give an
overview of installed and available packages, the <code>upgrade</code> method
offers to fetch and install the latest versions of outdated packages.
</p>
<p>One sometimes-useful additional piece of information that
<code>packageStatus()</code> returns is the status of a package, as
<code>&quot;ok&quot;</code>, <code>&quot;upgrade&quot;</code> or <code>&quot;unavailable&quot;</code> (in the currently
selected repositories).  For example
</p>
<div class="example">
<pre class="example">&gt; inst &lt;- packageStatus()$inst
&gt; inst[inst$Status != &quot;ok&quot;, c(&quot;Package&quot;, &quot;Version&quot;, &quot;Status&quot;)]
                  Package Version      Status
Biobase           Biobase   2.8.0 unavailable
RCurl               RCurl   1.4-2     upgrade
Rgraphviz       Rgraphviz  1.26.0 unavailable
rgdal               rgdal  0.6-27     upgrade
</pre></div>


<hr>
</div>
<div class="section" id="Removing-packages">
<div class="header">
<p>
Next: <a href="#Setting-up-a-package-repository" accesskey="n" rel="next">Setting up a package repository</a>, Previous: <a href="#Updating-packages" accesskey="p" rel="prev">Updating packages</a>, Up: <a href="#Add_002don-packages" accesskey="u" rel="up">Add-on packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Removing-packages-1"></span><h3 class="section">6.5 Removing packages</h3>
<span id="index-remove_002epackages"></span>
<span id="index-Packages_002c-removing"></span>

<p>Packages can be removed in a number of ways.  From a command prompt they
can be removed by
</p>
<div class="example">
<pre class="example">R CMD REMOVE -l /path/to/library <var>pkg1</var> <var>pkg2</var> &hellip;
</pre></div>

<p>From a running R process they can be removed by
</p>
<div class="example">
<pre class="example">&gt; remove.packages(c(&quot;pkg1&quot;, &quot;pkg2&quot;),
                  lib = file.path(&quot;path&quot;, &quot;to&quot;, &quot;library&quot;))
</pre></div>

<p>Finally, one can just remove the package directory from the library.
</p>

<hr>
</div>
<div class="section" id="Setting-up-a-package-repository">
<div class="header">
<p>
Next: <a href="#Checking-installed-source-packages" accesskey="n" rel="next">Checking installed source packages</a>, Previous: <a href="#Removing-packages" accesskey="p" rel="prev">Removing packages</a>, Up: <a href="#Add_002don-packages" accesskey="u" rel="up">Add-on packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Setting-up-a-package-repository-1"></span><h3 class="section">6.6 Setting up a package repository</h3>
<span id="index-Repositories"></span>

<p>Utilities such as <code>install.packages</code> can be pointed at any
<acronym>CRAN</acronym>-style repository, and R users may want to set up their
own.  The &lsquo;base&rsquo; of a repository is a URL such as
<a href="https://www.stats.ox.ac.uk/pub/RWin/">https://www.stats.ox.ac.uk/pub/RWin/</a>: this must be an URL scheme
that <code>download.packages</code> supports (which also includes
&lsquo;<samp>https://</samp>&rsquo;, &lsquo;<samp>ftp://</samp>&rsquo; and &lsquo;<samp>file://</samp>&rsquo;).  Under that base URL
there should be directory trees for one or more of the following types
of package distributions:
</p>
<ul>
<li> <code>&quot;source&quot;</code>: located at <samp>src/contrib</samp> and containing
<samp>.tar.gz</samp> files.  Other forms of compression can be used, e.g.
<samp>.tar.bz2</samp> or <samp>.tar.xz</samp> files.  Complete repositories contain
the sources corresponding to any binary packages, and in any case it is
wise to have a <samp>src/contrib</samp> area with a possibly empty
<samp>PACKAGES</samp> file.

</li><li> <code>&quot;win.binary&quot;</code>: located at <samp>bin/windows/contrib/<var>x.y</var></samp> for
R versions <var>x.y.z</var> and containing <samp>.zip</samp> files for Windows.

</li><li> <code>&quot;mac.binary&quot;</code>: located at
<samp>bin/macosx/contrib/<var>4.y</var></samp> for the <acronym>CRAN</acronym> builds for
macOS for R versions <var>4.y.z</var>, containing
<samp>.tgz</samp> files.

</li><li> <code>&quot;mac.binary.el-capitan&quot;</code>: located at
<samp>bin/macosx/el-capitan/contrib/<var>3.y</var></samp> for the <acronym>CRAN</acronym>
builds for R versions <var>3.y.z</var>, containing <samp>.tgz</samp> files.
</li></ul>

<p>Each terminal directory must also contain a <samp>PACKAGES</samp> file.  This
can be a concatenation of the <samp>DESCRIPTION</samp> files of the packages
separated by blank lines, but only a few of the fields are needed.  The
simplest way to set up such a file is to use function
<code>write_PACKAGES</code> in the <strong>tools</strong> package, and its help explains
which fields are needed.  Optionally there can also be
<samp>PACKAGES.rds</samp> and <samp>PACKAGES.gz</samp> files, downloaded in
preference to <samp>PACKAGES</samp>.  (If you have a mis-configured server
that does not report correctly non-existent files you may need these
files.)
</p>
<p>To add your repository to the list offered by <code>setRepositories()</code>,
see the help file for that function.
</p>
<p>Incomplete repositories are better specified <em>via</em> a
<code>contriburl</code> argument than <em>via</em> being set as a repository.
</p>
<p>A repository can contain subdirectories, when the descriptions in the
<samp>PACKAGES</samp> file of packages in subdirectories must include a line
of the form
</p>
<div class="example">
<pre class="example">Path: <var>path/to/subdirectory</var>
</pre></div>

<p>&mdash;once again <code>write_PACKAGES</code> is the simplest way to set this up.
</p>
<hr>
</div>
<div class="section" id="Checking-installed-source-packages">
<div class="header">
<p>
Previous: <a href="#Setting-up-a-package-repository" accesskey="p" rel="prev">Setting up a package repository</a>, Up: <a href="#Add_002don-packages" accesskey="u" rel="up">Add-on packages</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Checking-installed-source-packages-1"></span><h3 class="section">6.7 Checking installed source packages</h3>

<p>It can be convenient to run <code>R CMD check</code> on an installed
package, particularly on a platform which uses sub-architectures.  The
outline of how to do this is, with the source package in directory
<samp><var>pkg</var></samp> (or a tarball filename):
</p>
<div class="example">
<pre class="example">R CMD INSTALL -l <var>libdir</var> <var>pkg</var> &gt; <var>pkg</var>.log 2&gt;&amp;1
R CMD check -l <var>libdir</var> --install=check:<var>pkg</var>.log <var>pkg</var>
</pre></div>

<p>Where sub-architectures are in use the <code>R CMD check</code> line can be
repeated with additional architectures by
</p>
<div class="example">
<pre class="example">R --arch <var>arch</var> CMD check -l <var>libdir</var> --extra-arch --install=check:<var>pkg</var>.log <var>pkg</var>
</pre></div>

<p>where <samp>--extra-arch</samp> selects only those checks which depend on
the installed code and not those which analyse the sources.  (If
multiple sub-architectures fail only because they need different
settings, e.g. environment variables, <samp>--no-multiarch</samp> may need
to be added to the <code>INSTALL</code> lines.)  On Unix-alikes the
architecture to run is selected by <samp>--arch</samp>: this can also be
used on Windows with <samp><var>R_HOME</var>/bin/R.exe</samp>, but it is more usual
to select the path to the <code>Rcmd.exe</code> of the desired
architecture.
</p>
<p>So on Windows to install, check and package for distribution a source
package from a tarball which has been tested on another platform one
might use
</p>
<div class="example">
<pre class="example">.../bin/x64/Rcmd INSTALL -l <var>libdir</var> <var>tarball</var> --build &gt; <var>pkg</var>.log 2&gt;&amp;1
</pre></div>

<hr>
</div>
</div>
<div class="chapter" id="Internationalization">
<div class="header">
<p>
Next: <a href="#Choosing-between-32_002d-and-64_002dbit-builds" accesskey="n" rel="next">Choosing between 32- and 64-bit builds</a>, Previous: <a href="#Add_002don-packages" accesskey="p" rel="prev">Add-on packages</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Internationalization-and-Localization"></span><h2 class="chapter">7 Internationalization and Localization</h2>
<span id="index-Internationalization"></span>
<span id="index-Localization"></span>

<p><em>Internationalization</em> refers to the process of enabling support
for many human languages, and <em>localization</em> to adapting to a
specific country and language.
</p>
<p>Current builds of R support all the character sets that the
underlying OS can handle.  These are interpreted according to the
<span id="index-Locale"></span>
current <code>locale</code>, a sufficiently complicated topic to merit a
separate section.  Note though that R has no built-in support for
right-to-left languages and bidirectional output, relying on the OS
services.  For example, how character vectors in UTF-8 containing both
English digits and Hebrew characters are printed is OS-dependent (and
perhaps locale-dependent).
</p>
<p>The other aspect of the internationalization is support for the
translation of messages.  This is enabled in almost all builds of R.
</p>

<ul class="section-toc">
<li><a href="#Locales" accesskey="1">Locales</a></li>
<li><a href="#Localization-of-messages" accesskey="2">Localization of messages</a></li>
</ul>
<hr>
<div class="section" id="Locales">
<div class="header">
<p>
Next: <a href="#Localization-of-messages" accesskey="n" rel="next">Localization of messages</a>, Previous: <a href="#Internationalization" accesskey="p" rel="prev">Internationalization and Localization</a>, Up: <a href="#Internationalization" accesskey="u" rel="up">Internationalization and Localization</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Locales-1"></span><h3 class="section">7.1 Locales</h3>
<span id="index-Locale-1"></span>

<p>A <em>locale</em> is a description of the local environment of the user,
including the preferred language, the encoding of characters, the
currency used and its conventions, and so on.  Aspects of the locale are
accessed by the R functions <code>Sys.getlocale</code> and
<code>Sys.localeconv</code>.
</p>
<p>The system of naming locales is OS-specific.  There is quite wide
agreement on schemes, but not on the details of their implementation.  A
locale needs to specify
</p><ul>
<li> A human language.  These are generally specified by a lower-case
two-character abbreviation following ISO 639 (see e.g.
<a href="https://en.wikipedia.org/wiki/ISO_639-1">https://en.wikipedia.org/wiki/ISO_639-1</a>).

</li><li> A &lsquo;territory&rsquo;, used mainly to specify the currency. These are generally
specified by an upper-case two-character abbreviation following ISO 3166
(see e.g. <a href="https://en.wikipedia.org/wiki/ISO_3166">https://en.wikipedia.org/wiki/ISO_3166</a>).

</li><li> A charset encoding, which determines both how a byte stream should be
divided into characters, and which characters the subsequences of bytes
represent.  Sometimes the combination of language and territory is used
to specify the encoding, for example to distinguish between traditional
and simplified Chinese.

</li><li> Optionally, a modifier, for example to indicate that Austria is to be
considered pre- or post-Euro.  The modifier is also used to indicate the
script (<code>@latin</code>, <code>@cyrillic</code> for Serbian, <code>@iqtelif</code>)
or language dialect (e.g. <code>@saaho</code>, a dialect of Afar, and
<code>@bokmal</code> and <code>@nynorsk</code>, dialects of Norwegian regarded by
some OSes as separate languages, <code>no</code> and <code>nn</code>).
</li></ul>

<p>R is principally concerned with the first (for translations) and
third.  Note that the charset may be deducible from the language, as
some OSes offer only one charset per language.
</p>

<ul class="section-toc">
<li><a href="#Locales-under-Unix_002dalikes" accesskey="1">Locales under Unix-alikes</a></li>
<li><a href="#Locales-under-Windows" accesskey="2">Locales under Windows</a></li>
<li><a href="#Locales-under-macOS" accesskey="3">Locales under macOS</a></li>
</ul>
<hr>
<div class="subsection" id="Locales-under-Unix_002dalikes">
<div class="header">
<p>
Next: <a href="#Locales-under-Windows" accesskey="n" rel="next">Locales under Windows</a>, Previous: <a href="#Locales" accesskey="p" rel="prev">Locales</a>, Up: <a href="#Locales" accesskey="u" rel="up">Locales</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Locales-under-Unix_002dalikes-1"></span><h4 class="subsection">7.1.1 Locales under Unix-alikes</h4>

<p>Modern Linux uses the XPG<a id="DOCF38" href="#FOOT38"><sup>38</sup></a> locale specifications which have the form
&lsquo;<samp>en_GB</samp>&rsquo;, &lsquo;<samp>en_GB.UTF-8</samp>&rsquo;, &lsquo;<samp>aa_ER.UTF-8@saaho</samp>&rsquo;,
&lsquo;<samp>de_AT.iso885915@euro</samp>&rsquo;, the components being in the order listed
above.  (See <code>man locale</code> and <code>locale -a</code> for more
details.)  Similar schemes are used by most Unix-alikes: some (including
some distributions of Linux) use &lsquo;<samp>.utf8</samp>&rsquo; rather than &lsquo;<samp>.UTF-8</samp>&rsquo;.
</p>
<p>Note that whereas UTF-8 locales are nowadays almost universally used,
locales such as &lsquo;<samp>en_GB</samp>&rsquo; use 8-bit encodings for backwards
compatibility.
</p>
<hr>
</div>
<div class="subsection" id="Locales-under-Windows">
<div class="header">
<p>
Next: <a href="#Locales-under-macOS" accesskey="n" rel="next">Locales under macOS</a>, Previous: <a href="#Locales-under-Unix_002dalikes" accesskey="p" rel="prev">Locales under Unix-alikes</a>, Up: <a href="#Locales" accesskey="u" rel="up">Locales</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Locales-under-Windows-1"></span><h4 class="subsection">7.1.2 Locales under Windows</h4>

<p>Windows also uses locales, but specified in a rather less concise way.
Most users will encounter locales only via drop-down menus, but more
information and lists can be found by searching for &lsquo;<samp>Windows
language country strings</samp>&rsquo;).
</p>
<p>It offers only one encoding per language.
</p>
<p>Some care is needed with Windows&rsquo; locale names.  For example,
<code>chinese</code> is Traditional Chinese and not Simplified Chinese as used
in most of the Chinese-speaking world.
</p>
<hr>
</div>
<div class="subsection" id="Locales-under-macOS">
<div class="header">
<p>
Previous: <a href="#Locales-under-Windows" accesskey="p" rel="prev">Locales under Windows</a>, Up: <a href="#Locales" accesskey="u" rel="up">Locales</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Locales-under-macOS-1"></span><h4 class="subsection">7.1.3 Locales under macOS</h4>

<p>macOS supports locales in its own particular way, but the R GUI tries to
make this easier for users. See
<a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPInternational/">https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPInternational/</a>
for how users can set their locales.  As with Windows, end users will
generally only see lists of languages/territories.  Users of R in a
terminal may need to set the locale to something like &lsquo;<samp>en_GB.UTF-8</samp>&rsquo;
if it defaults to &lsquo;<samp>C</samp>&rsquo; (as it sometimes does when logging in
remotely and for batch jobs: note whether <code>Terminal</code> sets the
<code>LANG</code> environment variable is an (advanced) preference, but does so
by default).
</p>
<p>Internally macOS uses a form similar to Linux: the main difference from
other Unix-alikes is that where a character set is not specified it is
assumed to be <code>UTF-8</code>.
</p>

<hr>
</div>
</div>
<div class="section" id="Localization-of-messages">
<div class="header">
<p>
Previous: <a href="#Locales" accesskey="p" rel="prev">Locales</a>, Up: <a href="#Internationalization" accesskey="u" rel="up">Internationalization and Localization</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Localization-of-messages-1"></span><h3 class="section">7.2 Localization of messages</h3>

<p>The preferred language for messages is by default taken from the locale.
This can be overridden first by the setting of the environment variable
<span id="index-LANGUAGE"></span>
<span id="index-LC_005fALL"></span>
<span id="index-LC_005fMESSAGES"></span>
<span id="index-LANG"></span>
<code>LANGUAGE</code> and then<a id="DOCF39" href="#FOOT39"><sup>39</sup></a>
by the environment variables <code>LC_ALL</code>, <code>LC_MESSAGES</code> and
<code>LANG</code>. (The last three are normally used to set the locale and so
should not be needed, but the first is only used to select the language
for messages.)  The code tries hard to map locales to languages, but on
some systems (notably Windows) the locale names needed for the
environment variable <code>LC_ALL</code> do not all correspond to XPG language
names and so <code>LANGUAGE</code> may need to be set.  (One example is
&lsquo;<samp>LC_ALL=es</samp>&rsquo; on Windows which sets the locale to Estonian and the
language to Spanish.)
</p>
<p>It is usually possible to change the language once R is running
<em>via</em> (not Windows) <code>Sys.setlocale(&quot;LC_MESSAGES&quot;,
&quot;new_locale&quot;)</code>, or by setting an environment variable such as
<code>LANGUAGE</code>, <em>provided</em><a id="DOCF40" href="#FOOT40"><sup>40</sup></a> the language you are changing to can be output in the current
character set.  But this is OS-specific, and has been known to stop
working on an OS upgrade.  Note that translated messages may be cached,
so attempting to change the language of an error that has already been
output in another language may not work.
</p>
<p>Messages are divided into <em>domains</em>, and translations may be
available for some or all messages in a domain.  R makes use of the
following domains.
</p>
<ul>
<li> Domain <code>R</code> for the C-level error and warning messages from the R
interpreter.

</li><li> Domain <code>R-<var>pkg</var></code> for the R <code>stop</code>, <code>warning</code> and
<code>message</code> messages in each package, including <code>R-base</code> for the
<strong>base</strong> package.

</li><li> Domain <code><var>pkg</var></code> for the C-level messages in each package.

</li><li> Domain <code>RGui</code> for the menus etc of the R for Windows GUI front-end.

</li></ul>

<p>Dividing up the messages in this way allows R to be extensible: as
packages are loaded, their message translation catalogues can be loaded
too.
</p>
<p>R can be built without support for translations, but it is enabled by
default.
</p>
<p>R-level and C-level domains are subtly different, for example in the way
strings are canonicalized before being passed for translation. 
</p>
<p>Translations are looked for by domain according to the currently
specified language, as specifically as possible, so for example an
Austrian (&lsquo;<samp>de_AT</samp>&rsquo;) translation catalogue will be used in preference
to a generic German one (&lsquo;<samp>de</samp>&rsquo;) for an Austrian user.  However, if a
specific translation catalogue exists but does not contain a
translation, the less specific catalogues are consulted.  For example,
R has catalogues for &lsquo;<samp>en_GB</samp>&rsquo; that translate the Americanisms
(e.g., &lsquo;<samp>gray</samp>&rsquo;) in the standard messages into English.<a id="DOCF41" href="#FOOT41"><sup>41</sup></a>  Two other examples: there are catalogues
for &lsquo;<samp>es</samp>&rsquo;, which is Spanish as written in Spain and these will by
default also be used in Spanish-speaking Latin American countries, and
also for &lsquo;<samp>pt_BR</samp>&rsquo;, which are used for Brazilian locales but not for
locales specifying Portugal.
</p>
<p>Translations in the right language but the wrong charset are made use of
<span id="index-LANGUAGE-1"></span>
by on-the-fly re-encoding.  The <code>LANGUAGE</code> variable (only) can be a
colon-separated list, for example &lsquo;<samp>se:de</samp>&rsquo;, giving a set of
languages in decreasing order of preference.  One special value is
&lsquo;<samp>en@quot</samp>&rsquo;, which can be used in a UTF-8 locale to have American
error messages with pairs of single quotes translated to Unicode directional
quotes.
</p>
<p>If no suitable translation catalogue is found or a particular message is
not translated in any suitable catalogue, &lsquo;English&rsquo;<a id="DOCF42" href="#FOOT42"><sup>42</sup></a> is used.
</p>
<p>See <a href="https://developer.r-project.org/Translations30.html">https://developer.r-project.org/Translations30.html</a> for how to
prepare and install translation catalogues.
</p>
<hr>
</div>
</div>
<div class="chapter" id="Choosing-between-32_002d-and-64_002dbit-builds">
<div class="header">
<p>
Next: <a href="#The-standalone-Rmath-library" accesskey="n" rel="next">The standalone Rmath library</a>, Previous: <a href="#Internationalization" accesskey="p" rel="prev">Internationalization and Localization</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Choosing-between-32_002d-and-64_002dbit-builds-1"></span><h2 class="chapter">8 Choosing between 32- and 64-bit builds</h2>

<p>Almost all current <acronym>CPU</acronym>s have both 32- and 64-bit sets of
instructions.  Most OSes running on such <acronym>CPU</acronym>s offer the choice
of building a 32-bit or a 64-bit version of R (and details are given
below under specific OSes).  For most a 32-bit version is the default,
but for some (e.g., &lsquo;<samp>x86_64</samp>&rsquo; Linux and macOS &ge; 10.6)
64-bit is.
</p>
<p>All current versions of R use 32-bit integers (this is enforced in
the build) and <acronym>ISO</acronym>/<acronym>IEC</acronym>&nbsp;60559<a id="DOCF43" href="#FOOT43"><sup>43</sup></a> double-precision reals, and so compute
to the same precision<a id="DOCF44" href="#FOOT44"><sup>44</sup></a> and with the same limits on the
sizes of numerical quantities.  The principal difference is in the size
of the pointers.
</p>
<p>64-bit builds have both advantages and disadvantages:
</p><ul>
<li> The total virtual memory space made available to a 32-bit process is
limited by the pointer size to 4GB, and on most OSes to 3GB (or even
2GB).  The limits for 64-bit processes are much larger (e.g.
8&ndash;128TB).

<p>R allocates memory for large objects as needed, and removes any
unused ones at garbage collection.  When the sizes of objects become an
appreciable fraction of the address limit, fragmentation of the address
space becomes an issue and there may be no hole available that is the
size requested.  This can cause more frequent garbage collection or the
inability to allocate large objects.  As a guide, this will become an
issue for 32-bit builds with objects more than 10% of the size of the
address space (around 300Mb) or when the total size of objects in use is
around one third (around 1Gb).
</p>
</li><li> Only 64-bit builds support &lsquo;long vectors&rsquo;, those with <em class='math'>2^{31}</em> or
more elements (which needs at least 16GB of storage for each numeric
vector).

</li><li> Most 32-bit OSes by default limit file sizes to 2GB (and this may also
apply to 32-bit builds on 64-bit OSes).  This can often be worked
around: <code>configure</code> selects suitable defines if this is
possible.  (We have also largely worked around that limit on 32-bit
Windows.)  64-bit builds have much larger limits.

</li><li> Because the pointers are larger, R&rsquo;s basic structures are larger.
This means that R objects take more space and (usually) more time to
manipulate.  So 64-bit builds of R will, all other things being
equal, run slower than 32-bit builds.

</li><li> However, &lsquo;other things&rsquo; may not be equal.  In the specific case of
&lsquo;<samp>x86_64</samp>&rsquo; <em>vs</em> &lsquo;<samp>ix86</samp>&rsquo;, the 64-bit CPU has features
(such as SSE2 instructions) which are guaranteed to be present but are
optional on the 32-bit CPU, and also has more general-purpose registers.
This means that on chips like a desktop Intel i7 the vanilla 64-bit
version of R has been around 10% faster on both Linux and macOS.
(Laptop CPUs are usually relatively slower in 64-bit mode.)
</li></ul>

<p>So, for speed you may want to use a 32-bit build (especially on a
laptop), but to handle large datasets (and perhaps large files) a 64-bit
build.  You can often build both and install them in the same place:
See <a href="#Sub_002darchitectures">Sub-architectures</a>.  (This is done for the Windows binary
distributions.)
</p>
<p>Even on 64-bit builds of R there are limits on the size of R
objects (see <code>help(&quot;Memory-limits&quot;)</code>), some of which stem from the
use of 32-bit integers (especially in Fortran code).  For example, each
dimension of an array is limited to <em class='math'>2^{31} - 1</em>.
</p>
<hr>
</div>
<div class="chapter" id="The-standalone-Rmath-library">
<div class="header">
<p>
Next: <a href="#Essential-and-useful-other-programs-under-a-Unix_002dalike" accesskey="n" rel="next">Essential and useful other programs under a Unix-alike</a>, Previous: <a href="#Choosing-between-32_002d-and-64_002dbit-builds" accesskey="p" rel="prev">Choosing between 32- and 64-bit builds</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="The-standalone-Rmath-library-1"></span><h2 class="chapter">9 The standalone Rmath library</h2>

<p>The routines supporting the distribution and
special<a id="DOCF45" href="#FOOT45"><sup>45</sup></a> functions in R
and a few others are declared in C header file <samp>Rmath.h</samp>.  These
can be compiled into a standalone library for linking to other
applications.  (Note that they are not a separate library when R is
built, and the standalone version differs in several ways.)
</p>
<p>The makefiles and other sources needed are in directory
<samp>src/nmath/standalone</samp>, so the following instructions assume that
is the current working directory (in the build directory tree on a
Unix-alike if that is separate from the sources).
</p>
<p><samp>Rmath.h</samp> contains &lsquo;<samp>R_VERSION_STRING</samp>&rsquo;, which is a character
string containing the current R version, for example <code>&quot;4.0.0&quot;</code>.
</p>
<p>There is full access to R&rsquo;s handling of <code>NaN</code>, <code>Inf</code> and
<code>-Inf</code> via special versions of the macros and functions
</p>
<div class="example">
<pre class="example">    ISNAN, R_FINITE, R_log, R_pow and R_pow_di
</pre></div>

<p>and (extern) constants <code>R_PosInf</code>, <code>R_NegInf</code> and <code>NA_REAL</code>.
</p>
<p>There is no support for R&rsquo;s notion of missing values, in particular
not for <code>NA_INTEGER</code> nor the distinction between <code>NA</code> and
<code>NaN</code> for doubles.
</p>
<p>A little care is needed to use the random-number routines. You will
need to supply the uniform random number generator 
</p>
<div class="example">
<pre class="example">    double unif_rand(void)
</pre></div>

<p>or use the one supplied (and with a shared library or DLL you may
have to use the one supplied, which is the Marsaglia-multicarry with
an entry point
</p>
<div class="example">
<pre class="example">    set_seed(unsigned int, unsigned int)
</pre></div>

<p>to set its seeds).
</p>
<p>The facilities to change the normal random number generator are
available through the constant <code>N01_kind</code>. This takes values
from the enumeration type
</p>
<div class="example">
<pre class="example">typedef enum {
    BUGGY_KINDERMAN_RAMAGE,
    AHRENS_DIETER,
    BOX_MULLER,
    USER_NORM,
    INVERSION,
    KINDERMAN_RAMAGE
} N01type;
</pre></div>

<p>(and &lsquo;<samp>USER_NORM</samp>&rsquo; is not available).
</p>


<ul class="section-toc">
<li><a href="#Unix_002dalike-standalone" accesskey="1">Unix-alikes</a></li>
<li><a href="#Windows-standalone" accesskey="2">Windows</a></li>
</ul>
<hr>
<div class="section" id="Unix_002dalike-standalone">
<div class="header">
<p>
Next: <a href="#Windows-standalone" accesskey="n" rel="next">Windows</a>, Previous: <a href="#The-standalone-Rmath-library" accesskey="p" rel="prev">The standalone Rmath library</a>, Up: <a href="#The-standalone-Rmath-library" accesskey="u" rel="up">The standalone Rmath library</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Unix_002dalikes"></span><h3 class="section">9.1 Unix-alikes</h3>

<p>If R has not already been made in the directory tree,
<code>configure</code> must be run as described in the main build
instructions.
</p>
<p>Then (in <samp>src/nmath/standalone</samp>)
</p>
<div class="example">
<pre class="example">make
</pre></div>

<p>will make standalone libraries <samp>libRmath.a</samp> and <samp>libRmath.so</samp>
(<samp>libRmath.dylib</samp> on macOS): &lsquo;<samp>make static</samp>&rsquo; and &lsquo;<samp>make
shared</samp>&rsquo; will create just one of them.
</p>
<p>To use the routines in your own C or C++ programs, include
</p>
<div class="example">
<pre class="example">#define MATHLIB_STANDALONE
#include &lt;Rmath.h&gt;
</pre></div>

<p>and link against &lsquo;<samp>-lRmath</samp>&rsquo; (and &lsquo;<samp>-lm</samp>&rsquo; if needed on your OS).
The example file <samp>test.c</samp> does nothing useful, but is provided to
test the process (via <code>make test</code>).  Note that you will probably
not be able to run it unless you add the directory containing
<span id="index-LD_005fLIBRARY_005fPATH"></span>
<samp>libRmath.so</samp> to the <code>LD_LIBRARY_PATH</code> environment variable
(<samp>libRmath.dylib</samp>, <code>DYLD_FALLBACK_LIBRARY_PATH</code> on macOS).
</p>
<p>The targets
</p>
<div class="example">
<pre class="example">make install
make uninstall
</pre></div>

<p>will (un)install the header <samp>Rmath.h</samp> and shared and static
<span id="index-DESTDIR-1"></span>
libraries (if built).  Both <code>prefix=</code> and <code>DESTDIR</code> are
supported, together with more precise control as described for the main
build.
</p>
<p>&lsquo;<samp>make install</samp>&rsquo; installs a file for <code>pkg-config</code> to use by
e.g.
</p>
<div class="example">
<pre class="example">$(CC) `pkg-config --cflags libRmath` -c test.c
$(CC) `pkg-config --libs libRmath` test.o -o test
</pre></div>

<p>On some systems &lsquo;<samp>make install-strip</samp>&rsquo; will install a stripped shared
library.
</p>


<hr>
</div>
<div class="section" id="Windows-standalone">
<div class="header">
<p>
Previous: <a href="#Unix_002dalike-standalone" accesskey="p" rel="prev">Unix-alikes</a>, Up: <a href="#The-standalone-Rmath-library" accesskey="u" rel="up">The standalone Rmath library</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Windows-1"></span><h3 class="section">9.2 Windows</h3>

<p>You need to set up<a id="DOCF46" href="#FOOT46"><sup>46</sup></a> almost all the
tools to make R and then run (in a Unix-like shell)
</p>
<div class="example">
<pre class="example">(cd ../../gnuwin32; make MkRules)
(cd ../../include; make -f Makefile.win config.h Rconfig.h Rmath.h)
make -f Makefile.win
</pre></div>

<p>Alternatively, in a <samp>cmd.exe</samp> shell use
</p>
<div class="example">
<pre class="example">cd ../../include
make -f Makefile.win config.h Rconfig.h Rmath.h
cd ../nmath/standalone
make -f Makefile.win
</pre></div>


<p>This creates a static library <samp>libRmath.a</samp> and a DLL
<samp>Rmath.dll</samp>.  If you want an import library <samp>libRmath.dll.a</samp>
(you don&rsquo;t need one), use
</p>
<div class="example">
<pre class="example">make -f Makefile.win shared implib
</pre></div>

<p>To use the routines in your own C or C++ programs using MinGW-w64, include
</p>
<div class="example">
<pre class="example">#define MATHLIB_STANDALONE
#include &lt;Rmath.h&gt;
</pre></div>

<p>and link against &lsquo;<samp>-lRmath</samp>&rsquo;.  This will use the first found of
<samp>libRmath.dll.a</samp>, <samp>libRmath.a</samp> and <samp>Rmath.dll</samp> in that
order, so the result depends on which files are present.  You should be
able to force static or dynamic linking  <em>via</em>
</p>
<div class="example">
<pre class="example">-Wl,-Bstatic -lRmath -Wl,Bdynamic
-Wl,-Bdynamic -lRmath
</pre></div>

<p>or by linking to explicit files (as in the &lsquo;<samp>test</samp>&rsquo; target in
<samp>Makefile.win</samp>: this makes two executables, <samp>test.exe</samp> which
is dynamically linked, and <samp>test-static.exe</samp>, which is statically
linked).
</p>
<p>It is possible to link to <samp>Rmath.dll</samp> using other compilers, either
directly or via an import library: if you make a MinGW-w64 import library as
above, you will create a file <samp>Rmath.def</samp> which can be used
(possibly after editing) to create an import library for other systems
such as Visual C++.
</p>
<p>If you make use of dynamic linking you should use
</p>
<div class="example">
<pre class="example">#define MATHLIB_STANDALONE
#define RMATH_DLL
#include &lt;Rmath.h&gt;
</pre></div>

<p>to ensure that the constants like <code>NA_REAL</code> are linked correctly.
(Auto-import will probably work with MinGW-w64, but it is better to be
sure. This is likely to also work with VC++, Borland and similar
compilers.)
</p>

<hr>
</div>
</div>
<div class="appendix" id="Essential-and-useful-other-programs-under-a-Unix_002dalike">
<div class="header">
<p>
Next: <a href="#Configuration-on-a-Unix_002dalike" accesskey="n" rel="next">Configuration on a Unix-alike</a>, Previous: <a href="#The-standalone-Rmath-library" accesskey="p" rel="prev">The standalone Rmath library</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Essential-and-useful-other-programs-under-a-Unix_002dalike-1"></span><h2 class="appendix">Appendix A Essential and useful other programs under a Unix-alike</h2>

<p>This appendix gives details of programs you will need to build R on
Unix-like platforms, or which will be used by R if found by
<code>configure</code>.
</p>
<p>Remember that some package management systems (such as <acronym>RPM</acronym> and
Debian/Ubuntu&rsquo;s) make a distinction between the user version of a
package and the development version.  The latter usually has the same
name but with the extension &lsquo;<samp>-devel</samp>&rsquo; or &lsquo;<samp>-dev</samp>&rsquo;: you need both
versions installed.
</p>

<ul class="section-toc">
<li><a href="#Essential-programs-and-libraries" accesskey="1">Essential programs and libraries</a></li>
<li><a href="#Useful-libraries-and-programs" accesskey="2">Useful libraries and programs</a></li>
<li><a href="#Linear-algebra" accesskey="3">Linear algebra</a></li>
</ul>
<hr>
<div class="section" id="Essential-programs-and-libraries">
<div class="header">
<p>
Next: <a href="#Useful-libraries-and-programs" accesskey="n" rel="next">Useful libraries and programs</a>, Previous: <a href="#Essential-and-useful-other-programs-under-a-Unix_002dalike" accesskey="p" rel="prev">Essential and useful other programs under a Unix-alike</a>, Up: <a href="#Essential-and-useful-other-programs-under-a-Unix_002dalike" accesskey="u" rel="up">Essential and useful other programs under a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Essential-programs-and-libraries-1"></span><h3 class="section">A.1 Essential programs and libraries</h3>

<p>You need a means of compiling C and Fortran 90 (see <a href="#Using-Fortran">Using Fortran</a>).  Your C compiler should be
<acronym>ISO</acronym>/<acronym>IEC</acronym>&nbsp;60059<a id="DOCF47" href="#FOOT47"><sup>47</sup></a>, POSIX 1003.1 and C99-compliant.<a id="DOCF48" href="#FOOT48"><sup>48</sup></a> R tries to choose suitable
flags<a id="DOCF49" href="#FOOT49"><sup>49</sup></a> for the C compilers it knows about, but you may have to
set <code>CC</code> or <code>CFLAGS</code> suitably.  For versions of <code>gcc</code>
prior to 5.1 with <code>glibc</code>-based Linux this means including
<samp>-std=gnu99</samp><a id="DOCF50" href="#FOOT50"><sup>50</sup></a>.  (Note that options essential to run the compiler
even for linking, such as those to set the architecture, should be
specified as part of <code>CC</code> rather than in <code>CFLAGS</code>.)
</p>
<p>Unless you do not want to view graphs on-screen (or use macOS) you need
&lsquo;<samp>X11</samp>&rsquo; installed, including its headers and client libraries. For
recent Fedora/RedHat distributions it means (at least) RPMs
&lsquo;<samp>libX11</samp>&rsquo;, &lsquo;<samp>libX11-devel</samp>&rsquo;, &lsquo;<samp>libXt</samp>&rsquo; and &lsquo;<samp>libXt-devel</samp>&rsquo;.
On Debian/Ubuntu we recommend the meta-package &lsquo;<samp>xorg-dev</samp>&rsquo;.  If you
really do not want these you will need to explicitly configure R
without X11, using <samp>--with-x=no</samp>.
</p>
<p>The command-line editing (and command completion) depends on the
<acronym>GNU</acronym> <code>readline</code> library (including its headers): version
6.0 or later is needed for all the features to be enabled.  Otherwise
you will need to configure with <samp>--with-readline=no</samp> (or
equivalent).
</p>
<p>A suitably comprehensive <code>iconv</code> function is essential.  The R
usage requires <code>iconv</code> to be able to translate between
<code>&quot;latin1&quot;</code> and <code>&quot;UTF-8&quot;</code>, to recognize <code>&quot;&quot;</code> (as the
current encoding) and <code>&quot;ASCII&quot;</code>, and to translate to and from the
Unicode wide-character formats <code>&quot;UCS-[24][BL]E&quot;</code> &mdash; this is true
by default for <code>glibc</code><a id="DOCF51" href="#FOOT51"><sup>51</sup></a> but not of most commercial Unixes.  However, you
can make use of <acronym>GNU</acronym> <code>libiconv</code> (as used on macOS: see
<a href="https://www.gnu.org/software/libiconv/">https://www.gnu.org/software/libiconv/</a>).
</p>
<p>The OS needs to have enough support<a id="DOCF52" href="#FOOT52"><sup>52</sup></a> for wide-character
types: this is checked at configuration.  Some C99
functions<a id="DOCF53" href="#FOOT53"><sup>53</sup></a> are required and checked for at
configuration.  A small number of POSIX functions<a id="DOCF54" href="#FOOT54"><sup>54</sup></a> are essential, and others<a id="DOCF55" href="#FOOT55"><sup>55</sup></a> will be used if available.
</p>
<p>Installations of <code>zlib</code> (version 1.2.5 or later), <code>libbz2</code>
(version 1.0.6 or later: called <strong>bzip2-libs</strong>/<strong>bzip2-devel</strong> or
<strong>libbz2-1.0</strong>/<strong>libbz2-dev</strong> by some Linux distributions) and
<code>liblzma</code><a id="DOCF56" href="#FOOT56"><sup>56</sup></a> version 5.0.3 or
later are required.
</p>
<p>Either PCRE1 (version 8.32 or later, formerly known as just PCRE) or
PCRE2 is required: PCRE2 is preferred and using PCRE1 requires
<code>configure</code> option <samp>--with-pcre1</samp>.  Only the 8-bit
library and headers are needed if these are packaged separately. JIT
support (optional) is desirable for the best performance.  For PCRE2 &gt;=
10.30 (which is desirable as matching has been re-written not to use
recursion and the Unicode tables were updated to version 10)
</p><div class="example">
<pre class="example">./configure --enable-jit
</pre></div>
<p>suffices.  If building PCRE1 for use with R a suitable
<code>configure</code> command might be
</p><div class="example">
<pre class="example">./configure --enable-utf --enable-unicode-properties --enable-jit --disable-cpp
</pre></div>
<p>The <samp>--enable-jit</samp> flag is supported for most common CPUs but
does not work (well or at all) for &lsquo;<samp>arm64</samp>&rsquo; macOS.
</p>
<p>Some packages require the &lsquo;Unicode properties&rsquo; which are
optional for PCRE1: support for this and JIT can be checked at run-time
by calling <code>pcre_config()</code>.
</p>
<p>Library <code>libcurl</code> (version 7.28.0 or later<a id="DOCF57" href="#FOOT57"><sup>57</sup></a>) is required.  Information on <code>libcurl</code> is
found from the <code>curl-config</code> script: if that is missing or needs
to be overridden<a id="DOCF58" href="#FOOT58"><sup>58</sup></a> there are macros to
do so described in file <samp>config.site</samp>.
</p>
<p>A <code>tar</code> program is needed to unpack the sources and packages
(including the recommended packages).  A version<a id="DOCF59" href="#FOOT59"><sup>59</sup></a> that can
automagically detect compressed archives is preferred for use with
<code>untar()</code>: the configure script looks for <code>gtar</code> and
<code>gnutar</code> before
<span id="index-TAR"></span>
<code>tar</code> &ndash; use environment variable <code>TAR</code> to override this.
(On NetBSD/OpenBSD systems set this to <code>bsdtar</code> if that is
installed.)
</p>
<p>There need to be suitable versions of the tools <code>grep</code> and
<code>sed</code>: the problems are usually with old AT&amp;T and BSD variants.
<code>configure</code> will try to find suitable versions (including
looking in <samp>/usr/xpg4/bin</samp> which is used on some commercial
Unixes).
</p>
<p>You will not be able to build most of the manuals unless you have
<code>texi2any</code> version 5.1 or later installed (which requires
<code>perl</code>), and if not most of the <acronym>HTML</acronym> manuals will be linked
to a version on <acronym>CRAN</acronym>. To make PDF versions of the manuals you
will also need file <samp>texinfo.tex</samp> installed (which is part of the
<acronym>GNU</acronym> <strong>texinfo</strong> distribution but is often made part of the
TeX package in re-distributions) as well as
<code>texi2dvi</code>.<a id="DOCF60" href="#FOOT60"><sup>60</sup></a>
Further, the versions of <code>texi2dvi</code> and <samp>texinfo.tex</samp> need
to be compatible: we have seen problems with older TeX distributions.
</p>
<span id="index-Subversion-1"></span>
<p>If you want to build from the R Subversion repository then
<code>texi2any</code> is highly recommended as it is used to create files
which are in the tarball but not stored in the Subversion repository.
</p>
<span id="index-Vignettes"></span>
<p>The PDF documentation (including <samp>doc/NEWS.pdf</samp>) and building
vignettes needs <code>pdftex</code> and <code>pdflatex</code>.  We require
LaTeX version <code>2005/12/01</code> or later (for UTF-8 support).
Building PDF package manuals (including the R reference manual) and
vignettes is sensitive to the version of the LaTeX package
<strong>hyperref</strong> and we recommend that the TeX distribution used is
kept up-to-date.  A number of standard LaTeX packages are required
(including <strong>url</strong> and some of the font packages such as <strong>times</strong>
and <strong>helvetic</strong> for the manuals, as well as <strong>fancyvrb</strong>,
<strong>natbib</strong> and <strong>parskip</strong> for the base vignettes) and others such
as <strong>hyperref</strong> and <strong>inconsolata</strong> are desirable (and without them
you may need to change R&rsquo;s defaults: see <a href="#Making-the-manuals">Making the manuals</a>).
Note that package <strong>hyperref</strong> (currently) requires packages
<strong>kvoptions</strong>, <strong>ltxcmds</strong> and <strong>refcount</strong>.  For distributions
based on TeX Live the simplest approach may be to install collections
<strong>collection-latex</strong>, <strong>collection-fontsrecommended</strong>,
<strong>collection-latexrecommended</strong>, <strong>collection-fontsextra</strong> and
<strong>collection-latexextra</strong> (assuming they are not installed by
default): Fedora uses names like <strong>texlive-collection-fontsextra</strong> and
Debian/Ubuntu like <strong>texlive-fonts-extra</strong>.
</p>
<span id="index-PATH"></span>
<p>The essential programs should be in your <code>PATH</code> at the time
<code>configure</code> is run: this will capture the full paths.
</p>
<p>Those distributing binary versions of R may need to be aware of the
licences of the external libraries it is linked to (including &lsquo;useful&rsquo;
libraries from the next section).  The <code>liblzma</code> library is in the
public domain and X11, <code>libbzip2</code>, <code>libcurl</code> and <code>zlib</code>
have MIT-style licences. PCRE and PCRE2 have a BSD-style licence which
requires distribution of the licence (included in R&rsquo;s
<samp>COPYRIGHTS</samp> file) in binary distributions.  GNU <code>readline</code> is
licensed under GPL (which version(s) of GPL depends on the
<code>readline</code> version).
</p>
<hr>
</div>
<div class="section" id="Useful-libraries-and-programs">
<div class="header">
<p>
Next: <a href="#Linear-algebra" accesskey="n" rel="next">Linear algebra</a>, Previous: <a href="#Essential-programs-and-libraries" accesskey="p" rel="prev">Essential programs and libraries</a>, Up: <a href="#Essential-and-useful-other-programs-under-a-Unix_002dalike" accesskey="u" rel="up">Essential and useful other programs under a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Useful-libraries-and-programs-1"></span><h3 class="section">A.2 Useful libraries and programs</h3>

<p>The ability to use translated messages makes use of <code>gettext</code> and
most likely needs <acronym>GNU</acronym> <code>gettext</code>: you do need this to work
with new translations, but otherwise the version of the <code>gettext</code>
runtime contained in the R sources will be used if no suitable external
<code>gettext</code> is found.
</p>
<span id="index-Cairo-1"></span>
<span id="index-Pango"></span>
<p>The &lsquo;modern&rsquo; version of the <code>X11()</code>, <code>jpeg()</code>, <code>png()</code>
and <code>tiff()</code> graphics devices uses the Cairo and Pango libraries.
Cairo version 1.2.0 or later and Pango version 1.10 or later are
required (but much later versions are current).  R checks for
<code>pkg-config</code>, and uses that to check first that the
&lsquo;<samp>pangocairo</samp>&rsquo; package is installed (and if not, &lsquo;<samp>cairo</samp>&rsquo;) then
if suitable code can be compiled.  These tests will fail if
<code>pkg-config</code> is not installed<a id="DOCF61" href="#FOOT61"><sup>61</sup></a>, and might fail if <code>cairo</code> was built
statically unless <code>configure</code> option
<samp>--with-static-cairo</samp> is used.  Most systems with <code>Gtk+</code> 2.8
or later installed will have suitable libraries: for Fedora users the
<code>pango-devel</code> RPM and its dependencies suffice.
It is possible (but very unusual on a platform with X11) to build Cairo
without its <code>cairo-xlib</code> module in which case <code>X11(type =
&quot;cairo&quot;)</code> will not be available.  Pango is optional but highly desirable
as it is likely to give much better text rendering, including kerning.
</p>
<p>For the best font experience with these devices you need suitable fonts
installed: Linux users will want the <code>urw-fonts</code> package.  On
platforms which have it available, the <code>msttcorefonts</code>
package<a id="DOCF62" href="#FOOT62"><sup>62</sup></a> provides
TrueType versions of Monotype fonts such as Arial and Times New Roman.
Another useful set of fonts is the &lsquo;liberation&rsquo; TrueType fonts available
at
<a href="https://pagure.io/liberation-fonts">https://pagure.io/liberation-fonts</a>,<a id="DOCF63" href="#FOOT63"><sup>63</sup></a> which cover the Latin, Greek and Cyrillic alphabets
plus a fair range of signs.  These share metrics with Arial, Times New
Roman and Courier New, and contain fonts rather similar to the first two
(<a href="https://en.wikipedia.org/wiki/Liberation_fonts">https://en.wikipedia.org/wiki/Liberation_fonts</a>).  Then there
is the &lsquo;Free UCS Outline Fonts&rsquo; project
(<a href="https://www.gnu.org/software/freefont/">https://www.gnu.org/software/freefont/</a>) which are
OpenType/TrueType fonts based on the URW fonts but with extended Unicode
coverage.  See the R help on <code>X11</code> on selecting such fonts.
</p>
<p>The bitmapped graphics devices <code>jpeg()</code>, <code>png()</code> and
<code>tiff()</code> need the appropriate headers and libraries installed:
<code>jpeg</code> (version 6b or later, or <code>libjpeg-turbo</code>) or
<code>libpng</code> (version 1.2.7 or later) and <code>zlib</code> or <code>libtiff</code>
(versions 4.0.[5-10] and 4.[123].0 have been tested) respectively.
<code>pkg-config</code> is used if available and so needs the appropriate
<samp>.pc</samp> file (which requires <code>libtiff</code> version 4.x and is not
available on all platforms for <code>jpeg</code> before version 9c).  They
also need support for either <code>X11</code> or <code>cairo</code> (see above).
Should support for these devices <strong>not</strong> be required or broken
system libraries need to be avoided there are <code>configure</code>
options <samp>--without-libpng</samp>, <samp>--without-jpeglib</samp> and
<samp>--without-libtiff</samp>.  The TIFF library has many optional features
such as <code>jpeg</code>, <code>libz</code>, <code>zstd</code>, <code>lzma</code>, <code>webp</code>,
<code>jbig</code> and <code>jpeg12</code>, none of which is required for the
<code>tiff()</code> devices but may need to be present to link the library
(usually only an issue for static linking).  <code>pkg-config</code> can
tell you what other libraries are required for linking, for example by
<code>pkg-config libtiff-4 --static --libs</code>.
</p>
<p>Option <samp>--with-system-tre</samp> is also available: it needs a recent
version of TRE. (The latest sources are in the <code>git</code> repository
at <a href="https://github.com/laurikari/tre/">https://github.com/laurikari/tre/</a>, but at the time of writing
the resulting build did not complete its checks, nor did R built
against the version supplied by Fedora.)
</p>
<p>An implementation of <acronym>XDR</acronym> is required, and the R sources
contain one which is likely to suffice (although a system version may
have higher performance).  <acronym>XDR</acronym> is part of <acronym>RPC</acronym> and
historically has been part of <samp>libc</samp> on a Unix-alike.  (In
principle <code>man xdr_string</code> should tell you which library is
needed, but it often does not: on some OSes it is provided by
<code>libnsl</code>.)  However some builds<a id="DOCF64" href="#FOOT64"><sup>64</sup></a> of <code>glibc</code> omit or hide it with the intention that the
<acronym>TI-RPC</acronym> library be used, in which case <code>libtirpc</code> (and its
development version) should be installed, and its headers<a id="DOCF65" href="#FOOT65"><sup>65</sup></a> need to be on the C include path or under
<samp>/usr/include/tirpc</samp>.
</p>
<p>Use of the X11 clipboard selection requires the <code>Xmu</code> headers and
libraries.  These are normally part of an X11 installation (e.g. the
Debian meta-package &lsquo;<samp>xorg-dev</samp>&rsquo;), but some distributions have split
this into smaller parts, so for example recent versions of Fedora
require the &lsquo;<samp>libXmu</samp>&rsquo; and &lsquo;<samp>libXmu-devel</samp>&rsquo; RPMs.
</p>
<p>Some systems (notably macOS and at least some FreeBSD systems) have
inadequate support for collation in multibyte locales.  It is possible
to replace the OS&rsquo;s collation support by that from ICU (International
Components for Unicode, <a href="https://icu.unicode.org/">https://icu.unicode.org/</a>), and this
provides much more precise control over collation on all systems.  ICU
is available as sources and as binary distributions for (at least) most
Linux distributions, FreeBSD, macOS and AIX, usually as <code>libicu</code> or
<code>icu4c</code>.  It will be used by default where available: should a very
old or broken version of ICU be found this can be suppressed by
<samp>--without-ICU</samp>.
</p>
<p>The <code>bitmap</code> and <code>dev2bitmap</code> devices and function
<code>embedFonts()</code> use ghostscript
(<a href="https://www.ghostscript.com/">https://www.ghostscript.com/</a>).  This should either be in your
path when the command is run, or its full path specified by the
environment variable <code>R_GSCMD</code> at that time.
<span id="index-R_005fGSCMD"></span>
</p>
<p>At the time of writing a full installation on Fedora Linux used the
following packages and their development versions, and this may provide
a useful checklist for other systems:
</p><div class="example">
<pre class="example">bzip2 cairo fontconfig freetype fribidi glib2 harfbuzz libX11 libXext
libXt libcurl libicu libjpeg libpng libtiff libtirpc libxcrypt ncurses
pango pkgconf-pkg-config pcre2 readline tcl tk xz zlib
</pre></div>



<ul class="section-toc">
<li><a href="#Tcl_002fTk" accesskey="1">Tcl/Tk</a></li>
<li><a href="#Java-support" accesskey="2">Java support</a></li>
<li><a href="#Other-compiled-languages" accesskey="3">Other compiled languages</a></li>
</ul>
<hr>
<div class="subsection" id="Tcl_002fTk">
<div class="header">
<p>
Next: <a href="#Java-support" accesskey="n" rel="next">Java support</a>, Previous: <a href="#Useful-libraries-and-programs" accesskey="p" rel="prev">Useful libraries and programs</a>, Up: <a href="#Useful-libraries-and-programs" accesskey="u" rel="up">Useful libraries and programs</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Tcl_002fTk-1"></span><h4 class="subsection">A.2.1 Tcl/Tk</h4>

<p>The <strong>tcltk</strong> package needs Tcl/Tk &ge; 8.4 installed: the sources are
available at <a href="https://www.tcl.tk/">https://www.tcl.tk/</a>.  To specify the locations of the
Tcl/Tk files you may need the configuration options
</p>
<dl compact="compact">
<dt><span><samp>--with-tcltk</samp></span></dt>
<dd><p>use Tcl/Tk, or specify its library directory
</p></dd>
<dt><span><samp>--with-tcl-config=<var>TCL_CONFIG</var></samp></span></dt>
<dd><p>specify location of <samp>tclConfig.sh</samp>
</p></dd>
<dt><span><samp>--with-tk-config=<var>TK_CONFIG</var></samp></span></dt>
<dd><p>specify location of <samp>tkConfig.sh</samp>
</p></dd>
</dl>

<p>or use the configure variables <code>TCLTK_LIBS</code> and
<code>TCLTK_CPPFLAGS</code> to specify the flags needed for linking against
the Tcl and Tk libraries and for finding the <samp>tcl.h</samp> and
<samp>tk.h</samp> headers, respectively.  If you have both 32- and 64-bit
versions of Tcl/Tk installed, specifying the paths to the correct config
files may be necessary to avoid confusion between them.
</p>
<p>Versions of Tcl/Tk up to 8.5.19 and 8.6.12 have been tested (including
most versions of 8.4.x, but not recently).
</p>
<p>Note that the <samp>tk.h</samp> header includes<a id="DOCF66" href="#FOOT66"><sup>66</sup></a> X11 headers, so you will need X11 and its
development files installed.
</p>
<hr>
</div>
<div class="subsection" id="Java-support">
<div class="header">
<p>
Next: <a href="#Other-compiled-languages" accesskey="n" rel="next">Other compiled languages</a>, Previous: <a href="#Tcl_002fTk" accesskey="p" rel="prev">Tcl/Tk</a>, Up: <a href="#Useful-libraries-and-programs" accesskey="u" rel="up">Useful libraries and programs</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Java-support-1"></span><h4 class="subsection">A.2.2 Java support</h4>

<p>The build process looks for Java support on the host system, and if it
finds it sets some settings which are useful for Java-using packages
(such as <a href="https://CRAN.R-project.org/package=rJava"><strong>rJava</strong></a> and <a href="https://CRAN.R-project.org/package=JavaGD"><strong>JavaGD</strong></a>: these require a full
JDK).  This check can be suppressed by configure option
<samp>--disable-java</samp>.
<span id="index-JAVA_005fHOME"></span>
Configure variable <code>JAVA_HOME</code> can be set to point to a specific
JRE/JDK, on the <code>configure</code> command line or in the environment.
</p>
<p>Principal amongst these settings are some paths to the Java
libraries and JVM, which are stored in environment variable
<span id="index-R_005fJAVA_005fLD_005fLIBRARY_005fPATH"></span>
<code>R_JAVA_LD_LIBRARY_PATH</code> in file <samp><var>R_HOME</var>/etc/ldpaths</samp> (or
a sub-architecture-specific version).  A typical setting for
&lsquo;<samp>x86_64</samp>&rsquo; Linux is
</p>
<div class="example">
<pre class="example">JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.322.b06-6.fc34.x86_64/jre
R_JAVA_LD_LIBRARY_PATH=${JAVA_HOME}/lib/amd64/server
</pre></div>

<p>Unfortunately this depends on the exact version of the JRE/JDK
installed, and so may need updating if the Java installation is updated.
This can be done by running <code>R CMD javareconf</code> which updates
settings in both <samp><var>R_HOME</var>/etc/Makeconf</samp> and
<samp><var>R_HOME</var>/etc/ldpaths</samp>. See <code>R CMD javareconf --help</code> for
details: note that this needs to be done by the account owning the R
installation.
</p>
<p>Another way of overriding those settings is to set the environment variable
<span id="index-R_005fJAVA_005fLD_005fLIBRARY_005fPATH-1"></span>
<code>R_JAVA_LD_LIBRARY_PATH</code> (before R is started, hence not in
<samp>~/.Renviron</samp>), which suffices to run already-installed
Java-using packages.  For example
</p>
<div class="example">
<pre class="example">R_JAVA_LD_LIBRARY_PATH=/usr/lib/jvm/java-1.8.0/jre/lib/amd64/server
</pre></div>

<p>It may be possible to avoid this by specifying an invariant link as the
path when configuring. For example, on that system any of
</p>
<div class="example">
<pre class="example">JAVA_HOME=/usr/lib/jvm/java
JAVA_HOME=/usr/lib/jvm/java-1.8.0
JAVA_HOME=/usr/lib/jvm/java-1.8.0/jre
JAVA_HOME=/usr/lib/jvm/jre-1.8.0
</pre></div>

<p>worked (since the &lsquo;auto&rsquo; setting of <code>/etc/alternatives</code> chose
Java 8 aka 1.8.0).
</p>
<p>&lsquo;Non-server&rsquo; Oracle distributions of Java as from version 11 are of a
full JDK.  However, Linux distributions can be confusing: for example
Fedora 34 had
</p><div class="example">
<pre class="example">java-1.8.0-openjdk
java-1.8.0-openjdk-devel
java-openjdk
java-openjdk-devel
java-11-openjdk
java-11-openjdk-devel
java-17-openjdk
java-17-openjdk-devel
java-latest-openjdk
java-latest-openjdk-devel
</pre></div>
<p>where the <code>-devel</code> RPMs are needed to complete the JDK. Debian/Ubuntu use
&lsquo;<samp>-jre</samp>&rsquo; and &lsquo;<samp>-jdk</samp>&rsquo;, e.g.
</p><div class="example">
<pre class="example">sudo apt install default-jdk
</pre></div>

<hr>
</div>
<div class="subsection" id="Other-compiled-languages">
<div class="header">
<p>
Previous: <a href="#Java-support" accesskey="p" rel="prev">Java support</a>, Up: <a href="#Useful-libraries-and-programs" accesskey="u" rel="up">Useful libraries and programs</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Other-compiled-languages-1"></span><h4 class="subsection">A.2.3 Other compiled languages</h4>

<p>Some add-on packages need a C++ compiler.  This is specified by the
configure variables <code>CXX</code>, <code>CXXFLAGS</code> and similar.
<code>configure</code> will normally find a suitable compiler.  It is
possible to specify an alternative C++17 compiler by the configure
variables <code>CXX17</code>, <code>CXX17STD</code>, <code>CXX17FLAGS</code> and similar
(see <a href="#C_002b_002b-Support">C++ Support</a>).  Again, <code>configure</code> will normally find a
suitable value for <code>CXX17STD</code> if the compiler given by <code>CXX</code>
is capable of compiling C++17 code, but it is possible that a completely
different compiler will be needed.  (Similar macros are provided for
C++20.)
</p>
<p>For source files with extension <samp>.f90</samp> or <samp>.f95</samp> containing
free-form Fortran, the compiler defined by the macro <code>FC</code> is used
by <code>R CMD INSTALL</code>.  Note that it is detected by the name of the
command without a test that it can actually compile Fortran 90 code.
Set the configure variable <code>FC</code> to override this if necessary:
variables <code>FCFLAGS</code> and <code>FCLIBS_XTRA</code> might also need to be
set.
</p>
<p>See file <samp>config.site</samp> in the R source for more details about
these variables.
</p>
<hr>
</div>
</div>
<div class="section" id="Linear-algebra">
<div class="header">
<p>
Previous: <a href="#Useful-libraries-and-programs" accesskey="p" rel="prev">Useful libraries and programs</a>, Up: <a href="#Essential-and-useful-other-programs-under-a-Unix_002dalike" accesskey="u" rel="up">Essential and useful other programs under a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Linear-algebra-1"></span><h3 class="section">A.3 Linear algebra</h3>
<span id="index-BLAS-library"></span>


<p>The linear algebra routines in R make use of <acronym>BLAS</acronym> (Basic
Linear Algebra Subprograms, <a href="https://www.netlib.org/blas/faq.html">https://www.netlib.org/blas/faq.html</a>)
routines, and most make use of routines from <acronym>LAPACK</acronym> (Linear
Algebra PACKage, <a href="https://www.netlib.org/lapack">https://www.netlib.org/lapack</a>).  The R
sources contain reference (Fortran) implementations of these, but they
can be replaced by external libraries, usually those tuned for speed on
specific CPUs.  These libraries normally contain all of the BLAS
routines and some tuned LAPACK routines and perhaps the rest of LAPACK
from the reference implementation.  Because of the way linking works,
using an external BLAS library may necessitate using the version of
LAPACK it contains.
</p>
<p>Note that the alternative implementations will not give identical
numeric results.  Some differences may be benign (such the signs of SVDs
and eigenvectors), but the optimized routines can be less accurate and
(particularly for LAPACK) can be from older versions with fewer
corrections.  However, R relies on
<acronym>ISO</acronym>/<acronym>IEC</acronym>&nbsp;60559 compliance.  This can be broken
if for example the code assumes that terms with a zero factor are always
zero and do not need to be computed&mdash;whereas <code>x*0</code> can be
<code>NaN</code>.  The internal BLAS has been extensively patched to avoid
this whereas MKL&rsquo;s documentation has warned
</p><blockquote>
<p>LAPACK routines assume that input matrices do not contain IEEE 754
special values such as INF or NaN values. Using these special values may
cause LAPACK to return unexpected results or become unstable.
</p></blockquote>

<p>Some of the external libraries are multi-threaded.  One issue is
that R profiling (which uses the <code>SIGPROF</code> signal) may cause
problems, and you may want to disable profiling if you use a
multi-threaded <acronym>BLAS</acronym>.  Note that using a multi-threaded
<acronym>BLAS</acronym> can result in taking more <acronym>CPU</acronym> time and even
more elapsed time (occasionally dramatically so) than using a similar
single-threaded <acronym>BLAS</acronym>.  On a machine running other tasks, there
can be contention for CPU caches that reduces the effectiveness of the
optimization of cache use by a <acronym>BLAS</acronym> implementation: some
people warn that this is especially problematic for hyperthreaded CPUs.
</p>
<p>BLAS and LAPACK routines may be used inside threaded code, for example
in OpenMP sections in packages such as <a href="https://CRAN.R-project.org/package=mgcv"><strong>mgcv</strong></a>.  The reference
implementations are thread-safe but external ones may not be (even
single-threaded ones): this can lead to hard-to-track-down incorrect
results or segfaults.
</p>
<p>There is a tendency for re-distributors of R to use &lsquo;enhanced&rsquo; linear
algebra libraries without explaining their downsides.
</p>

<ul class="section-toc">
<li><a href="#BLAS" accesskey="1">BLAS</a></li>
<li><a href="#LAPACK" accesskey="2">LAPACK</a></li>
<li><a href="#Caveats" accesskey="3">Caveats</a></li>
</ul>
<hr>
<div class="subsection" id="BLAS">
<div class="header">
<p>
Next: <a href="#LAPACK" accesskey="n" rel="next">LAPACK</a>, Previous: <a href="#Linear-algebra" accesskey="p" rel="prev">Linear algebra</a>, Up: <a href="#Linear-algebra" accesskey="u" rel="up">Linear algebra</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="BLAS-1"></span><h4 class="subsection">A.3.1 BLAS</h4>

<p>An external BLAS library has to be explicitly requested at configure
time.
</p>
<p>You can specify a particular <acronym>BLAS</acronym> library <em>via</em> a value
for the configuration option <samp>--with-blas</samp>.  If this is given
with no <code>=</code>, its value is taken from the
<span id="index-BLAS_005fLIBS"></span>
environment variable <code>BLAS_LIBS</code>, set for example in
<samp>config.site</samp>.  If neither the option nor the environment variable
supply a value, a search is made for a suitable<a id="DOCF67" href="#FOOT67"><sup>67</sup></a> <acronym>BLAS</acronym>.  If the
value is not obviously a linker command (starting with a dash or giving
the path to a library), it is prefixed by &lsquo;<samp>-l</samp>&rsquo;, so
</p>
<div class="example">
<pre class="example">--with-blas=&quot;foo&quot;
</pre></div>

<p>is an instruction to link against &lsquo;<samp>-lfoo</samp>&rsquo; to find an external
<acronym>BLAS</acronym> (which needs to be found both at link time and run time).
</p>
<p>The configure code checks that the external <acronym>BLAS</acronym> is complete
(it must include all double precision and double complex routines, as
well as <code>LSAME</code>), and appears to be usable.  However, an external
<acronym>BLAS</acronym> has to be usable from a shared object (so must contain
position-independent code), and that is not checked.
</p>
<p>Some enhanced <acronym>BLAS</acronym>es are compiler-system-specific
(<code>Accelerate</code> on macOS, <code>sunperf</code> on Solaris<a id="DOCF68" href="#FOOT68"><sup>68</sup></a>,
<code>libessl</code> on IBM).  The correct incantation for these is often
found <em>via</em> <samp>--with-blas</samp> with no value on the appropriate
platforms.
</p>
<p>Note that under Unix (but not under Windows) if R is compiled against
a non-default <acronym>BLAS</acronym> and <samp>--enable-BLAS-shlib</samp> is
<strong>not</strong> used (it is the default on all platforms except AIX), then
all <acronym>BLAS</acronym>-using packages must also be.  So if R is re-built
to use an enhanced <acronym>BLAS</acronym> then packages such as
<a href="https://CRAN.R-project.org/package=quantreg"><strong>quantreg</strong></a> will need to be re-installed.
</p>
<p>Debian/Ubuntu systems provide a system-specific way to switch the BLAS
in use: Build R with <samp>-with-blas</samp> to select the OS version of
the reference BLAS, and then use <code>update-alternatives</code> to switch
between the available BLAS libraries.  See
<a href="https://wiki.debian.org/DebianScience/LinearAlgebraLibraries">https://wiki.debian.org/DebianScience/LinearAlgebraLibraries</a>.
</p>
<p>Fedora 33 and later offer &lsquo;FlexiBLAS&rsquo;, a similar mechanism for switching
the BLAS in use
(<a href="https://www.mpi-magdeburg.mpg.de/projects/flexiblas">https://www.mpi-magdeburg.mpg.de/projects/flexiblas</a>).  However,
rather than overriding <code>libblas</code>, this requires configuring R
with option <samp>--with-blas=flexiblas</samp>.  &lsquo;Backend&rsquo; wrappers are
available for the reference BLAS, ATLAS and serial, threaded and OpenMP
builds of OpenBLAS and BLIS.  This can be controlled from a running R
session by package <a href="https://CRAN.R-project.org/package=flexiblas"><strong>flexiblas</strong></a>.  Apparently undocumented:
FlexiBLAS on Fedora provides a complete LAPACK, but not the enhanced
routines from ATLAS or OpenBLAS.
</p>

<ul class="section-toc">
<li><a href="#ATLAS" accesskey="1">ATLAS</a></li>
<li><a href="#OpenBLAS-and-BLIS" accesskey="2">OpenBLAS and BLIS</a></li>
<li><a href="#MKL" accesskey="3">Intel MKL</a></li>
<li><a href="#Shared-BLAS" accesskey="4">Shared BLAS</a></li>
</ul>
<hr>
<div class="subsubsection" id="ATLAS">
<div class="header">
<p>
Next: <a href="#OpenBLAS-and-BLIS" accesskey="n" rel="next">OpenBLAS and BLIS</a>, Previous: <a href="#BLAS" accesskey="p" rel="prev">BLAS</a>, Up: <a href="#BLAS" accesskey="u" rel="up">BLAS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="ATLAS-1"></span><h4 class="subsubsection">A.3.1.1 ATLAS</h4>

<p>ATLAS (<a href="http://math-atlas.sourceforge.net/">http://math-atlas.sourceforge.net/</a>) is a &ldquo;tuned&rdquo;
<acronym>BLAS</acronym> that runs on a wide range of Unix-alike platforms.
Unfortunately it is built by default as a static library that on some
platforms may not be able to be used with shared objects such as are
used in R packages.  Be careful when using pre-built versions of
ATLAS static libraries (they seem to work on &lsquo;<samp>ix86</samp>&rsquo; platforms,
but not always on &lsquo;<samp>x86_64</samp>&rsquo; ones).
</p>
<p>ATLAS contains replacements for a small number of LAPACK routines, but
can be built to merge these with the reference LAPACK sources to include
a full LAPACK library.
</p>
<p>Recent versions of ATLAS can be built as a single shared library, either
<code>libsatlas</code> or <code>libtatlas</code> (serial or threaded respectively):
these may even contain a full LAPACK.  Such builds can be used by one of
</p><div class="example">
<pre class="example">--with-blas=satlas
--with-blas=tatlas
</pre></div>
<p>or, as on &lsquo;<samp>x86_64</samp>&rsquo; Fedora where a path needs to be specified,
</p><div class="example">
<pre class="example">--with-blas=&quot;-L/usr/lib64/atlas -lsatlas&quot;
--with-blas=&quot;-L/usr/lib64/atlas -ltatlas&quot;
</pre></div>
<p>Distributed ATLAS libraries cannot be tuned to your machine and so are a
compromise: for example Fedora tunes<a id="DOCF69" href="#FOOT69"><sup>69</sup></a> &lsquo;<samp>x86_64</samp>&rsquo; RPMs for CPUs with
SSE3 extensions, and separate RPMs may be available for specific CPU
families.
</p>
<p>Note that building R on Linux against distributed shared libraries
may need &lsquo;<samp>-devel</samp>&rsquo; or &lsquo;<samp>-dev</samp>&rsquo; packages installed.
</p>
<p>Linking against multiple static libraries requires one of
</p><div class="example">
<pre class="example">--with-blas=&quot;-lf77blas -latlas&quot;
--with-blas=&quot;-lptf77blas -lpthread -latlas&quot;
--with-blas=&quot;-L/path/to/ATLAS/libs -lf77blas -latlas&quot;
--with-blas=&quot;-L/path/to/ATLAS/libs -lptf77blas -lpthread -latlas&quot;
</pre></div>

<p>Consult its installation
guide<a id="DOCF70" href="#FOOT70"><sup>70</sup></a>
for how to build ATLAS as a shared library or as a static library with
position-independent code (on platforms where that matters).
</p>
<p>According to the ATLAS
FAQ<a id="DOCF71" href="#FOOT71"><sup>71</sup></a> the
maximum number of threads used by multi-threaded ATLAS is set at compile
time.  Also, the author advises against using multi-threaded ATLAS on
hyperthreaded CPUs without restricting affinities at compile-time to one
virtual core per physical CPU.  (For the Fedora libraries the
compile-time flag specifies 4 threads.)
</p>

<hr>
</div>
<div class="subsubsection" id="OpenBLAS-and-BLIS">
<div class="header">
<p>
Next: <a href="#MKL" accesskey="n" rel="next">Intel MKL</a>, Previous: <a href="#ATLAS" accesskey="p" rel="prev">ATLAS</a>, Up: <a href="#BLAS" accesskey="u" rel="up">BLAS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="OpenBLAS-and-BLIS-1"></span><h4 class="subsubsection">A.3.1.2 OpenBLAS and BLIS</h4>

<p>Dr Kazushige Goto wrote a tuned <acronym>BLAS</acronym> for several processors
and OSes, which was frozen in 2010.  OpenBLAS
(<a href="https://www.openblas.net/">https://www.openblas.net/</a>) is a descendant project with support
for some later CPUs.
</p>
<p>This can be used by configuring R with something like
</p>
<div class="example">
<pre class="example">--with-blas=&quot;openblas&quot;
</pre></div>

<p>See see <a href="#Shared-BLAS">Shared BLAS</a> for an alternative (and in many ways preferable)
way to use them.
</p>
<p>Some platforms provide multiple builds of OpenBLAS: for example Fedora 34
has RPMs<a id="DOCF72" href="#FOOT72"><sup>72</sup></a>
</p><div class="example">
<pre class="example">openblas
openblas-threads
openblas-openmp
</pre></div>
<p>providing shared libraries
</p><div class="example">
<pre class="example">libopenblas.so
libopenblasp.so
libopenblaso.so
</pre></div>
<p>respectively, each of which can be used as a shared BLAS.  For the
second and third the number of threads is controlled by
<code>OPENBLAS_NUM_THREADS</code> and <code>OMP_NUM_THREADS</code> (as usual for
OpenMP) respectively.
</p>
<p>These and their Debian equivalents contain a complete LAPACK
implementation.
</p>
<p>Note that building R on Linux against distributed libraries may need
&lsquo;<samp>-devel</samp>&rsquo; or &lsquo;<samp>-dev</samp>&rsquo; packages installed.
</p>
<p>For &lsquo;<samp>ix86</samp>&rsquo; and &lsquo;<samp>x86_64</samp>&rsquo; CPUs most distributed libraries
contain several alternatives for different CPU microarchitectures with
the choice being made at run time.
</p>
<p>Another descendant project is BLIS
(<a href="https://github.com/flame/blis">https://github.com/flame/blis</a>).  This has (in Fedora) shared
libraries
</p><div class="example">
<pre class="example">libblis.so
libblisp.so
libbliso.so
</pre></div>
<p>(<code>p</code> for &lsquo;threads&rsquo;, <code>o</code> for OpenMP as for OpenBLAS) which can
also be used as a shared BLAS.  The Fedora builds do not include LAPACK
in the BLIS libraries.
</p>
<hr>
</div>
<div class="subsubsection" id="MKL">
<div class="header">
<p>
Next: <a href="#Shared-BLAS" accesskey="n" rel="next">Shared BLAS</a>, Previous: <a href="#OpenBLAS-and-BLIS" accesskey="p" rel="prev">OpenBLAS and BLIS</a>, Up: <a href="#BLAS" accesskey="u" rel="up">BLAS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Intel-MKL"></span><h4 class="subsubsection">A.3.1.3 Intel MKL</h4>
<p>For Intel processors (and perhaps others) and some distributions of
Linux, there is Intel&rsquo;s Math Kernel Library<a id="DOCF73" href="#FOOT73"><sup>73</sup></a>.  You are
encouraged to read the documentation which is installed with the
library before attempting to link to MKL.  This includes a &lsquo;link line
advisor&rsquo; which will suggest appropriate incantations: its use is
recommended.  Or see
<a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/onemkl-link-line-advisor.html#gs.vpt6qp">https://www.intel.com/content/www/us/en/developer/tools/oneapi/onemkl-link-line-advisor.html#gs.vpt6qp</a>.
</p>
<p>There are also versions of MKL for macOS<a id="DOCF74" href="#FOOT74"><sup>74</sup></a> and Windows, but when
these have been tried they did not work with the default compilers used
for R on those platforms.
</p>
<p>The MKL interface has changed several times but has been stable in
recent years: the following examples have been used with versions 10.3
to 2022.0.2, for GCC compilers on &lsquo;<samp>x86_64</samp>&rsquo; CPUs.
</p>
<p>To use a sequential version of MKL we used
</p>
<div class="example">
<pre class="example">MKL_LIB_PATH=/path/to/intel_mkl/mkl/lib/intel64
export LD_LIBRARY_PATH=$MKL_LIB_PATH
MKL=&quot;-L${MKL_LIB_PATH} -lmkl_gf_lp64 -lmkl_core -lmkl_sequential&quot;
./configure --with-blas=&quot;$MKL&quot; --with-lapack
</pre></div>

<p>The option <samp>--with-lapack</samp> is used since MKL contains a tuned
copy of LAPACK (often older than the current version) as well as the
<acronym>BLAS</acronym> (see <a href="#LAPACK">LAPACK</a>), although this can be omitted.
</p>
<p>Threaded MKL may be used by replacing the line defining the variable
<code>MKL</code> by
</p>
<div class="example">
<pre class="example">MKL=&quot;-L${MKL_LIB_PATH} -lmkl_gf_lp64 -lmkl_core \
     -lmkl_gnu_thread -dl -fopenmp&quot;
</pre></div>

<p>R can also be linked against a single shared library,
<code>libmkl_rt.so</code>, for both BLAS and LAPACK, but the correct OpenMP and
MKL interface layer then has to be selected via environment variables.  With
64-bit builds and the GCC compilers, we used
</p>
<div class="example">
<pre class="example">export MKL_INTERFACE_LAYER=GNU,LP64 
export MKL_THREADING_LAYER=GNU
</pre></div>

<p>On Debian/Ubuntu, MKL is provided by package <code>intel-mkl-full</code> and one
can set <code>libmkl_rt.so</code> as the system-wide implementation of both BLAS
and LAPACK during installation of the package, so that also R installed
from Debian/Ubuntu package <code>r-base</code> would use it.  It is, however,
still essential to set <code>MKL_INTERFACE_LAYER</code> and
<code>MKL_THREADING_LAYER</code> before running R, otherwise MKL computations
will produce incorrect results. R does not have to be rebuilt to use MKL,
but <code>configure</code> include tests which may discover some errors such as a
failure to set the correct OpenMP and MKL interface layer.
</p>
<p>The default number of threads will be chosen by the OpenMP software, but
can be controlled by setting <code>OMP_NUM_THREADS</code> or
<code>MKL_NUM_THREADS</code>, and in recent versions seems to default to a
sensible value for sole use of the machine.  (Parallel MKL has not
always passed <code>make check-all</code>, but did with MKL 2019.4 and later.)
</p>
<p>MKL includes a partial implementation of FFTW3, which causes trouble for
applications that require some of the FFTW3 functionality unsupported in
MKL.  Please see the MKL manuals for description of these limitations and
for instructions on how to create a custom version of MKL which excludes the
FFTW3 wrappers.
</p>



<hr>
</div>
<div class="subsubsection" id="Shared-BLAS">
<div class="header">
<p>
Previous: <a href="#MKL" accesskey="p" rel="prev">Intel MKL</a>, Up: <a href="#BLAS" accesskey="u" rel="up">BLAS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Shared-BLAS-1"></span><h4 class="subsubsection">A.3.1.4 Shared BLAS</h4>

<p>The <acronym>BLAS</acronym> library will be used for many of the add-on packages
as well as for R itself.  This means that it is better to use a
shared/dynamic <acronym>BLAS</acronym> library, as most of a static library will
be compiled into the R executable and each <acronym>BLAS</acronym>-using
package.
</p>
<p>R offers the option of compiling the <acronym>BLAS</acronym> into a dynamic
library <code>libRblas</code> stored in <samp><var>R_HOME</var>/lib</samp> and linking
both R itself and all the add-on packages against that library.
</p>
<p>This is the default on all platforms except AIX unless an external
<acronym>BLAS</acronym> is specified and found: for the latter it can be used by
specifying the option <samp>--enable-BLAS-shlib</samp>, and it can always be
disabled via <samp>--disable-BLAS-shlib</samp>.
</p>
<p>This has both advantages and disadvantages.
</p>
<ul>
<li> It saves space by having only a single copy of the <acronym>BLAS</acronym>
routines, which is helpful if there is an external static <acronym>BLAS</acronym>
(as used to be standard for ATLAS).

</li><li> There may be performance disadvantages in using a shared <acronym>BLAS</acronym>.
Probably the most likely is when R&rsquo;s internal <acronym>BLAS</acronym> is used
and R is <em>not</em> built as a shared library, when it is possible to
build the <acronym>BLAS</acronym> into <samp>R.bin</samp> (and <samp>libR.a</samp>) without
using position-independent code.  However, experiments showed that in
many cases using a shared <acronym>BLAS</acronym> was as fast, provided high
levels of compiler optimization are used.

</li><li> It is easy to change the <acronym>BLAS</acronym> without needing to re-install
R and all the add-on packages, since all references to the
<acronym>BLAS</acronym> go through <code>libRblas</code>, and that can be replaced.
Note though that any dynamic libraries the replacement links to will
need to be found by the linker: this may need the library path to be
changed in <samp><var>R_HOME</var>/etc/ldpaths</samp>.
</li></ul>

<p>Another option to change the <acronym>BLAS</acronym> in use is to symlink a
single dynamic <acronym>BLAS</acronym> library to
<samp><var>R_HOME</var>/lib/libRblas.so</samp>.  For example, just
</p>
<div class="example">
<pre class="example">mv <var>R_HOME</var>/lib/libRblas.so <var>R_HOME</var>/lib/libRblas.so.keep
ln -s /usr/lib64/libopenblasp.so.0 <var>R_HOME</var>/lib/libRblas.so
</pre></div>

<p>on &lsquo;<samp>x86_64</samp>&rsquo; Fedora will change the <acronym>BLAS</acronym> used to
multithreaded OpenBLAS.  A similar link works for most versions of the
OpenBLAS (provided the appropriate <samp>lib</samp> directory is in the
run-time library path or <code>ld.so</code> cache).  It can also be used
for a single-library ATLAS, so on &lsquo;<samp>x86_64</samp>&rsquo; Fedora either of
</p>
<div class="example">
<pre class="example">ln -s /usr/lib64/atlas/libsatlas.so.3 <var>R_HOME</var>/lib/libRblas.so
ln -s /usr/lib64/atlas/libtatlas.so.3 <var>R_HOME</var>/lib/libRblas.so
</pre></div>

<p>can be used with its distributed ATLAS libraries.  (If you have the
&lsquo;<samp>-devel</samp>&rsquo; RPMS installed you can omit the <code>.0</code>/<code>.3</code>.)
</p>
<p>Note that rebuilding or symlinking <samp>libRblas.so</samp> may not suffice
if the intention is to use a modified LAPACK contained in an external
BLAS: the latter could even cause conflicts.  However, on Fedora where
the OpenBLAS distribution contains a copy of LAPACK, it is the latter
which is used.
</p>

<hr>
</div>
</div>
<div class="subsection" id="LAPACK">
<div class="header">
<p>
Next: <a href="#Caveats" accesskey="n" rel="next">Caveats</a>, Previous: <a href="#BLAS" accesskey="p" rel="prev">BLAS</a>, Up: <a href="#Linear-algebra" accesskey="u" rel="up">Linear algebra</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="LAPACK-1"></span><h4 class="subsection">A.3.2 LAPACK</h4>

<span id="index-LAPACK-library"></span>

<p>The default is to compile the LAPACK source included with R.
However, the compiled routines may or may not be used if the selected
BLAS contains some or all LAPACK routines &ndash; this depends on how dynamic
linking works on the platform.
</p>
<p>Provision is made for specifying an external LAPACK library with option
<samp>--with-lapack</samp>, principally to cope with <acronym>BLAS</acronym>
libraries which contain a copy of LAPACK (such as <code>Accelerate</code> on
macOS and some builds of ATLAS, FlexiBLAS, MKL and OpenBLAS on
&lsquo;<samp>ix86</samp>&rsquo;/&lsquo;<samp>x86_64</samp>&rsquo; Linux).  At least LAPACK version 3.2 is
required.  This can only be done if <samp>--with-blas</samp> has been used.
</p>
<p>However, the likely performance gains are thought to be small (and may
be negative).  The default is not to search for a suitable LAPACK
library, and this is definitely <strong>not</strong> recommended.  You can
specify a specific LAPACK library or a search for a generic library by
the configuration option <samp>--with-lapack</samp> without a value.  The
default for <samp>--with-lapack</samp> is to check the <acronym>BLAS</acronym>
library (for function <code>DPSTRF</code>) and then look for an external
library &lsquo;<samp>-llapack</samp>&rsquo;.  Sites searching for the fastest possible
linear algebra may want to build a LAPACK library using the
ATLAS-optimized subset of LAPACK.  Similarly, OpenBLAS can be built to
contain an optimized subset of LAPACK or a full LAPACK (the latter
seeming to be the default).
</p>
<p>A value for <samp>--with-lapack</samp> can be set <em>via</em> the environment
variable
<span id="index-LAPACK_005fLIBS"></span>
<code>LAPACK_LIBS</code>, but this will only be used if <samp>--with-lapack</samp>
is specified and the <acronym>BLAS</acronym> library does not contain LAPACK.
</p>
<p>Please bear in mind that using <samp>--with-lapack</samp> is provided
<strong>only</strong> because it is necessary on some platforms and because some
users want to experiment with claimed performance improvements.  In
practice its main uses are without a value,
</p>
<ul>
<li> with an &lsquo;enhanced&rsquo; BLAS such as ATLAS, FlexiBLAS, MKL or OpenBLAS which
contains a full LAPACK (to avoid possible conflicts), or

</li><li> on Debian/Ubuntu systems to select the system <code>liblapack</code> which can
be switched by the &lsquo;alternatives&rsquo; mechanism.
</li></ul>


<hr>
</div>
<div class="subsection" id="Caveats">
<div class="header">
<p>
Previous: <a href="#LAPACK" accesskey="p" rel="prev">LAPACK</a>, Up: <a href="#Linear-algebra" accesskey="u" rel="up">Linear algebra</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Caveats-1"></span><h4 class="subsection">A.3.3 Caveats</h4>

<p>As with all libraries, you need to ensure that they and R were
compiled with compatible compilers and flags.  For example, this has
meant that on Sun Sparc using the Oracle compilers the flag
<samp>-dalign</samp> is needed if <code>sunperf</code> is to be used.
</p>
<p>On some systems it has been necessary that an external
<acronym>BLAS</acronym>/LAPACK was built with the same Fortran compiler used to
build R.
</p>
<p>BLAS and LAPACK libraries built with <code>gfortran</code>&nbsp;9 and later
(and versions 8.4, 7.5 and later in those series) require calls from
C/C++ to handle &lsquo;hidden&rsquo; character lengths &mdash; R itself does so but
many packages used not to and some have segfaulted.  This has been
largely circumvented by using the Fortran flag
<samp>-fno-optimize-sibling-calls</samp> (currently set by
<code>configure</code> if it detects <code>gfortran</code>&nbsp;7 or later).
</p>
<p>LAPACK 3.9.0 (and probably earlier) had a bug in which the DCOMBSSQ
subroutine may cause NA to be interpreted as zero. This is fixed in the
R 3.6.3 and later sources, but if you use an external LAPACK, you may
need to fix it there. (The bug was corrected in 3.9.1 and the routine
removed in 3.10.1.)
</p>
<p>The code (in <code>dlapack.f</code>) should read
</p><div class="example">
<pre class="example">*     ..
*     .. Executable Statements ..
*
      IF( V1( 1 ).GE.V2( 1 ) ) THEN
         IF( V1( 1 ).NE.ZERO ) THEN
            V1( 2 ) = V1( 2 ) + ( V2( 1 ) / V1( 1 ) )**2 * V2( 2 )
         ELSE
            V1( 2 ) = V1( 2 ) + V2( 2 )
         END IF
      ELSE
         V1( 2 ) = V2( 2 ) + ( V1( 1 ) / V2( 1 ) )**2 * V1( 2 )
         V1( 1 ) = V2( 1 )
      END IF
      RETURN
</pre></div>
<p>(The inner ELSE clause was missing in LAPACK 3.9.0.)
</p>
<p>If you do use an external LAPACK, be aware of potential problems with
other bugs in the LAPACK sources (or in the posted corrections to those
sources), seen several times in Linux distributions over the years.  We
have even seen distributions with missing LAPACK routines from their
<code>liblapack</code>.
</p>
<p>We rely on limited support in LAPACK for matrices with <em class='math'>2^{31}</em> or
more elements: it is possible that an external LAPACK will not have that
support.
</p>

<hr>
</div>
</div>
</div>
<div class="appendix" id="Configuration-on-a-Unix_002dalike">
<div class="header">
<p>
Next: <a href="#Platform-notes" accesskey="n" rel="next">Platform notes</a>, Previous: <a href="#Essential-and-useful-other-programs-under-a-Unix_002dalike" accesskey="p" rel="prev">Essential and useful other programs under a Unix-alike</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Configuration-on-a-Unix_002dalike-1"></span><h2 class="appendix">Appendix B Configuration on a Unix-alike</h2>


<ul class="section-toc">
<li><a href="#Configuration-options" accesskey="1">Configuration options</a></li>
<li><a href="#Internationalization-support" accesskey="2">Internationalization support</a></li>
<li><a href="#Configuration-variables" accesskey="3">Configuration variables</a></li>
<li><a href="#Setting-the-shell" accesskey="4">Setting the shell</a></li>
<li><a href="#Using-make" accesskey="5">Using make</a></li>
<li><a href="#Using-Fortran" accesskey="6">Using Fortran</a></li>
<li><a href="#Compile-and-load-flags" accesskey="7">Compile and load flags</a></li>
<li><a href="#Maintainer-mode" accesskey="8">Maintainer mode</a></li>
</ul>
<hr>
<div class="section" id="Configuration-options">
<div class="header">
<p>
Next: <a href="#Internationalization-support" accesskey="n" rel="next">Internationalization support</a>, Previous: <a href="#Configuration-on-a-Unix_002dalike" accesskey="p" rel="prev">Configuration on a Unix-alike</a>, Up: <a href="#Configuration-on-a-Unix_002dalike" accesskey="u" rel="up">Configuration on a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Configuration-options-1"></span><h3 class="section">B.1 Configuration options</h3>

<p><code>configure</code> has many options: running
</p>
<div class="example">
<pre class="example">./configure --help
</pre></div>

<p>will give a list.  Probably the most important ones not covered
elsewhere are (defaults in brackets)
</p>
<dl compact="compact">
<dt><span><samp>--with-x</samp></span></dt>
<dd><p>use the X Window System [yes]
</p></dd>
<dt><span><samp>--x-includes=<var>DIR</var></samp></span></dt>
<dd><p>X include files are in <var>DIR</var>
</p></dd>
<dt><span><samp>--x-libraries=<var>DIR</var></samp></span></dt>
<dd><p>X library files are in <var>DIR</var>
</p></dd>
<dt><span><samp>--with-readline</samp></span></dt>
<dd><p>use readline library (if available) [yes]
</p></dd>
<dt><span><samp>--enable-R-profiling</samp></span></dt>
<dd><p>attempt to compile support for <code>Rprof()</code> [yes]
</p></dd>
<dt><span><samp>--enable-memory-profiling</samp></span></dt>
<dd><p>attempt to compile support for <code>Rprofmem()</code> and <code>tracemem()</code> [no]
</p></dd>
<dt><span><samp>--enable-R-shlib</samp></span></dt>
<dd><p>build R as a shared/dynamic library [no]
</p></dd>
<dt><span><samp>--enable-BLAS-shlib</samp></span></dt>
<dd><p>build the <acronym>BLAS</acronym> as a shared/dynamic library [yes, except on AIX]
</p></dd>
</dl>

<p>You can use <samp>--without-foo</samp> or <samp>--disable-foo</samp> for the
negatives.
</p>
<p>You will want to use <samp>--disable-R-profiling</samp> if you are building
a profiled executable of R (e.g. with &lsquo;<samp>-pg)</samp>&rsquo;.  Support for R
profiling requires OS support for POSIX threads (<em>aka</em>
&lsquo;<samp>pthreads</samp>&rsquo;), which are available on all mainstream Unix-alike
platforms.
</p>
<p>Flag <samp>--enable-R-shlib</samp> causes the make process to build R as
a dynamic (shared) library, typically called <samp>libR.so</samp>, and link
the main R executable <samp>R.bin</samp> against that library.  This can
only be done if all the code (including system libraries) can be
compiled into a dynamic library, and there may be a
performance<a id="DOCF75" href="#FOOT75"><sup>75</sup></a> penalty.  So you probably
only want this if you will be using an application which embeds R.
Note that C code in packages installed on an R system linked with
<samp>--enable-R-shlib</samp> is linked against the dynamic library and so
such packages cannot be used from an R system built in the default
way.  Also, because packages are linked against R they are on some
OSes also linked against the dynamic libraries R itself is linked
against, and this can lead to symbol conflicts.
</p>
<p>For maximally effective use of <code>valgrind</code>, R should be
compiled with valgrind instrumentation. The <code>configure</code> option
is <samp>--with-valgrind-instrumentation=<var>level</var></samp>, where
<var>level</var> is 0, 1 or 2.  (Level 0 is the default and does not add
anything.)  The system headers for <code>valgrind</code> can be requested
by option <samp>--with-system-valgrind-headers</samp>: they will be used if
present (on Linux they may be in a separate package such as
<strong>valgrind-devel</strong>).  Note though that there is no guarantee that the
code in R will be compatible with very old<a id="DOCF76" href="#FOOT76"><sup>76</sup></a> or future <code>valgrind</code>
headers.
</p>
<p>If you need to re-configure R with different options you may need to run
<code>make clean</code> or even <code>make distclean</code> before doing so.
</p>
<p>The <samp>configure</samp> script has other generic options added by
<code>autoconf</code> and which are not supported for R: in particular
building for one architecture on a different host is not possible.
</p>
<hr>
</div>
<div class="section" id="Internationalization-support">
<div class="header">
<p>
Next: <a href="#Configuration-variables" accesskey="n" rel="next">Configuration variables</a>, Previous: <a href="#Configuration-options" accesskey="p" rel="prev">Configuration options</a>, Up: <a href="#Configuration-on-a-Unix_002dalike" accesskey="u" rel="up">Configuration on a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Internationalization-support-1"></span><h3 class="section">B.2 Internationalization support</h3>

<p>Translation of messages is supported via <acronym>GNU</acronym> <code>gettext</code>
unless disabled by the configure option <samp>--disable-nls</samp>.
The <code>configure</code> report will show <code>NLS</code> as one of the
&lsquo;Additional capabilities&rsquo; if support has been compiled in, and running
in an English locale (but not the <code>C</code> locale) will include
</p>
<div class="example">
<pre class="example">  Natural language support but running in an English locale
</pre></div>

<p>in the greeting on starting R.
</p>

<hr>
</div>
<div class="section" id="Configuration-variables">
<div class="header">
<p>
Next: <a href="#Setting-the-shell" accesskey="n" rel="next">Setting the shell</a>, Previous: <a href="#Internationalization-support" accesskey="p" rel="prev">Internationalization support</a>, Up: <a href="#Configuration-on-a-Unix_002dalike" accesskey="u" rel="up">Configuration on a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Configuration-variables-1"></span><h3 class="section">B.3 Configuration variables</h3>

<span id="index-configure-4"></span>
<p>If you need or want to set certain configure variables to something
other than their default, you can do that by either editing the file
<samp>config.site</samp> (which documents many of the variables you might want
to set: others can be seen in file <samp>etc/Renviron.in</samp>) or on the
command line as
</p>
<div class="example">
<pre class="example">./configure <var>VAR</var>=<var>value</var>
</pre></div>

<p>If you are building in a directory different from the sources, there can
be copies of <samp>config.site</samp> in the source and the build directories,
and both will be read (in that order).  In addition, if there is a file
<samp>~/.R/config</samp>, it is read between the <samp>config.site</samp> files in
the source and the build directories.
</p>
<p>There is also a general <code>autoconf</code> mechanism for
<samp>config.site</samp> files, which are read before any of those mentioned
in the previous paragraph.  This looks first at a file specified by the
<span id="index-CONFIG_005fSITE"></span>
environment variable <code>CONFIG_SITE</code>, and if not is set at files such
as <samp>/usr/local/share/config.site</samp> and
<samp>/usr/local/etc/config.site</samp> in the area (exemplified by
<samp>/usr/local</samp>) where R would be installed.
</p>
<p>These variables are <em>precious</em>, implying that they do not have to
be exported to the environment, are kept in the cache even if not
specified on the command line, checked for consistency between two
configure runs (provided that caching is used), and are kept during
automatic reconfiguration as if having been passed as command line
arguments, even if no cache is used.
</p>
<p>See the variable output section of <code>configure --help</code> for a list of
all these variables.
</p>
<p>If you find you need to alter configure variables, it is worth noting
that some settings may be cached in the file <samp>config.cache</samp>, and it
is a good idea to remove that file (if it exists) before re-configuring.
Note that caching is turned <em>off</em> by default: use the command line
option <samp>--config-cache</samp> (or <samp>-C</samp>) to enable caching.
</p>

<ul class="section-toc">
<li><a href="#Setting-paper-size" accesskey="1">Setting paper size</a></li>
<li><a href="#Setting-the-browsers" accesskey="2">Setting the browsers</a></li>
<li><a href="#Compilation-flags" accesskey="3">Compilation flags</a></li>
<li><a href="#Making-manuals" accesskey="4">Making manuals</a></li>
</ul>
<hr>
<div class="subsection" id="Setting-paper-size">
<div class="header">
<p>
Next: <a href="#Setting-the-browsers" accesskey="n" rel="next">Setting the browsers</a>, Previous: <a href="#Configuration-variables" accesskey="p" rel="prev">Configuration variables</a>, Up: <a href="#Configuration-variables" accesskey="u" rel="up">Configuration variables</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Setting-paper-size-1"></span><h4 class="subsection">B.3.1 Setting paper size</h4>
<span id="index-R_005fPAPERSIZE-2"></span>
<p>One common variable to change is <code>R_PAPERSIZE</code>, which defaults to
&lsquo;<samp>a4</samp>&rsquo;, not &lsquo;<samp>letter</samp>&rsquo;.  (Valid values are &lsquo;<samp>a4</samp>&rsquo;,
&lsquo;<samp>letter</samp>&rsquo;, &lsquo;<samp>legal</samp>&rsquo; and &lsquo;<samp>executive</samp>&rsquo;.)
</p>
<p>This is used both when configuring R to set the default, and when
running R to override the default.  It is also used to set the
paper size when making PDF manuals.
</p>
<p>The configure default will most often be &lsquo;<samp>a4</samp>&rsquo; if <code>R_PAPERSIZE</code>
is unset.  (If the program <code>paperconf</code> is found, present in many
Linux distributions,
<span id="index-PAPERSIZE"></span>
or the environment variable <code>PAPERSIZE</code> is set, these are used to
produce the default.)
</p>
<hr>
</div>
<div class="subsection" id="Setting-the-browsers">
<div class="header">
<p>
Next: <a href="#Compilation-flags" accesskey="n" rel="next">Compilation flags</a>, Previous: <a href="#Setting-paper-size" accesskey="p" rel="prev">Setting paper size</a>, Up: <a href="#Configuration-variables" accesskey="u" rel="up">Configuration variables</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Setting-the-browsers-1"></span><h4 class="subsection">B.3.2 Setting the browsers</h4>

<span id="index-R_005fBROWSER"></span>
<p>Another precious variable is <code>R_BROWSER</code>, the default <acronym>HTML</acronym>
browser, which should take a value of an executable in the user&rsquo;s path
or specify a full path.
</p>
<span id="index-R_005fPDFVIEWER"></span>
<p>Its counterpart for PDF files is  <code>R_PDFVIEWER</code>.
</p>
<hr>
</div>
<div class="subsection" id="Compilation-flags">
<div class="header">
<p>
Next: <a href="#Making-manuals" accesskey="n" rel="next">Making manuals</a>, Previous: <a href="#Setting-the-browsers" accesskey="p" rel="prev">Setting the browsers</a>, Up: <a href="#Configuration-variables" accesskey="u" rel="up">Configuration variables</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Compilation-flags-1"></span><h4 class="subsection">B.3.3 Compilation flags</h4>

<p>If you have libraries and header files, e.g., for <acronym>GNU</acronym>
readline, in non-system directories, use the variables <code>LDFLAGS</code>
(for libraries, using &lsquo;<samp>-L</samp>&rsquo; flags to be passed to the linker) and
<code>CPPFLAGS</code> (for header files, using &lsquo;<samp>-I</samp>&rsquo; flags to be passed to
the C/C++ preprocessors), respectively, to specify these locations.
These default to &lsquo;<samp>-L/usr/local/lib</samp>&rsquo; (<code>LDFLAGS</code>,
&lsquo;<samp>-L/usr/local/lib64</samp>&rsquo; on most 64-bit Linux OSes) and
&lsquo;<samp>-I/usr/local/include</samp>&rsquo; (<code>CPPFLAGS</code>, but note that on most
systems <samp>/usr/local/include</samp> is regarded as a system include
directory and so instances in that macro will be skipped) to catch the
most common cases.  If libraries are still not found, then maybe your
compiler/linker does not support re-ordering of <samp>-L</samp> and
<samp>-l</samp> flags.
In this case, use a different compiler (or a front-end shell script
which does the re-ordering).
</p>
<p>These flags can also be used to build a faster-running version of R.
On most platforms using <code>gcc</code>, having &lsquo;<samp>-O3</samp>&rsquo; in
<code>CFLAGS</code> and <code>FFLAGS</code> produces worthwhile
performance gains with <code>gcc</code> and <code>gfortran</code>, but may
result in a less reliable build (both segfaults and incorrect numeric
computations have been seen).  On systems using the <acronym>GNU</acronym> linker
(especially those using R as a shared library), it is likely that
including &lsquo;<samp>-Wl,-O1</samp>&rsquo; in <code>LDFLAGS</code> is worthwhile, and
&lsquo;<samp>'-Bdirect,--hash-style=both,-Wl,-O1'</samp>&rsquo; is recommended at
<a href="https://lwn.net/Articles/192624/">https://lwn.net/Articles/192624/</a>.  Tuning compilation to a
specific <acronym>CPU</acronym> family (e.g. &lsquo;<samp>-mtune=native</samp>&rsquo; for
<code>gcc</code>) can give worthwhile performance gains, especially on
older architectures such as &lsquo;<samp>ix86</samp>&rsquo;.
</p>
<hr>
</div>
<div class="subsection" id="Making-manuals">
<div class="header">
<p>
Previous: <a href="#Compilation-flags" accesskey="p" rel="prev">Compilation flags</a>, Up: <a href="#Configuration-variables" accesskey="u" rel="up">Configuration variables</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Making-manuals-1"></span><h4 class="subsection">B.3.4 Making manuals</h4>

<span id="index-R_005fRD4PDF-1"></span>
<span id="index-R_005fPAPERSIZE-3"></span>
<p>The default settings for making the manuals are controlled by
<code>R_RD4PDF</code> and <code>R_PAPERSIZE</code>.
</p>
<hr>
</div>
</div>
<div class="section" id="Setting-the-shell">
<div class="header">
<p>
Next: <a href="#Using-make" accesskey="n" rel="next">Using make</a>, Previous: <a href="#Configuration-variables" accesskey="p" rel="prev">Configuration variables</a>, Up: <a href="#Configuration-on-a-Unix_002dalike" accesskey="u" rel="up">Configuration on a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Setting-the-shell-1"></span><h3 class="section">B.4 Setting the shell</h3>

<p>By default the shell scripts such as <samp>R</samp> will be &lsquo;<samp>#!/bin/sh</samp>&rsquo;
scripts (or using the <code>SHELL</code> chosen by <samp>configure</samp>).  This is
almost always satisfactory, but on a few systems <samp>/bin/sh</samp> is not a
Bourne shell or clone, and the shell to be used can be changed by
setting the configure variable <code>R_SHELL</code> to a suitable value (a full
path to a shell, e.g. <samp>/usr/local/bin/bash</samp>).
</p>
<hr>
</div>
<div class="section" id="Using-make">
<div class="header">
<p>
Next: <a href="#Using-Fortran" accesskey="n" rel="next">Using Fortran</a>, Previous: <a href="#Setting-the-shell" accesskey="p" rel="prev">Setting the shell</a>, Up: <a href="#Configuration-on-a-Unix_002dalike" accesskey="u" rel="up">Configuration on a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Using-make-1"></span><h3 class="section">B.5 Using make</h3>
<span id="index-make"></span>

<p>To build in a separate directory you need a <code>make</code> that supports
the <code>VPATH</code> variable, for example <acronym>GNU</acronym> <code>make</code> and
<code>dmake</code>.
</p>
<p>If you want to use a <code>make</code> by another name, for example if your
<acronym>GNU</acronym> <code>make</code> is called &lsquo;<samp>gmake</samp>&rsquo;, you need to set the
variable <code>MAKE</code> at configure time, for example
</p>
<span id="index-configure-5"></span>
<div class="example">
<pre class="example">./configure MAKE=gmake
</pre></div>

<hr>
</div>
<div class="section" id="Using-Fortran">
<div class="header">
<p>
Next: <a href="#Compile-and-load-flags" accesskey="n" rel="next">Compile and load flags</a>, Previous: <a href="#Using-make" accesskey="p" rel="prev">Using make</a>, Up: <a href="#Configuration-on-a-Unix_002dalike" accesskey="u" rel="up">Configuration on a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Using-Fortran-1"></span><h3 class="section">B.6 Using Fortran</h3>
<span id="index-Fortran"></span>

<p>To compile R, you need a Fortran 90 compiler.  The current default
is to search for
<code>gfortran</code>, <code>g95</code>, <code>xlf95</code> <code>f95</code>,
<code>fort</code>, <code>ifort</code>, <code>ifc</code>, <code>efc</code>,
<code>pgfortran</code>, <code>pgf95</code> <code>lf95</code>, <code>ftn</code>,
<code>nagfor</code>, <code>xlf90</code>, <code>f90</code>, <code>pgf90</code>,
<code>pghpf</code>, <code>epcf90</code>.  (Note that these are searched for by
name, without checking the standard of Fortran they support.)  The
command and flags used should support fixed-form Fortran with extension
<samp>.f</samp>: in the unusual case that a specific flag is needed for
free-form Fortran with extension <samp>.f90</samp> or <samp>.f95</samp>, this can be
specified as part of <code>FCFLAGS</code>.
</p>
<p>The search mechanism can be changed using the configure variable
<code>FC</code> which specifies the command that runs the Fortran compiler.
If your Fortran compiler is in a non-standard location, you
<span id="index-PATH-1"></span>
should set the environment variable <code>PATH</code> accordingly before
running <code>configure</code>, or use the configure variable <code>FC</code> to
specify its full path.
</p>
<p>If your Fortran libraries are in slightly peculiar places, you should
<span id="index-LD_005fLIBRARY_005fPATH-1"></span>
also look at <code>LD_LIBRARY_PATH</code> (or your system&rsquo;s equivalent) to make
sure that all libraries are on this path.
</p>
<p>Note that only Fortran compilers which convert identifiers to lower case
are supported.
</p>
<p>You must set whatever compilation flags (if any) are needed to ensure
that Fortran <code>integer</code> is equivalent to a C <code>int</code> pointer and
Fortran <code>double precision</code> is equivalent to a C <code>double</code>
pointer.  This is checked during the configuration process.
</p>
<p>Some of the Fortran code makes use of <code>DOUBLE COMPLEX</code> and
<code>COMPLEX*16</code> variables.  This is checked for at configure time, as
well as its equivalence to the <code>Rcomplex</code> C structure defined in
<samp>R_ext/Complex.h</samp>.
</p>
<p><code>gfortran</code>&nbsp;10 by default gives a compilation error for the
previously widespread practice of passing a Fortran array element where
an array is expected, or a scalar instead of a length-one array.  See
<a href="https://gcc.gnu.org/gcc-10/porting_to.html">https://gcc.gnu.org/gcc-10/porting_to.html</a>. <code>gfortran</code>&nbsp;12
errors in more cases of this.
</p>
<hr>
</div>
<div class="section" id="Compile-and-load-flags">
<div class="header">
<p>
Next: <a href="#Maintainer-mode" accesskey="n" rel="next">Maintainer mode</a>, Previous: <a href="#Using-Fortran" accesskey="p" rel="prev">Using Fortran</a>, Up: <a href="#Configuration-on-a-Unix_002dalike" accesskey="u" rel="up">Configuration on a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Compile-and-load-flags-1"></span><h3 class="section">B.7 Compile and load flags</h3>

<p>A wide range of flags can be set in the file <samp>config.site</samp> or as
configure variables on the command line.  We have already mentioned
</p>
<dl compact="compact">
<dt><span><code>CPPFLAGS</code></span></dt>
<dd><p>header file search directory (<samp>-I</samp>) and any other miscellaneous
options for the C and C++ preprocessors and compilers
</p></dd>
<dt><span><code>LDFLAGS</code></span></dt>
<dd><p>path (<samp>-L</samp>), stripping (<samp>-s</samp>) and any other miscellaneous
options for the linker
</p></dd>
</dl>

<p>and others include
</p>
<dl compact="compact">
<dt><span><code>CFLAGS</code></span></dt>
<dd><p>debugging and optimization flags, C
</p></dd>
<dt><span><code>MAIN_CFLAGS</code></span></dt>
<dd><p>ditto, for compiling the main program (e.g. when profiling)
</p></dd>
<dt><span><code>SHLIB_CFLAGS</code></span></dt>
<dd><p>for shared objects (no known examples)
</p></dd>
<dt><span><code>FFLAGS</code></span></dt>
<dd><p>debugging and optimization flags, fixed-form Fortran
</p></dd>
<dt><span><code>FCFLAGS</code></span></dt>
<dd><p>debugging and optimization flags, free-form Fortran
</p></dd>
<dt><span><code>SAFE_FFLAGS</code></span></dt>
<dd><p>ditto for source files which need exact floating point behaviour
</p></dd>
<dt><span><code>MAIN_FFLAGS</code></span></dt>
<dd><p>ditto, for compiling the main program (e.g. when profiling)
</p></dd>
<dt><span><code>SHLIB_FFLAGS</code></span></dt>
<dd><p>for shared objects (no known examples)
</p></dd>
<dt><span><code>MAIN_LDFLAGS</code></span></dt>
<dd><p>additional flags for the main link
</p></dd>
<dt><span><code>SHLIB_LDFLAGS</code></span></dt>
<dd><p>additional flags for linking the shared objects
</p></dd>
<dt><span><code>LIBnn</code></span></dt>
<dd><p>the primary library directory, <samp>lib</samp> or <samp>lib64</samp>
</p></dd>
<dt><span><code>CPICFLAGS</code></span></dt>
<dd><p>special flags for compiling C code to be turned into a shared object
</p></dd>
<dt><span><code>FPICFLAGS</code></span></dt>
<dd><p>special flags for compiling Fortran code to be turned into a shared object
</p></dd>
<dt><span><code>CXXPICFLAGS</code></span></dt>
<dd><p>special flags for compiling C++ code to be turned into a shared object
</p></dd>
<dt><span><code>DEFS</code></span></dt>
<dd><p>defines to be used when compiling C code in R itself
</p></dd>
</dl>

<p>Library paths specified as <samp>-L/lib/path</samp> in <code>LDFLAGS</code> are
<span id="index-LD_005fLIBRARY_005fPATH-2"></span>
collected together and prepended to <code>LD_LIBRARY_PATH</code> (or your
system&rsquo;s equivalent), so there should be no need for <samp>-R</samp> or
<samp>-rpath</samp> flags.
</p>
<p>Variables such as <code>CPICFLAGS</code> are determined where possible by
<code>configure</code>.  Some systems allows two types of PIC flags, for
example &lsquo;<samp>-fpic</samp>&rsquo; and &lsquo;<samp>-fPIC</samp>&rsquo;, and if they differ the first
allows only a limited number of symbols in a shared object.  Since R
as a shared library has about 6200 symbols, if in doubt use the larger
version.
</p>
<p>Other variables often set by <code>configure</code> include
&lsquo;<samp>MAIN_LDFLAGS</samp>&rsquo;, &lsquo;<samp>SAFE_FFLAGS</samp>&rsquo;, &lsquo;<samp>SHLIB_LDFLAGS</samp>&rsquo; and
&lsquo;<samp>SHLIB_CXXLDFLAGS</samp>&rsquo;: see file <samp>config.site</samp> in the sources for
more documentation on these and others.
</p>
<p>To compile a profiling version of R, one might for example want to
use &lsquo;<samp>MAIN_CFLAGS=-pg</samp>&rsquo;, &lsquo;<samp>MAIN_FFLAGS=-pg</samp>&rsquo;,
&lsquo;<samp>MAIN_LDFLAGS=-pg</samp>&rsquo; on platforms where &lsquo;<samp>-pg</samp>&rsquo; cannot be used
with position-independent code.
</p>
<p><strong>Beware</strong>: it may be necessary to set <code>CFLAGS</code> and
<code>FFLAGS</code> in ways compatible with the libraries to be used: one
possible issue is the alignment of doubles, another is the way
structures are passed.
</p>
<p>On some platforms <code>configure</code> will select additional flags for
<code>CFLAGS</code>, <code>CPPFLAGS</code> and <code>LIBS</code> in <code>R_XTRA_CFLAGS</code>
(and so on).  These are for options which are always required, for
example to force <acronym>IEC</acronym>&nbsp;60559 compliance.
</p>
<hr>
</div>
<div class="section" id="Maintainer-mode">
<div class="header">
<p>
Previous: <a href="#Compile-and-load-flags" accesskey="p" rel="prev">Compile and load flags</a>, Up: <a href="#Configuration-on-a-Unix_002dalike" accesskey="u" rel="up">Configuration on a Unix-alike</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Maintainer-mode-1"></span><h3 class="section">B.8 Maintainer mode</h3>

<p>There are several files that are part of the R sources but can be
re-generated from their own sources by configuring with option
<samp>--enable-maintainer-mode</samp> and then running <code>make</code> in the
build directory.  This requires other tools to be installed, discussed
in the rest of this section.
</p>
<p>File <samp>configure</samp> is created from <samp>configure.ac</samp> and the files
under <samp>m4</samp> by <code>autoconf</code> and <code>aclocal</code> (part of the
<strong>automake</strong> package).  There is a formal version requirement on
<code>autoconf</code> of 2.69 or later, but it is unlikely that anything
other than the most recent versions<a id="DOCF77" href="#FOOT77"><sup>77</sup></a>
have been thoroughly tested.
</p>
<p>File <samp>src/include/config.h</samp> is created by <code>autoheader</code>
(part of <strong>autoconf</strong>).
</p>
<p>Grammar files <samp>*.y</samp> are converted to C sources by an implementation
of <code>yacc</code>, usually <code>bison -y</code>: these are found in
<samp>src/main</samp> and <samp>src/library/tools/src</samp>.  It is known that
earlier versions of <code>bison</code> generate code which reads (and in
some cases writes) outside array bounds: <code>bison</code> 2.6.1 was found
to be satisfactory.
</p>
<p>The ultimate sources for package <strong>compiler</strong> are in its <samp>noweb</samp>
directory.  To re-create the sources from
<samp>src/library/compiler/noweb/compiler.nw</samp>, the command
<code>notangle</code> is required.  Some Linux distributions include this
command in package <strong>noweb</strong>.  It can also be installed from the
sources at <a href="https://www.cs.tufts.edu/~nr/noweb/">https://www.cs.tufts.edu/~nr/noweb/</a><a id="DOCF78" href="#FOOT78"><sup>78</sup></a>.  The package
sources are only re-created even in maintainer mode if
<samp>src/library/compiler/noweb/compiler.nw</samp> has been updated.
</p>

<hr>
</div>
</div>
<div class="appendix" id="Platform-notes">
<div class="header">
<p>
Next: <a href="#Function-and-variable-index" accesskey="n" rel="next">Function and variable index</a>, Previous: <a href="#Configuration-on-a-Unix_002dalike" accesskey="p" rel="prev">Configuration on a Unix-alike</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Platform-notes-1"></span><h2 class="appendix">Appendix C Platform notes</h2>

<p>This section provides some notes on building R on different Unix-alike
platforms.  These notes are based on tests run on one or two systems in
each case with particular sets of compilers and support libraries.
Success in building R depends on the proper installation and functioning
of support software; your results may differ if you have other versions
of compilers and support libraries.
</p>
<p>Older versions of this manual contain notes on platforms such as HP-UX,
IRIX, Alpha/OSF1 (for R &lt; 2.10.0, and support has since been removed
for all of these) and AIX (for R &lt; = 3.5.x) for which we have had no
recent reports.
</p>
<p>C macros to select particular platforms can be tricky to track down
(there is a fair amount of misinformation on the Web).  The Wiki
(currently) at <a href="https://sourceforge.net/p/predef/wiki/Home/">https://sourceforge.net/p/predef/wiki/Home/</a>
can be helpful.  The R sources have used (often in included software
under <samp>src/extra</samp>)
</p><div class="example">
<pre class="example">AIX: _AIX
Cygwin: __CYGWIN__
FreeBSD: __FreeBSD__
HP-UX: __hpux__, __hpux
IRIX: sgi, __sgi
Linux: __linux__
macOS: __APPLE__
NetBSD: __NetBSD__
OpenBSD: __OpenBSD__
Windows: _WIN32, _WIN64
</pre></div>

<p>Identifying compilers can be very tricky.  GCC defines <code>__GNUC__</code>,
but so do other compilers claiming conformance with it, notably (LLVM
and Apple) <code>clang</code> and recent Intel compilers.  Further, they
use the value of <code>__GNUC__</code> for their version, not the version of
GCC they claim to be compatible with.  Both LLVM and Apple
<code>clang</code> define <code>__clang__</code> as their major version, but for
example Apple&rsquo;s 13.x.y is very different from LLVM&rsquo;s 13.x.y.  And
compilers based on LLVM <code>clang</code>, for example from IBM, will
define this.  Some of the included software uses <code>__APPLE_CC__</code> to
identify an Apple compiler (which used to include Apple builds of GCC),
but Apple <code>clang</code> is better identified by the
<code>__apple_build_version__</code> macro.
</p>

<ul class="section-toc">
<li><a href="#X11-issues" accesskey="1">X11 issues</a></li>
<li><a href="#Linux" accesskey="2">Linux</a></li>
<li><a href="#macOS" accesskey="3">macOS</a></li>
<li><a href="#FreeBSD" accesskey="4">FreeBSD</a></li>
<li><a href="#OpenBSD" accesskey="5">OpenBSD</a></li>
<li><a href="#Cygwin" accesskey="6">Cygwin</a></li>
<li><a href="#New-platforms" accesskey="7">New platforms</a></li>
</ul>
<hr>
<div class="section" id="X11-issues">
<div class="header">
<p>
Next: <a href="#Linux" accesskey="n" rel="next">Linux</a>, Previous: <a href="#Platform-notes" accesskey="p" rel="prev">Platform notes</a>, Up: <a href="#Platform-notes" accesskey="u" rel="up">Platform notes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="X11-issues-1"></span><h3 class="section">C.1 X11 issues</h3>

<p>The &lsquo;<samp>X11()</samp>&rsquo; graphics device is the one started automatically on
Unix-alikes (except most macOS builds) when plotting.  As its name
implies, it displays on a (local or remote) X server, and relies on the
services provided by the X server.
</p>
<span id="index-Cairo-2"></span>
<p>The &lsquo;modern&rsquo; version of the &lsquo;<samp>X11()</samp>&rsquo; device is based on &lsquo;<samp>cairo</samp>&rsquo;
graphics and (in most implementations) uses &lsquo;<samp>fontconfig</samp>&rsquo; to pick and
render fonts.  This is done on the server, and although there can be
selection issues, they are more amenable than the issues with
&lsquo;<samp>X11()</samp>&rsquo; discussed in the rest of this section.
</p>
<p>When X11 was designed, most displays were around 75dpi, whereas today
they are of the order of 100dpi or more.  If you find that X11()
is reporting<a id="DOCF79" href="#FOOT79"><sup>79</sup></a> missing font sizes, especially larger ones, it is likely
that you are not using scalable fonts and have not installed the 100dpi
versions of the X11 fonts.  The names and details differ by system, but
will likely have something like Fedora&rsquo;s
</p><div class="example">
<pre class="example">xorg-x11-fonts-75dpi
xorg-x11-fonts-100dpi
xorg-x11-fonts-ISO8859-2-75dpi
xorg-x11-fonts-Type1
xorg-x11-fonts-cyrillic
</pre></div>

<p>and you need to ensure that the &lsquo;<samp>-100dpi</samp>&rsquo; versions are installed
and on the X11 font path (check via <code>xset -q</code>).  The
&lsquo;<samp>X11()</samp>&rsquo; device does try to set a pointsize and not a pixel size:
laptop users may find the default setting of 12 too large (although very
frequently laptop screens are set to a fictitious dpi to appear like a
scaled-down desktop screen).
</p>
<p>More complicated problems can occur in non-Western-European locales, so
if you are using one, the first thing to check is that things work in
the <code>C</code> locale.  The likely issues are a failure to find any fonts
or glyphs being rendered incorrectly (often as a pair of <acronym>ASCII</acronym>
characters).  X11 works by being asked for a font specification and
coming up with its idea of a close match.  For text (as distinct from
the symbols used by plotmath), the specification is the first element of
the option <code>&quot;X11fonts&quot;</code> which defaults to
</p>
<div class="example">
<pre class="example">&quot;-adobe-helvetica-%s-%s-*-*-%d-*-*-*-*-*-*-*&quot;
</pre></div>

<p>If you are using a single-byte encoding, for example ISO 8859-2 in
Eastern Europe or KOI8-R in Russian, use <code>xlsfonts</code> to find an
appropriate family of fonts in your encoding (the last field in the
listing).  If you find none, it is likely that you need to install
further font packages, such as &lsquo;<samp>xorg-x11-fonts-ISO8859-2-75dpi</samp>&rsquo; and
&lsquo;<samp>xorg-x11-fonts-cyrillic</samp>&rsquo; shown in the listing above.
</p>
<p>Multi-byte encodings (most commonly UTF-8) are even more complicated.
There are few fonts in &lsquo;<samp>iso10646-1</samp>&rsquo;, the Unicode encoding, and they
only contain a subset of the available glyphs (and are often fixed-width
designed for use in terminals).  In such locales <em>fontsets</em> are
used, made up of fonts encoded in other encodings.  If the locale you
are using has an entry in the &lsquo;<samp>XLC_LOCALE</samp>&rsquo; directory (typically
<samp>/usr/share/X11/locale</samp>), it is likely that all you need to do is to
pick a suitable font specification that has fonts in the encodings
specified there.  If not, you may have to get hold of a suitable locale
entry for X11.  This may mean that, for example, Japanese text can be
displayed when running in &lsquo;<samp>ja_JP.UTF-8</samp>&rsquo; but not when running in
&lsquo;<samp>en_GB.UTF-8</samp>&rsquo; on the same machine (although on some systems many
UTF-8 X11 locales are aliased to &lsquo;<samp>en_US.UTF-8</samp>&rsquo; which covers several
character sets, e.g. ISO 8859-1 (Western European), JISX0208 (Kanji),
KSC5601 (Korean), GB2312 (Chinese Han) and JISX0201 (Kana)).
</p>
<p>On some systems scalable fonts are available covering a wide range of
glyphs.  One source is TrueType/OpenType fonts, and these can provide
high coverage.  Another is Type 1 fonts: the URW set of Type 1 fonts
provides standard typefaces such as Helvetica with a larger coverage of
Unicode glyphs than the standard X11 bitmaps, including Cyrillic.  These
are generally not part of the default install, and the X server may need
to be configured to use them.  They might be under the X11 <samp>fonts</samp>
directory or elsewhere, for example,
</p>
<div class="example">
<pre class="example">/usr/share/fonts/default/Type1
/usr/share/fonts/ja/TrueType
</pre></div>


<hr>
</div>
<div class="section" id="Linux">
<div class="header">
<p>
Next: <a href="#macOS" accesskey="n" rel="next">macOS</a>, Previous: <a href="#X11-issues" accesskey="p" rel="prev">X11 issues</a>, Up: <a href="#Platform-notes" accesskey="u" rel="up">Platform notes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Linux-1"></span><h3 class="section">C.2 Linux</h3>
<span id="index-Linux-1"></span>

<p>Linux is the main development platform for R, so compilation from the
sources is normally straightforward with the most common compilers and
libraries.<a id="DOCF80" href="#FOOT80"><sup>80</sup></a>
</p>
<p>Recall that some package management systems (such as <acronym>RPM</acronym> and
deb) make a distinction between the user version of a package and the
developer version.  The latter usually has the same name but with the
extension &lsquo;<samp>-devel</samp>&rsquo; or &lsquo;<samp>-dev</samp>&rsquo;: you need both versions
installed.  So please check the <code>configure</code> output to see if the
expected features are detected: if for example &lsquo;<samp>readline</samp>&rsquo; is
missing add the developer package.  (On most systems you will also need
&lsquo;<samp>ncurses</samp>&rsquo; and its developer package, although these should be
dependencies of the &lsquo;<samp>readline</samp>&rsquo; package(s).)  You should expect to
see in the <code>configure</code> summary
</p>
<div class="example">
<pre class="example">  Interfaces supported:      X11, tcltk
  External libraries:        pcre2, readline, curl
  Additional capabilities:   PNG, JPEG, TIFF, NLS, cairo, ICU
</pre></div>

<p>When R has been installed from a binary distribution there are
sometimes problems with missing components such as the Fortran
compiler.  Searching the &lsquo;<samp>R-help</samp>&rsquo; archives will normally reveal
what is needed.
</p>
<p>It seems that &lsquo;<samp>ix86</samp>&rsquo; Linux accepts non-PIC code in shared
libraries, but this is not necessarily so on other platforms, in
particular on 64-bit <acronym>CPU</acronym>s such as &lsquo;<samp>x86_64</samp>&rsquo;.  So care
can be needed with <acronym>BLAS</acronym> libraries and when building R as a
shared library to ensure that position-independent code is used in any
static libraries (such as the Tcl/Tk libraries, <code>libpng</code>,
<code>libjpeg</code> and <code>zlib</code>) which might be linked against.
Fortunately these are normally built as shared libraries with the
exception of the ATLAS <acronym>BLAS</acronym> libraries.
</p>
<p>The default optimization settings chosen for <code>CFLAGS</code> etc are
conservative.  It is likely that using <samp>-mtune</samp> will result in
significant performance improvements on recent CPUs: one possibility is
to add <samp>-mtune=native</samp> for the best possible performance on the
machine on which R is being installed.  It is also possible to
increase the optimization levels to <samp>-O3</samp>: however for many
versions of the compilers this has caused problems in at least one
<acronym>CRAN</acronym> package.
</p>
<p>Do not use <samp>-O3</samp> with <code>gcc</code> 11.0 or 11.1: it mis-compiles
code including in package <a href="https://CRAN.R-project.org/package=MASS"><strong>MASS</strong></a> resulting in plausible but
incorrect results.
</p>
<p>For platforms with both 64- and 32-bit support, it is likely that
</p>
<div class="example">
<pre class="example">LDFLAGS=&quot;-L/usr/local/lib64 -L/usr/local/lib&quot;
</pre></div>

<p>is appropriate since most (but not all) software installs its 64-bit
libraries in <samp>/usr/local/lib64</samp>.  To build a 32-bit version of R
on &lsquo;<samp>x86_64</samp>&rsquo; with Fedora 34 we used
</p>
<div class="example">
<pre class="example">CC=&quot;gcc -m32&quot;
CXX=&quot;g++ -m32&quot;
FC=&quot;gfortran -m32&quot;
OBJC=${CC}
LDFLAGS=&quot;-L/usr/local/lib&quot;
LIBnn=lib
</pre></div>

<p>Note the use of &lsquo;<samp>LIBnn</samp>&rsquo;: &lsquo;<samp>x86_64</samp>&rsquo; Fedora installs its
64-bit software in <samp>/usr/lib64</samp> and 32-bit software in
<samp>/usr/lib</samp>.  Linking will skip over inappropriate binaries, but for
example the 32-bit Tcl/Tk configure scripts are in <samp>/usr/lib</samp>.  It
may also be necessary to set the <code>pkg-config</code> path, e.g. by
</p>
<div class="example">
<pre class="example">export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig:/usr/lib/pkgconfig
</pre></div>
<p>The 32-bit system <code>libcurl</code> did not work with the system CA
certificates: this is worked around in R&rsquo;s test suite.
</p>
<p>64-bit versions on Linux are built with support for files &gt; 2Gb, and
32-bit versions will be if possible unless <samp>--disable-largefile</samp>
is specified.
</p>
<p>Note that 32-bit <code>glibc</code> before version 2.29 uses a 32-bit
<code>time_t</code> type, so to pass all the date-time checks needs R built
with flag <samp>--with-internal-tzcode</samp>.
</p>
<p>Users of &lsquo;<samp>ix86</samp>&rsquo; CPUs with SSE2 support<a id="DOCF81" href="#FOOT81"><sup>81</sup></a> may prefer to use the C/C++/Fortran flags
</p>
<div class="example">
<pre class="example">-mfpmath=sse -msse2
</pre></div>

<p>to force floating-point to use the same instructions as &lsquo;<samp>x86_64</samp>&rsquo;
builds and hence not make use of 80-bit &lsquo;extended precision&rsquo;
intermediate results.  (NB: this affects more than floating-point
operations.  For some OSes and versions of <code>gcc</code> it might be
necessary to add <samp>-mstackrealign</samp>.)
</p>
<p>To build a 64-bit version of R on &lsquo;<samp>ppc64</samp>&rsquo; (also known as
&lsquo;<samp>powerpc64</samp>&rsquo;) with <code>gcc</code>&nbsp;4.1.1, Ei-ji Nakama used
</p>
<div class="example">
<pre class="example">CC=&quot;gcc -m64&quot;
CXX=&quot;gxx -m64&quot;
FC=&quot;gfortran -m64&quot;
CFLAGS=&quot;-mminimal-toc -fno-optimize-sibling-calls -g -O2&quot;
FFLAGS=&quot;-mminimal-toc -fno-optimize-sibling-calls -g -O2&quot;
</pre></div>

<p>the additional flags being needed to resolve problems linking against
<samp>libnmath.a</samp> and when linking R as a shared library.
</p>
<p>The setting of the macro &lsquo;<samp>SAFE_FFLAGS</samp>&rsquo; may need some help.  It
should not need additional flags on platforms other than &lsquo;<samp>68000</samp>&rsquo;
(not likely to be encountered) and &lsquo;<samp>ix86</samp>&rsquo;.  For the latter, if
the Fortran compiler is GNU (<code>gfortran</code> or possibly
<code>g77</code>) the flags
</p><div class="example">
<pre class="example">-msse2 -mfpmath=sse
</pre></div>
<p>are added: earlier versions of R added <samp>-ffloat-store</samp> and
this might still be needed if a &lsquo;<samp>ix86</samp>&rsquo; CPU is encountered
without SSE2 support.  Note that it is a <em>replacement</em> for
&lsquo;<samp>FFLAGS</samp>&rsquo;, so should include all the flags in that macro (except
perhaps the optimization level).
</p>
<p>Additional compilation flags can be specified for added safety/security
checks.  For example Fedora adds
</p>
<div class="example">
<pre class="example">-Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS
-Fexceptions -fstack-protector-strong -fasynchronous-unwind-tables
-fstack-clash-protection -fcf-protection
</pre></div>

<p>to all the C, C++ and Fortran compiler flags (even though
<code>_GLIBCXX_ASSERTIONS</code> is only for C++ in current GCC and
<code>glibc</code> and none of these are documented for <code>gfortran</code>).
Use of <code>_GLIBCXX_ASSERTIONS</code> will link <code>abort</code> and
<code>printf</code> into almost all C++ code, and <code>R CMD check
--as-cran</code> will warn.
</p>

<ul class="section-toc">
<li><a href="#Clang" accesskey="1">Clang</a></li>
<li><a href="#Intel-compilers" accesskey="2">Intel compilers</a></li>
</ul>
<hr>
<div class="subsection" id="Clang">
<div class="header">
<p>
Next: <a href="#Intel-compilers" accesskey="n" rel="next">Intel compilers</a>, Previous: <a href="#Linux" accesskey="p" rel="prev">Linux</a>, Up: <a href="#Linux" accesskey="u" rel="up">Linux</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Clang-1"></span><h4 class="subsection">C.2.1 Clang</h4>

<p>R has been built with Linux &lsquo;<samp>ix86</samp>&rsquo; and &lsquo;<samp>x86_64</samp>&rsquo; C and
C++ compilers (<a href="https://clang.llvm.org">https://clang.llvm.org</a>) based on the Clang
front-ends, invoked by <code>CC=clang CXX=clang++</code>, together with
<code>gfortran</code>.  These take very similar options to the
corresponding GCC compilers.
</p>
<p>This has to be used in conjunction with a Fortran compiler: the
<code>configure</code> code will remove <samp>-lgcc</samp> from <code>FLIBS</code>,
which is needed for some versions of <code>gfortran</code>.
</p>
<p>The current out-of-the-box default for <code>clang++</code> is to use the
C++ runtime from the installed <code>g++</code>.  Using the runtime from
the <a href="https://libcxx.llvm.org/"><code>libc++</code></a> project (Fedora RPM
<code>libcxx-devel</code>) <em>via</em> <samp>-stdlib=libc++</samp> has also been
tested.
</p>
<p>Recent versions have (optional when built) OpenMP support.<a id="DOCF82" href="#FOOT82"><sup>82</sup></a>
</p>





<hr>
</div>
<div class="subsection" id="Intel-compilers">
<div class="header">
<p>
Previous: <a href="#Clang" accesskey="p" rel="prev">Clang</a>, Up: <a href="#Linux" accesskey="u" rel="up">Linux</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Intel-compilers-1"></span><h4 class="subsection">C.2.2 Intel compilers</h4>

<p>There have been no recent reports on the use of Intel compilers: this
section is left in case it provides helpful hints.
</p>
<p>Intel compilers have been used under &lsquo;<samp>ix86</samp>&rsquo; and &lsquo;<samp>x86_64</samp>&rsquo;
Linux.  Brian Ripley used version 9.0 of the compilers for
&lsquo;<samp>x86_64</samp>&rsquo; on Fedora Core 5 with
</p>
<div class="example">
<pre class="example">CC=icc
CFLAGS=&quot;-g -O3 -wd188 -ip -mp&quot;
FC=ifort
FLAGS=&quot;-g -O3 -mp&quot;
CXX=icpc
CXXFLAGS=&quot;-g -O3 -mp&quot;
ICC_LIBS=/opt/compilers/intel/cce/9.1.039/lib
IFC_LIBS=/opt/compilers/intel/fce/9.1.033/lib
LDFLAGS=&quot;-L$ICC_LIBS -L$IFC_LIBS -L/usr/local/lib64&quot;
SHLIB_CXXLD=icpc
</pre></div>

<p>It may be necessary to use <code>CC=&quot;icc -std=c99&quot;</code> or <code>CC=&quot;icc
-c99&quot;</code> for C99-compliance.  The flag <samp>-wd188</samp> suppresses a large
number of warnings about the enumeration type &lsquo;<samp>Rboolean</samp>&rsquo;.  Because
the Intel C compiler sets &lsquo;<samp>__GNUC__</samp>&rsquo; without complete emulation of
<code>gcc</code>, we suggest adding <code>CPPFLAGS=-no-gcc</code>.
</p>
<p>To maintain correct <acronym>IEC</acronym>&nbsp;60559 arithmetic you most likely
need add flags to <code>CFLAGS</code>, <code>FFLAGS</code> and
<code>CXXFLAGS</code> such as <samp>-mp</samp> (shown above) or <samp>-fp-model
precise -fp-model source</samp>, depending on the compiler version.
</p>
<p>Others have reported success with versions 10.x and 11.x.  
Bjrn-Helge Mevik reported success with version 2015.3 of the compilers,
using (for a SandyBridge CPU on Centos 6.x)
</p>
<div class="example">
<pre class="example">fast=&quot;-fp-model precise -ip -O3 -opt-mem-layout-trans=3 -xHost -mavx&quot;
CC=icc
CFLAGS=&quot;$fast -wd188&quot;
FC=ifort
FFLAGS=&quot;$fast&quot;
CXX=icpc
CXXFLAGS=&quot;$fast&quot;
</pre></div>

<p>It is possible that 32-builds need to force the use of SSE2 instructions
in <code>SAFE_FFLAGS</code>, e.g. by
</p><div class="example">
<pre class="example">SAFE_FFLAGS=-axsse2
</pre></div>


<hr>
</div>
</div>
<div class="section" id="macOS">
<div class="header">
<p>
Next: <a href="#FreeBSD" accesskey="n" rel="next">FreeBSD</a>, Previous: <a href="#Linux" accesskey="p" rel="prev">Linux</a>, Up: <a href="#Platform-notes" accesskey="u" rel="up">Platform notes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="macOS-2"></span><h3 class="section">C.3 macOS</h3>
<span id="index-macOS-2"></span>

<p>The instructions here are for Intel 64-bit (&lsquo;<samp>x86_64</samp>&rsquo;) builds on
macOS 10.13&ndash;10.15 (High Sierra, Mojave and Catalina), 11 (Big Sur), 12
(Monterey) and 13 (Ventura), or &lsquo;Apple Silicon&rsquo; (&lsquo;<samp>arm64</samp>&rsquo;) builds
on macOS 11 (Big Sur), 12 (Monterey) and 13 (Ventura).
</p>

<ul class="section-toc">
<li><a href="#Prerequisites" accesskey="1">Prerequisites</a></li>
<li><a href="#Fortran-compilers" accesskey="2">Fortran compilers</a></li>
<li><a href="#Cairo-graphics" accesskey="3">Cairo graphics</a></li>
<li><a href="#Other-C_002fC_002b_002b-compilers" accesskey="4">Other C/C++ compilers</a></li>
<li><a href="#Other-libraries" accesskey="5">Other libraries</a></li>
<li><a href="#Tcl_002fTk-headers-and-libraries" accesskey="6">Tcl/Tk headers and libraries</a></li>
<li><a href="#Java-_0028macOS_0029" accesskey="7">Java</a></li>
<li><a href="#Frameworks" accesskey="8">Frameworks</a></li>
<li><a href="#Building-R_002eapp" accesskey="9">Building R.app</a></li>
<li><a href="#Building-binary-packages">Building binary packages</a></li>
<li><a href="#Building-for-Intel-on-arm64">Building for Intel on &lsquo;<samp>arm64</samp>&rsquo;</a></li>
<li><a href="#Installer">Installer</a></li>
</ul>
<hr>
<div class="subsection" id="Prerequisites">
<div class="header">
<p>
Next: <a href="#Fortran-compilers" accesskey="n" rel="next">Fortran compilers</a>, Previous: <a href="#macOS" accesskey="p" rel="prev">macOS</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Prerequisites-1"></span><h4 class="subsection">C.3.1 Prerequisites</h4>

<p>The Intel components install into <samp>/usr/local/lib</samp>, the
&lsquo;<samp>arm64</samp>&rsquo; ones into <samp>/opt/R/arm64</samp> which may not exist so it
it is simplest to first create that directory and adjust its ownership
if desired:
</p>
<div class="example">
<pre class="example">sudo mkdir -p /opt/R/arm64
sudo chown -R myaccount /opt/R
</pre></div>
<p>and add <samp>/opt/R/arm64/bin</samp> to your path.
</p>
<p>Define an appropriate variable in your Terminal:
</p><div class="example">
<pre class="example">set LOCAL=/usr/local # Intel
set LOCAL=/opt/R/arm64 # Apple Silicon
</pre></div>
<p>to use the code snippets here.
</p>
<p>The following are essential to build R:
</p>
<ul>
<li> Apple&rsquo;s &lsquo;Command Line Tools&rsquo;: these can be (re-)installed by running
<code>xcode-select --install</code> in a terminal.

<p>If you have a fresh OS installation, running e.g. <code>make</code> in a
terminal will offer the installation of the command-line tools.  If you
have installed Xcode, this provides the command-line tools.  The tools
may need to be reinstalled when macOS is upgraded, as upgrading may
partially or completely remove them.
</p>
<p>The Command Line Tools provide C and C++ compilers derived from LLVM&rsquo;s
<code>clang</code> but nowadays known as &lsquo;Apple clang&rsquo; with different
versioning (so Apple clang 13 is unrelated to LLVM clang 13).
</p>
</li><li> A Fortran compiler. See <a href="#Fortran-compilers">Fortran compilers</a>.

</li><li> Binary components <code>pcre2</code><a id="DOCF83" href="#FOOT83"><sup>83</sup></a> and
<code>xz</code> (for <code>liblzma</code>) from
<a href="https://mac.r-project.org/bin/">https://mac.r-project.org/bin/</a>.  There is an R script there to
help with installing all the needed components.  (At the time of writing
<code>install.libs(&quot;r-base-dev&quot;)</code> installed neither <code>readline5</code> nor
those needed to support Pango.)

<p>Or this can be done manually, by for example
</p><div class="example">
<pre class="example">curl -OL https://mac.r-project.org/bin/darwin17/x86_64/pcre2-10.39-darwin.17-x86_64.tar.xz
sudo tar -xvzf pcre2-10.39-darwin.17-x86_64.tar.gz -C /
curl -OL https://mac.r-project.org/bin/darwin17/x86_64/xz-5.2.5-darwin.17-x86_64.tar.xz
sudo tar -xvzf xz-5.2.5-darwin.17-x86_64.tar.xz -C /
</pre></div>
<p>(<code>sudo</code> is not needed if your account owns <samp>/usr/local</samp> or
<samp>/opt/R/arm64</samp> as appropriate.)
</p>
<p>Messages like &lsquo;<samp>usr/local/: Can't restore time</samp>&rsquo; should be ignored.
</p></li></ul>
<p>and desirable
</p><ul>
<li> Component <code>readline5</code>.<a id="DOCF84" href="#FOOT84"><sup>84</sup></a>  If <code>readline</code> is
not present, the emulation in Apple&rsquo;s version of <code>libedit</code> (aka
<code>editline</code>) will be used: if you wish to avoid that, configure with
<samp>--without-readline</samp>.

</li><li> Components <code>jpeg</code>, <code>libpng</code>, <code>pkgconfig</code>, <code>tiff</code> and
<code>zlib-system-stub</code> from <a href="https://mac.r-project.org/bin//">https://mac.r-project.org/bin//</a> for
the full range of bitmapped graphics devices.  (Some builds of
<code>tiff</code> may require <code>libwebp</code> and/or <code>openjpeg</code>.)

</li><li> An X sub-system unless configuring using <samp>--without-x</samp>: see
<a href="https://www.xquartz.org/">https://www.xquartz.org/</a>. R&rsquo;s <code>configure</code>
script can be told to look for <code>X11</code> in XQuartz&rsquo;s main
location of <samp>/opt/X11</samp>, e.g. by
<div class="example">
<pre class="example">--x-includes=/opt/X11/include --x-libraries=/opt/X11/lib
</pre></div>

<p>Be wary of pre-release versions of XQuartz, which may be offered as an
update.
</p>
</li><li> An Objective-C compiler, as provided by <code>clang</code> in the Command
Line Tools: this is needed for the <code>quartz()</code> graphics device.

<p>Use <samp>--without-aqua</samp> if you want a standard Unix-alike build:
apart from disabling <code>quartz()</code> and the ability to use the build
with <small>R.APP</small>, it also changes the default location of the personal
library (see <code>?.libPaths</code>).
</p>
</li><li> A Tcl/Tk installation,  See <a href="#Tcl_002fTk-headers-and-libraries">Tcl/Tk headers and libraries</a>.

</li><li> Support for Cairo-based graphics devices. See <a href="#Cairo-graphics">Cairo graphics</a>.

</li><li> A TeX installation. See <a href="#Other-libraries">Other libraries</a>.

</li><li> <code>texi2any</code> from a &lsquo;<samp>texinfo</samp>&rsquo; distribution, which requires
<code>perl</code> (currently version 5.18 (High Sierra) &ndash; 5.30 is a
default part of macOS but it has been announced that it may not be in
future).
A version of <code>texi2any</code> has been included in the binary
distribution of R and there is a <code>texinfo</code> component at
<a href="https://mac.r-project.org/bin//">https://mac.r-project.org/bin//</a>.
</li></ul>

<p>To build R itself from the sources with the C/C++ compilers in the
Command Line Tools (or Xcode) and <code>gfortran</code> from one of the
installers mentioned below, use a file <samp>config.site</samp> containing
</p><div class="example">
<pre class="example">CC=clang
OBJC=$CC
FC=&quot;$LOCAL/gfortran/bin/gfortran -mtune=native&quot;
CXX=clang++
</pre></div>
<p>and configure by something like
</p><div class="example">
<pre class="example">./configure -C \
--enable-R-shlib --enable-memory-profiling \
--x-includes=/opt/X11/include --x-libraries=/opt/X11/lib \
--with-tcl-config=$LOCAL/lib/tclConfig.sh \
--with-tk-config=$LOCAL/lib/tkConfig.sh \
PKG_CONFIG_PATH=$LOCAL/lib/pkgconfig:/usr/lib/pkgconfig
</pre></div>
<p>(See below for other options for Tcl/Tk.)  For an &lsquo;<samp>arm64</samp>&rsquo; build
further flags are desirable in <samp>config.site</samp>:
</p><div class="example">
<pre class="example">CFLAGS=&quot;-falign-functions=8 -g -O2&quot;
FFLAGS=&quot;-g -O2 -mmacosx-version-min=11.0&quot;
</pre></div>
<p>(the first flag in <code>CFLAGS</code> has been needed to inter-work with the
<code>gfortran</code> without segfaulting in some packages, and some builds
of <code>gfortran</code> target the current version of macOS (unlike
<code>clang</code>, causing linker warnings).
</p>
<p>To install packages using compiled code one needs the Command Line Tools
(or Xcode) and appropriate compilers, e.g. the C/C++ compilers from
those tools and/or <code>gfortran</code>. Some packages have further
requirements such as component <code>pkgconfig</code>.
</p>
<p>A subversion client, <code>svn</code> version 1.10, used to be part of
macOS<a id="DOCF85" href="#FOOT85"><sup>85</sup></a>.  A more recent client can be obtained from
<a href="https://mac.r-project.org/tools/">https://mac.r-project.org/tools/</a>, for example by
</p><div class="example">
<pre class="example">curl -OL https://mac.r-project.org/tools/subversion-1.14.0-darwin15.6.tar.gz
tar xf subversion-1.14.0-darwin15.6.tar.gz
sudo cp subversion-1.14.0-darwin15.6/svn $LOCAL/bin
</pre></div>

<p>If building software or installing source packages with <code>cmake</code>
(or a non-Apple <code>make</code>) for &lsquo;Apple Silicon&rsquo; ensure it contains
the &lsquo;<samp>arm64</samp>&rsquo; architecture (use <code>file</code> to be sure).
Running Apple compilers from an &lsquo;<samp>x86_64</samp>&rsquo; executable will
generate &lsquo;<samp>x86_64</samp>&rsquo; code &hellip;.
</p>

<p>Updating an &lsquo;<samp>arm64</samp>&rsquo; build will often fail because of the bug
described at <a href="https://openradar.appspot.com/FB8914243">https://openradar.appspot.com/FB8914243</a> but <em>ab
initio</em> builds work.
</p>



<ul class="section-toc">
<li><a href="#Note-for-Catalina-and-later" accesskey="1">Note for Catalina and later</a></li>
</ul>
<hr>
<div class="subsubsection" id="Note-for-Catalina-and-later">
<div class="header">
<p>
Previous: <a href="#Prerequisites" accesskey="p" rel="prev">Prerequisites</a>, Up: <a href="#Prerequisites" accesskey="u" rel="up">Prerequisites</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Note-for-Catalina-and-later-1"></span><h4 class="subsubsection">C.3.1.1 Note for Catalina and later</h4>

<p>The default security settings for Catalina and later can make it
difficult to install recently-built Apple packages which have not been
&lsquo;notarized&rsquo;<a id="DOCF86" href="#FOOT86"><sup>86</sup></a>
by Apple.  And not just packages, as this has been seen for executables
contained in tarballs/zipfiles (for example, for <code>pandoc</code>).
Usually one can use &lsquo;<samp>Open With</samp>&rsquo; (Control/right/two-finger-click in
Finder), then select &lsquo;<samp>Installer</samp>&rsquo; and &lsquo;<samp>Open</samp>&rsquo; if you get a
further warning message.  This applies also to some &lsquo;nightly builds&rsquo;
from <a href="https://mac.R-project.org/">https://mac.R-project.org/</a>.
</p>
<p>If you run into problems with &lsquo;quarantine&rsquo; for tarballs downloaded in a
browser, consider using <code>curl -OL</code> to download (as illustrated
above) or <code>xattr -c</code> to remove extended attributes.
</p>
<hr>
</div>
</div>
<div class="subsection" id="Fortran-compilers">
<div class="header">
<p>
Next: <a href="#Cairo-graphics" accesskey="n" rel="next">Cairo graphics</a>, Previous: <a href="#Prerequisites" accesskey="p" rel="prev">Prerequisites</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Fortran-compilers-1"></span><h4 class="subsection">C.3.2 Fortran compilers</h4>

<p>An installer for Intel <code>gfortran</code> which runs on High Sierra or
later is available at
<a href="https://github.com/fxcoudert/gfortran-for-macOS/releases/download/8.2/gfortran-8.2-Mojave.dmg">https://github.com/fxcoudert/gfortran-for-macOS/releases/download/8.2/gfortran-8.2-Mojave.dmg</a>. This
installs into <samp>/usr/local/gfortran</samp>.
</p>
<p>A more recent Fortran compiler for (Intel) Catalina and later is
available at
<a href="https://github.com/fxcoudert/gfortran-for-macOS/releases/download/10.2/gfortran-10.2-Catalina.dmg">https://github.com/fxcoudert/gfortran-for-macOS/releases/download/10.2/gfortran-10.2-Catalina.dmg</a>.
(That does not run on High Sierra.)  This supports the option
<samp>-fc-prototypes-external</samp> mentioned in the &lsquo;Writing R Extensions&rsquo;
manual.
</p>
<p>For Intel Big Sur and later there is
<a href="https://github.com/fxcoudert/gfortran-for-macOS/releases/download/11.2-bigsur-intel/gfortran-Intel-11.2-BigSur.dmg">https://github.com/fxcoudert/gfortran-for-macOS/releases/download/11.2-bigsur-intel/gfortran-Intel-11.2-BigSur.dmg</a>
and for Intel Monterey there is
<a href="https://github.com/fxcoudert/gfortran-for-macOS/releases/download/11.3-monterey-intel/gfortran-Intel-11.3-Monterey.dmg">https://github.com/fxcoudert/gfortran-for-macOS/releases/download/11.3-monterey-intel/gfortran-Intel-11.3-Monterey.dmg</a>.
</p>

<p>For &lsquo;<samp>arm64</samp>&rsquo;, we use the fork of <code>gfortran</code> from
<a href="https://github.com/iains/gcc-darwin-arm64">https://github.com/iains/gcc-darwin-arm64</a> of which there are
binary distributions at <a href="https://mac.r-project.org/tools/">https://mac.r-project.org/tools/</a> and
<a href="https://github.com/fxcoudert/gfortran-for-macOS/releases/">https://github.com/fxcoudert/gfortran-for-macOS/releases/</a>.  It
seems some of these have been built using the SDK path for Xcode and not
that for the Command Line Tools which causes some problems<a id="DOCF87" href="#FOOT87"><sup>87</sup></a> when using the Fortran compiler to
link: to fix that change the symbolic link
<samp>/opt/R/arm64/gfortran/SDK</samp> to point to your SDK, e.g. to
<samp>/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk</samp> (the
appropriate path can be found by running <code>xcrun
-show-sdk-path</code>).  (The distribution from
<a href="https://mac.r-project.org/tools/">https://mac.r-project.org/tools/</a> includes a script at
</p><div class="example">
<pre class="example">/opt/R/arm64/gfortran/bin/gfortran-update-sdk
</pre></div>
<p>to do this.)
</p>
<hr>
</div>
<div class="subsection" id="Cairo-graphics">
<div class="header">
<p>
Next: <a href="#Other-C_002fC_002b_002b-compilers" accesskey="n" rel="next">Other C/C++ compilers</a>, Previous: <a href="#Fortran-compilers" accesskey="p" rel="prev">Fortran compilers</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Cairo-graphics-1"></span><h4 class="subsection">C.3.3 Cairo graphics</h4>

<span id="index-Cairo-3"></span>
<p>Cairo-based graphics devices such as <code>cairo_ps</code>, <code>cairo_pdf</code>,
<code>X11(type = &quot;cairo&quot;)</code> and the Cairo-based types of devices
<code>bmp</code> <code>jpeg</code>, <code>png</code> and <code>tiff</code> are not the default
on macOS, and much less used than the Quartz-based devices.  However,
the only SVG device in the R distribution, <code>svg</code>, is based on
Cairo.
</p>
<p>Support for Cairo is optional and can be added in several ways, all of
which need <code>pkg-config</code>. <code>configure</code> will add Cairo support
if <code>pkg-config</code> finds package <code>cairo</code> unless
<code>--without-cairo</code> is used.
</p>
<p>A way to statically link Cairo is by downloading and unpacking
components <code>cairo</code>, <code>fontconfig</code>, <code>freetype</code>,
<code>pixman</code> and <code>zlib-system-stub</code> (and do not have
<samp>/opt/X11/lib/pkgconfig</samp> in <code>PKG_CONFIG_PATH</code>).  Some static
builds of <code>fontconfig</code> need <code>libxml2</code> (from component
<code>xml2</code>) and others <code>expat</code>, supplied by macOS but needing a
file <samp>$LOCAL/lib/pkgconfig/expat.pc</samp> along the lines of
</p><div class="example">
<pre class="example">Name: expat
Version: 2.2.8
Description: expat XML parser
URL: http://www.libexpat.org
Libs: -lexpat
Cflags: 
</pre></div>
<p>Note that the list of components is liable to change: running
<code>pkg-config cairo --exists --print-errors</code> should tell you if
any others are required.
</p>
<p>If you have XQuartz 2.7.x installed (not 2.8.x) and ensure XQuartz&rsquo;s
<code>pkg-config</code> files are found first on its configuration path, Cairo
will be linked dynamically.  This can be done by setting something like
</p><div class="example">
<pre class="example">export PKG_CONFIG_PATH=/opt/X11/lib/pkgconfig:$LOCAL/lib/pkgconfig:/usr/lib/pkgconfig
</pre></div>
<p>or by appending that variable to the <code>configure</code> command.  (Note
that this uses rather old versions of the graphics software.)
</p>
<p>If you use XQuartz or another build of <code>cairo</code> with dynamic
libraries, you can add option <samp>--without-static-cairo</samp> to the
<code>configure</code> call (it may work without).
</p>
<span id="index-Pango-1"></span>
<p>The best font experience of Cairo graphics will be to use it in
combination with Pango which will match that supported on most other
Unix-alikes.  <code>configure</code> uses <code>pkg-config</code> to determine
if all the external software required by both Pango and Cairo is
available: running <code>pkg-config pangocairo --exists
--print-errors</code> should show if the installation suffices and if not,
what is missing.  At the time of writing using pre-built components
<code>cairo</code>, <code>fontconfig</code>, <code>freetype</code>, <code>ffi</code>,
<code>fribidi</code>, <code>gettext</code>, <code>icu</code>, <code>glib</code>,
<code>harfbuzz</code>, <code>pango</code>, <code>pcre</code>, <code>pixman</code> and
<code>xml2</code> sufficed.
</p>
<hr>
</div>
<div class="subsection" id="Other-C_002fC_002b_002b-compilers">
<div class="header">
<p>
Next: <a href="#Other-libraries" accesskey="n" rel="next">Other libraries</a>, Previous: <a href="#Cairo-graphics" accesskey="p" rel="prev">Cairo graphics</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Other-C_002fC_002b_002b-compilers-1"></span><h4 class="subsection">C.3.4 Other C/C++ compilers</h4>

<p>Other distributions of <code>clang</code> may be available from
<a href="https://github.com/llvm/llvm-project/releases/">https://github.com/llvm/llvm-project/releases/</a> (at the time of
writing only for Intel). In particular, these include support for OpenMP
which Apple <code>clang</code> does not.  Some of these have included
support for the ASAN and UBSAN sanitizers.
</p>
<p>Suppose one of these distributions is installed under
<samp>/usr/local/llvm</samp>. Use a file <samp>config.site</samp> containing
</p><div class="example">
<pre class="example">CC=/usr/local/llvm/bin/clang
OBJC=$CC
FC=/usr/local/gfortran/bin/gfortran
CXX=/usr/local/llvm/bin/clang++
LDFLAGS=&quot;-L/usr/local/llvm/lib -L/uar/local/lib&quot;
R_LD_LIBRARY_PATH=/usr/local/llvm/lib:/usr/local/lib
</pre></div>
<p>The care to specify library paths is to ensure that the OpenMP runtime
library, here <samp>/usr/local/llvm/lib/libomp.dylib</samp>, is found when
needed.  If this works, you should see the line
</p><div class="example">
<pre class="example">checking whether OpenMP SIMD reduction is supported... yes
</pre></div>
<p>in the <code>configure</code> output.  Also, &lsquo;<samp>R_LD_LIBRARY_PATH</samp>&rsquo; needs
to be set to find the latest version of the C++ run-time libraries
rather than the system ones.
</p>
<p>For Mojave and later the system paths need to be specified <em>via</em>
</p><div class="example">
<pre class="example">CC=&quot;/usr/local/llvm/bin/clang -isysroot
  /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk&quot;
CXX=&quot;/usr/local/llvm/bin/clang++ -isysroot
 /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk&quot;
</pre></div>
<p>(Long lines split for the manual, only.)  Should the location of the SDK
change (or where Xcode provides the SDK rather than the Command Line
Tools), it can be found by running <code>xcrun -show-sdk-path</code>.
</p>
<p>It is usually possible to build R with GCC (built from the sources,
from a <code>gfortran</code> distribution, from Homebrew, &hellip;).  When
last tested<a id="DOCF88" href="#FOOT88"><sup>88</sup></a> it was not possible to
use <code>gcc</code> to build the <code>quartz()</code> device, so
<code>configure --without-aqua</code> may be required.
</p>
<hr>
</div>
<div class="subsection" id="Other-libraries">
<div class="header">
<p>
Next: <a href="#Tcl_002fTk-headers-and-libraries" accesskey="n" rel="next">Tcl/Tk headers and libraries</a>, Previous: <a href="#Other-C_002fC_002b_002b-compilers" accesskey="p" rel="prev">Other C/C++ compilers</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Other-libraries-1"></span><h4 class="subsection">C.3.5 Other libraries</h4>

<p>Pre-compiled versions of many of the <a href="#Useful-libraries-and-programs">Useful libraries and programs</a>
are available from <a href="https://mac.r-project.org/bin//">https://mac.r-project.org/bin//</a>.
</p>
<span id="index-BLAS-library-1"></span>
<span id="index-LAPACK-library-1"></span>
<p>The <code>Accelerate</code>
library<a id="DOCF89" href="#FOOT89"><sup>89</sup></a>
can be used <em>via</em> the configuration option
</p>
<div class="example">
<pre class="example">--with-blas=&quot;-framework Accelerate&quot;
</pre></div>

<p>to provide potentially higher-performance versions of the <acronym>BLAS</acronym>
and LAPACK routines.<a id="DOCF90" href="#FOOT90"><sup>90</sup></a>  This also includes a full
LAPACK which can be used <em>via</em> <samp>--with-lapack</samp>: however, the
version of LAPACK it contains has
often been seriously old (and is not used unless <samp>--with-lapack</samp>
is specified).  Some <acronym>CRAN</acronym> builds of R can be
switched<a id="DOCF91" href="#FOOT91"><sup>91</sup></a>
to use Accelerate&rsquo;s BLAS.
</p>
<p>Threading in Accelerate is controlled by &lsquo;Grand Central Dispatch&rsquo; and is
said not to need user control.  Test <samp>nls.R</samp> in package <strong>stats</strong>
has often failed with the Accelerate BLAS on Intel macOS.
</p>
<p><code>sessionInfo()</code> does not detect the use of Accelerate for either
BLAS or LAPACK.
</p>
<p>Looking at the top of
<samp>/Library/Frameworks/R.framework/Resources/etc/Makeconf</samp>
will show the compilers and configuration options used for the
<acronym>CRAN</acronym> binary package for R: at the time of writing the
non-default options
</p><div class="example">
<pre class="example">--enable-memory-profiling --enable-R-framework
--x-libraries=/opt/X11/lib --x-includes=/opt/X11/include
</pre></div>
<p>were used. (<samp>--enable-R-framework</samp> implies <samp>--enable-R-shlib</samp>.)
</p>
<p>Configure option <samp>--with-internal-tzcode</samp> is the default on macOS,
as the system implementation of time zones does not work correctly for
times before 1902 or after 2037 (despite using a 64-bit <code>time_t</code>).
</p>
<p>The main TeX implementation used by the developers is
MacTeX<a id="DOCF92" href="#FOOT92"><sup>92</sup></a>
(<a href="https://www.tug.org/mactex/">https://www.tug.org/mactex/</a>): the full installation is about
7.5GB, but a much smaller version (&lsquo;Basic TeX&rsquo;) is available at
<a href="https://www.tug.org/mactex/morepackages.html">https://www.tug.org/mactex/morepackages.html</a> to which you will
need to add some packages to build R, e.g. for the 2022 version we
needed to add<a id="DOCF93" href="#FOOT93"><sup>93</sup></a> <strong>helvetic</strong>, <strong>inconsolata</strong> and
<strong>texinfo</strong> which brought this to about 310MB.<a id="DOCF94" href="#FOOT94"><sup>94</sup></a>
&lsquo;<samp>TeX Live Utility</samp>&rsquo; (available <em>via</em> the MacTeX front page)
provides a graphical means to manage TeX packages.  MacTeX 2021/2
require Mojave or later: for earlier macOS versions see the
instructions<a id="DOCF95" href="#FOOT95"><sup>95</sup></a> on the MacTeX front page.  They contains executables
which run natively on both &lsquo;<samp>x86_64</samp>&rsquo; and &lsquo;<samp>arm64</samp>&rsquo;.
</p>
<p>Checking packages thoroughly requires <code>ghostscript</code> (part of the
full MacTeX distribution or separately from
<a href="https://www.tug.org/mactex/morepackages.html">https://www.tug.org/mactex/morepackages.html</a>, including for High
Sierra) and <code>qpdf</code> (from
<a href="https://mac.r-project.org/bin//">https://mac.r-project.org/bin//</a>, a version of
which is in the <samp>bin</samp> directory of a binary installation of R,
usually
<samp>/Library/Frameworks/R.framework/Resources/bin/qpdf</samp>).
</p>
<p><code>R CMD check --as-cran</code> makes use of &lsquo;HTML Tidy&rsquo;.  macOS has
a version in <samp>/usr/bin/tidy</samp> dating from 2006 which is far too
old and is skipped.  Up-to-date versions can be installed from
<a href="http://binaries.html-tidy.org/">http://binaries.html-tidy.org/</a>. 
</p>
<p>One macOS quirk is that the default path has <samp>/usr/local/bin</samp> after
<samp>/usr/bin</samp>, contrary to common practice on Unix-alikes.  This means
that if you install tools from the sources they will by default be
installed under <samp>/usr/local</samp> and not supersede the system
versions.
</p>
<p>Parallel installation of packages will make use of the utility
<code>timeout</code> if available.  A dual-architecture build can be
downloaded from <a href="https://www.stats.ox.ac.uk/pub/bdr/timeout">https://www.stats.ox.ac.uk/pub/bdr/timeout</a>: make
it executable (<code>chmod 755 timeout</code>) and put it somewhere on your
path.
</p>
<hr>
</div>
<div class="subsection" id="Tcl_002fTk-headers-and-libraries">
<div class="header">
<p>
Next: <a href="#Java-_0028macOS_0029" accesskey="n" rel="next">Java</a>, Previous: <a href="#Other-libraries" accesskey="p" rel="prev">Other libraries</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Tcl_002fTk-headers-and-libraries-1"></span><h4 class="subsection">C.3.6 Tcl/Tk headers and libraries</h4>

<p>If you plan to use the <code>tcltk</code> package for R, you will need to
install a distribution of Tcl/Tk.  There are two alternatives.  If you
use <small>R.APP</small> you will want to use X11-based Tcl/Tk (as used on other
Unix-alikes), which is installed under <samp>$LOCAL/lib</samp> as part of the <acronym>CRAN</acronym> binary for
R.<a id="DOCF96" href="#FOOT96"><sup>96</sup></a>  This may need <code>configure</code>
options
</p><div class="example">
<pre class="example">--with-tcltk=$LOCAL/lib
</pre></div>
<p>or
</p><div class="example">
<pre class="example">--with-tcl-config=$LOCAL/lib/tclConfig.sh
--with-tk-config=$LOCAL/lib/tkConfig.sh
</pre></div>
<p>Note that this requires a matching<a id="DOCF97" href="#FOOT97"><sup>97</sup></a>
XQuartz installation.
</p>
<p>There is also a native (&lsquo;Aqua&rsquo;) version of Tcl/Tk which produces widgets
in the native macOS style: this will not work with <small>R.APP</small> because of
conflicts over the macOS menu, but for those only using command-line
R this provides a much more intuitive interface to Tk for experienced
Mac users.  Earlier versions of macOS came with an Aqua Tcl/Tk
distribution but these were often not at all recent versions of Tcl/Tk.
It is better to install Tcl/Tk 8.6.x from the sources<a id="DOCF98" href="#FOOT98"><sup>98</sup></a> or a binary distribution from
<a href="https://www.activestate.com/activetcl/downloads">https://www.activestate.com/activetcl/downloads</a>.  For the latter,
configure R with
</p><div class="example">
<pre class="example">--with-tcl-config=/Library/Frameworks/Tcl.framework/tclConfig.sh 
--with-tk-config=/Library/Frameworks/Tk.framework/tkConfig.sh
</pre></div>

<p>If you need to find out which distribution of Tk is in use at run time,
use
</p><div class="example">
<pre class="example">library(tcltk)
tclvalue(.Tcl(&quot;tk windowingsystem&quot;))  # &quot;x11&quot; or &quot;aqua&quot;
</pre></div>

<p>Note that some Tcl/Tk extensions only support the X11 interface: this
includes <code>Tktable</code> and the <acronym>CRAN</acronym> package
<a href="https://CRAN.R-project.org/package=tkrplot"><strong>tkrplot</strong></a>.
</p>
<hr>
</div>
<div class="subsection" id="Java-_0028macOS_0029">
<div class="header">
<p>
Next: <a href="#Frameworks" accesskey="n" rel="next">Frameworks</a>, Previous: <a href="#Tcl_002fTk-headers-and-libraries" accesskey="p" rel="prev">Tcl/Tk headers and libraries</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Java"></span><h4 class="subsection">C.3.7 Java</h4>


<p>macOS does not comes with an installed Java runtime (JRE) and a macOS
upgrade may remove one if already installed: it is intended to be
installed at first use.  Check if a JRE is installed by running
<code>java -version</code> in a <code>Terminal</code> window: if Java is not
installed<a id="DOCF99" href="#FOOT99"><sup>99</sup></a> this should prompt you to install it.<a id="DOCF100" href="#FOOT100"><sup>100</sup></a>  Builds of OpenJDK may also be available,
e.g. from <a href="https://adoptium.net">Adoptium</a>,
<a href="https://www.azul.com/downloads/zulu-community/">Azul</a> or
<a href="https://jdk.java.net/">https://jdk.java.net/</a>.  We recommend you install a version with
long-term support, e.g. 11 or 17 but not 12&ndash;16 or 18 which have/had a
6-month lifetime.  (Note that these sources may use unusual designations
for Intel macOS builds such as <code>x86 64-bit</code> and <code>x64</code>.)
</p>
<p>Binary distributions of R are built against a specific version
(e.g. 11.0.6 or 17.0.1) of Java so <code>sudo R CMD javareconf</code>
will likely be needed to be run before using Java-using packages.
</p>
<p>To see what compatible versions of Java are currently installed, run the
appropriate one of
</p><div class="example">
<pre class="example">/usr/libexec/java_home -V -a x86_64
/usr/libexec/java_home -V -a arm64
</pre></div>
<p>If needed, set the environment variable <code>JAVA_HOME</code> to choose
between these, both when R is built from the sources and when
<code>R CMD javareconf</code> is run.
</p>
<p>Configuring and building R both looks for a JRE and for support for
compiling JNI programs (used to install packages <a href="https://CRAN.R-project.org/package=rJava"><strong>rJava</strong></a> and
<a href="https://CRAN.R-project.org/package=JavaGD"><strong>JavaGD</strong></a>); the latter requires a JDK (Java SDK).  Most
distributions of Java 9 or later are of a full JDK.
</p>
<p>The build process tries to fathom out what JRE/JDK to use, but it may
need some help, e.g. by setting environment variable <code>JAVA_HOME</code>.
To select a build from <a href="https://adoptium.net">Adoptium</a>
set e.g.
</p><div class="example">
<pre class="example">JAVA_HOME=/Library/Java/JavaVirtualMachines/termurin-17.jdk/Contents/Home
</pre></div>
<p>in <samp>config.site</samp>.  For Java 17 from <a href="https://jdk.java.net/">https://jdk.java.net/</a>
(which is no longer available), use
</p><div class="example">
<pre class="example">JAVA_HOME=/path/to/jdk-17.jdk/Contents/Home
</pre></div>

<p>For an &lsquo;<samp>arm64</samp>&rsquo; build, the earliest Java version which is
officially supported is 17.  The currently simplest way to install Java
is from <a href="https://adoptium.net">Adoptium</a> (who call the architecture
&lsquo;<samp>aarch64</samp>&rsquo;): this installs into an Apple-standard location and so
works with <code>/usr/bin/java</code>. Other builds are available from
<a href="https://www.azul.com/downloads/zulu-community/?os=macos&amp;architecture=arm-64-bit&amp;package=jdk">https://www.azul.com/downloads/zulu-community/?os=macos&amp;architecture=arm-64-bit&amp;package=jdk</a>
and from OpenJDK at <a href="https://jdk.java.net/">https://jdk.java.net/</a>, for which
<code>JAVA_HOME</code> may need to be set both when configuring R and at
runtime.
</p>
<p>To use Java (specifically, binary package <a href="https://CRAN.R-project.org/package=rJava"><strong>rJava</strong></a>) with a
<acronym>CRAN</acronym> (&lsquo;<samp>x86_64</samp>&rsquo;) binary distribution of R on
&lsquo;<samp>arm64</samp>&rsquo; macOS, install an Intel build of a Java JRE from one of
the sites linked above, then run <code>sudo R CMD javareconf</code>.
</p>

<p>Note that it is necessary to set the environment variable <code>NOAWT</code> to
<code>1</code> to install many of the Java-using packages.
</p>

<hr>
</div>
<div class="subsection" id="Frameworks">
<div class="header">
<p>
Next: <a href="#Building-R_002eapp" accesskey="n" rel="next">Building R.app</a>, Previous: <a href="#Java-_0028macOS_0029" accesskey="p" rel="prev">Java</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Frameworks-1"></span><h4 class="subsection">C.3.8 Frameworks</h4>

<p>The <acronym>CRAN</acronym> build of R is installed as a framework, which is
selected by the option
</p>
<div class="example">
<pre class="example">./configure --enable-R-framework
</pre></div>

<p>(This is intended to be used with an Apple toolchain: others may not
support frameworks correctly but those from
<a href="https://releases.llvm.org">https://releases.llvm.org</a> do.)
</p>
<p>It is only needed if you want to build R for use with the <small>R.APP</small>
console, and implies <samp>--enable-R-shlib</samp> to build R as a
dynamic library.  This option configures R to be built and installed
as a framework called <samp>R.framework</samp>.  The default installation path
for <samp>R.framework</samp> is <samp>/Library/Frameworks</samp> but this can be
changed at configure time by specifying the flag
<samp>--enable-R-framework[=<var>DIR</var>]</samp> (or <samp>--prefix</samp>) or at
install time <em>via</em>
</p>
<div class="example">
<pre class="example">make prefix=/where/you/want/R.framework/to/go install
</pre></div>

<p>Note that installation as a framework is non-standard (especially to a
non-standard location) and Unix utilities may not support it (e.g. the
<code>pkg-config</code> file <samp>libR.pc</samp> will be put somewhere unknown
to <code>pkg-config</code>).
</p>
<hr>
</div>
<div class="subsection" id="Building-R_002eapp">
<div class="header">
<p>
Next: <a href="#Building-binary-packages" accesskey="n" rel="next">Building binary packages</a>, Previous: <a href="#Frameworks" accesskey="p" rel="prev">Frameworks</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Building-R_002eapp-1"></span><h4 class="subsection">C.3.9 Building R.app</h4>

<p>Building the <small>R.APP</small> GUI console is a separate project, using Xcode.
Before compiling <small>R.APP</small> make sure the current version of R is
installed in <samp>/Library/Frameworks/R.framework</samp> and is working at the
command-line (this can be a binary install).
</p>
<p>The current sources can be checked out by
</p><div class="example">
<pre class="example">svn co https://svn.r-project.org/R-packages/trunk/Mac-GUI
</pre></div>
<p>and built by loading the <code>R.xcodeproj</code> project (select the
<code>R</code> target and a suitable configuration), or from the command-line
by e.g.
</p><div class="example">
<pre class="example">xcodebuild -target R -configuration Release
</pre></div>
<p>See also the <samp>INSTALL</samp> file in the checkout or directly at
<a href="https://svn.r-project.org/R-packages/trunk/Mac-GUI/INSTALL">https://svn.r-project.org/R-packages/trunk/Mac-GUI/INSTALL</a>.
</p>
<p><small>R.APP</small> does not need to be installed in any specific way. Building
<small>R.APP</small> results in the <small>R.APP</small> bundle which appears as one R icon. This
application bundle can be run anywhere and it is customary to place it
in the <samp>/Applications</samp> folder.
</p>
<hr>
</div>
<div class="subsection" id="Building-binary-packages">
<div class="header">
<p>
Next: <a href="#Building-for-Intel-on-arm64" accesskey="n" rel="next">Building for Intel on &lsquo;<samp>arm64</samp>&rsquo;</a>, Previous: <a href="#Building-R_002eapp" accesskey="p" rel="prev">Building R.app</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Building-binary-packages-1"></span><h4 class="subsection">C.3.10 Building binary packages</h4>

<p><acronym>CRAN</acronym> macOS binary packages are distributed as tarballs with
suffix <samp>.tgz</samp> to distinguish them from source tarballs.  One can
<code>tar</code> an existing installed package, or use <code>R CMD
INSTALL --build</code>.
</p>
<p>However, there are some important details.
</p><ul>
<li> Current <acronym>CRAN</acronym> &lsquo;<samp>x86_64</samp>&rsquo; macOS distributions are targeted
at High Sierra so it is wise to ensure that the compilers generate code
that will run on High Sierra or later.  With the recommended compilers
we can use
<div class="example">
<pre class="example">CC=&quot;clang -mmacosx-version-min=10.13&quot;
CXX=&quot;clang++ -mmacosx-version-min=10.13&quot;
FC=&quot;/usr/local/gfortran/bin/gfortran -mmacosx-version-min=10.13&quot;
</pre></div>

<p>For &lsquo;<samp>arm64</samp>&rsquo;, use the flag <samp>-mmacosx-version-min=11.0</samp>.
</p>
</li><li> Using the flag <samp>-Werror=partial-availability</samp> can help trigger
compilation errors on functionality not in High Sierra.

</li><li> Check that any compiled code is not dynamically linked to libraries only
on your machine, for example by using <code>otool -L</code> or
<code>objdump -macho -dylibs-used</code>.  This can include C++ and Fortran
run-time libraries under <samp>/usr/local/lib</samp> or
<samp>/opt/R/arm64/lib</samp>: one can use <code>install_name_tool</code> to
point these at system versions or those shipped with R, for example
<div class="example">
<pre class="example">install_name_tool -change /usr/local/llvm/lib/libc++.1.dylib \
/usr/lib/libc++.1.dylib \
<var>pkg</var>.so

install_name_tool -change /usr/local/gfortran/lib/libgfortran.5.dylib \
/Library/Frameworks/R.framework/Resources/lib/libgfortran.5.dylib \
<var>pkg</var>.so
</pre></div>

<p>(where the details depend on the compilers and <acronym>CRAN</acronym> macOS R
release).
</p>
</li><li> For C++ code there is the possibility that calls will be generated to
entry points not in the system <samp>/usr/lib/libc++.1.dylib</samp>.  The
previous step allows this to be tested against the system library on the
build OS, but not against earlier ones.  It may be possible to
circumvent that by static linking to <samp>libc++.a</samp> and
<samp>libc++abi.a</samp> by something like
<div class="example">
<pre class="example">SHLIB_CXXLD = /usr/local/llvm/bin/clang
PKG_LIBS = /usr/local/llvm/lib/libc++.a /usr/local/llvm/lib/libc++abi.a
</pre></div>
<p>in <samp>src/Makevars</samp>.  It would also be possible to static link the
Fortran runtime libraries <samp>/usr/local/gfortran/lib/libgfortran.a</samp>
and <samp>/usr/local/gfortran/lib/libquadmath.a</samp> should the Fortran
compiler have later versions (but <code>gfortran</code> 8&ndash;12 all
have version <code>5</code>).
</p></li></ul>
<p>The <acronym>CRAN</acronym> binary packages are built with the Apple compiler on
the oldest supported version of macOS, which avoids the first two and
any issues with C++ libraries.
</p>






























<hr>
</div>
<div class="subsection" id="Building-for-Intel-on-arm64">
<div class="header">
<p>
Next: <a href="#Installer" accesskey="n" rel="next">Installer</a>, Previous: <a href="#Building-binary-packages" accesskey="p" rel="prev">Building binary packages</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Building-for-Intel-on-arm64-1"></span><h4 class="subsection">C.3.11 Building for Intel on &lsquo;<samp>arm64</samp>&rsquo;</h4>

<p>Should one want to build R for Intel on an &lsquo;<samp>arm64</samp>&rsquo; Big Sur
Mac, add the target for the C and C++ compilers:
</p>
<div class="example">
<pre class="example">CC=&quot;clang -arch x86_64
OBJC=$CC
CXX=&quot;clang++ -arch x86_64&quot;
FC=&quot;/usr/local/gfortran/bin/gfortran -mtune=native -mmacosx-version-min=10.13&quot;
</pre></div>

<p>and install the Fortran compiler and external software described above
for Intel builds (and have <samp>/usr/local/bin</samp> before
<samp>/opt/R/arm64/bin</samp> in your path).
</p>
<p>To set the correct architecture (which will be auto-detected as
<code>aarch64</code>), use something like
</p>
<div class="example">
<pre class="example">/path/to/configure --build=x86_64-apple-darwin20
</pre></div>


<hr>
</div>
<div class="subsection" id="Installer">
<div class="header">
<p>
Previous: <a href="#Building-for-Intel-on-arm64" accesskey="p" rel="prev">Building for Intel on &lsquo;<samp>arm64</samp>&rsquo;</a>, Up: <a href="#macOS" accesskey="u" rel="up">macOS</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Installer-1"></span><h4 class="subsection">C.3.12 Installer</h4>

<p>The scripts for the <acronym>CRAN</acronym> packaging of R can be found under
<a href="https://svn.r-project.org/R-dev-web/trunk/QA/Simon/R4">https://svn.r-project.org/R-dev-web/trunk/QA/Simon/R4</a>: start
with the <samp>README</samp> file in that directory.
</p>





















































<hr>
</div>
</div>
<div class="section" id="FreeBSD">
<div class="header">
<p>
Next: <a href="#OpenBSD" accesskey="n" rel="next">OpenBSD</a>, Previous: <a href="#macOS" accesskey="p" rel="prev">macOS</a>, Up: <a href="#Platform-notes" accesskey="u" rel="up">Platform notes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="FreeBSD-1"></span><h3 class="section">C.4 FreeBSD</h3>
<span id="index-FreeBSD"></span>

<p>There have been few recent reports on FreeBSD: there is a &lsquo;port&rsquo; at
<a href="https://svnweb.freebsd.org/ports/head/math/">https://svnweb.freebsd.org/ports/head/math/</a>.  Recent versions of
FreeBSD use Clang and the <code>libc++</code> C++ headers and runtime, but the
&lsquo;port&rsquo; is configured to use GCC.
</p>
<p>Use of ICU for collation and the <code>configure</code> option
<samp>--with-internal-tzcode</samp> are desirable workarounds.
</p>
<hr>
</div>
<div class="section" id="OpenBSD">
<div class="header">
<p>
Next: <a href="#Cygwin" accesskey="n" rel="next">Cygwin</a>, Previous: <a href="#FreeBSD" accesskey="p" rel="prev">FreeBSD</a>, Up: <a href="#Platform-notes" accesskey="u" rel="up">Platform notes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="OpenBSD-1"></span><h3 class="section">C.5 OpenBSD</h3>
<span id="index-OpenBSD"></span>

<p>Ingo Feinerer installed R version 3.2.2 on OpenBSD 5.8 arch
&lsquo;<samp>amd64</samp>&rsquo; (their name for &lsquo;<samp>x86_64</samp>&rsquo;).  Details of the build
(and patches applied) are at
<a href="https://cvsweb.openbsd.org/cgi-bin/cvsweb/ports/math/R/">https://cvsweb.openbsd.org/cgi-bin/cvsweb/ports/math/R/</a>. (Downgrading
the <code>zlib</code> requirement to 1.2.3 is against the advice of the R
developers.)
</p>
<hr>
</div>
<div class="section" id="Cygwin">
<div class="header">
<p>
Next: <a href="#New-platforms" accesskey="n" rel="next">New platforms</a>, Previous: <a href="#OpenBSD" accesskey="p" rel="prev">OpenBSD</a>, Up: <a href="#Platform-notes" accesskey="u" rel="up">Platform notes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Cygwin-1"></span><h3 class="section">C.6 Cygwin</h3>

<p>The 32-bit version never worked well enough to pass R&rsquo;s <code>make
check</code>, and residual support from earlier experiments was removed in
R 3.3.0.
</p>
<p>The 64-bit version was never supported.
</p>
<hr>
</div>
<div class="section" id="New-platforms">
<div class="header">
<p>
Previous: <a href="#Cygwin" accesskey="p" rel="prev">Cygwin</a>, Up: <a href="#Platform-notes" accesskey="u" rel="up">Platform notes</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="New-platforms-1"></span><h3 class="section">C.7 New platforms</h3>

<p>There are a number of sources of problems when installing R on a new
hardware/OS platform.  These include
</p>
<p><strong>Floating Point Arithmetic</strong>: R requires arithmetic compliant
with <acronym>IEC</acronym>&nbsp;60559, also known as <acronym>IEEE</acronym>&nbsp;754.
This mandates the use of plus and minus infinity and <code>NaN</code> (not a
number) as well as specific details of rounding.  Although almost all
current FPUs can support this, selecting such support can be a pain.
The problem is that there is no agreement on how to set the signalling
behaviour; Sun/Sparc, SGI/IRIX and &lsquo;<samp>ix86</samp>&rsquo; Linux require no
special action, FreeBSD requires a call to (the macro)
<code>fpsetmask(0)</code> and OSF1 required that computation be done with a
<samp>-ieee_with_inexact</samp> flag etc. With Intel compilers on 32-bit and
64-bit Intel machines, one has to explicitly disable flush-to-zero and
denormals-are-zero modes.  Some ARM processors including A12Z and M1
(Apple Silicon) by default use runfast mode, which includes
flush-to-zero and default-nan and hence has to be disabled.  With
default-nan mode, the NaN payload used for representation of numeric NA
values is lost even on simple operations with finite values. On a new
platform you must find out the magic recipe and add some code to make it
work.  This can often be done via the file <samp>config.site</samp> which
resides in the top level directory.
</p>
<p>Beware of using high levels of optimization, at least initially.  On
many compilers these reduce the degree of compliance to the
<acronym>IEEE</acronym> model.  For example, using <samp>-fast</samp> on the Oracle
compilers has caused R&rsquo;s <code>NaN</code> to be set incorrectly, and
<code>gcc</code>&rsquo;s <samp>-ffast-math</samp> and <code>clang</code>&rsquo;s
<samp>-Ofast</samp> have given incorrect results.
</p>
<p><strong>Shared Objects</strong>: There seems to be very little agreement
across platforms on what needs to be done to build shared objects.
there are many different combinations of flags for the compilers and
loaders.  <acronym>GNU</acronym> libtool cannot be used (yet), as it currently
does not fully support Fortran: one would need a shell wrapper for
this).  The technique we use is to first interrogate the X window system
about what it does (using <code>xmkmf</code>), and then override this in
situations where we know better (for tools from the <acronym>GNU</acronym>
Compiler Collection and/or platforms we know about).  This typically
works, but you may have to manually override the results.  Scanning the
manual entries for <code>cc</code> and <code>ld</code> usually reveals the
correct incantation.  Once you know the recipe you can modify the file
<samp>config.site</samp> (following the instructions therein) so that the
build will use these options.
</p>
<p>It seems that <code>gcc</code>&nbsp;3.4.x and later on &lsquo;<samp>ix86</samp>&rsquo; Linux
defeat attempts by the LAPACK code to avoid computations entirely in
extended-precision registers, so file <samp>src/modules/lapack/dlamc.f</samp>
may need to be compiled without optimization or with additional flags.
Set the configure variable <code>SAFE_FFLAGS</code> to the flags to be used for
this file.
</p>
<p>If you do manage to get R running on a new platform please let us
know about it so we can modify the configuration procedures to include
that platform.
</p>
<p>If you are having trouble getting R to work on your platform please
feel free to use the &lsquo;<samp>R-devel</samp>&rsquo; mailing list to ask questions.  We
have had a fair amount of practice at porting R to new platforms
<small class="enddots">...</small>
</p>
<hr>
</div>
</div>
<div class="unnumbered" id="Function-and-variable-index">
<div class="header">
<p>
Next: <a href="#Concept-index" accesskey="n" rel="next">Concept index</a>, Previous: <a href="#Platform-notes" accesskey="p" rel="prev">Platform notes</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Function-and-variable-index-1"></span><h2 class="unnumbered">Function and variable index</h2>

<table summary=""><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Function-and-variable-index_vr_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Function-and-variable-index_vr_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Function-and-variable-index_vr_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Function-and-variable-index_vr_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Function-and-variable-index_vr_letter-U"><b>U</b></a>
 &nbsp; 
</td></tr></table>
<table summary="" class="index-vr" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Function-and-variable-index_vr_letter-C">C</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-configure"><code>configure</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Simple-compilation">Simple compilation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-configure-1"><code>configure</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Simple-compilation">Simple compilation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-configure-2"><code>configure</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installation">Installation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-configure-3"><code>configure</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installation">Installation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-configure-4"><code>configure</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Configuration-variables">Configuration variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-configure-5"><code>configure</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-make">Using make</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Function-and-variable-index_vr_letter-I">I</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-install_002epackages"><code>install.packages</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installing-packages">Installing packages</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Function-and-variable-index_vr_letter-M">M</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-make"><code>make</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-make">Using make</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Function-and-variable-index_vr_letter-R">R</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-remove_002epackages"><code>remove.packages</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Removing-packages">Removing packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fHOME"><code>R_HOME</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Simple-compilation">Simple compilation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Function-and-variable-index_vr_letter-U">U</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-update_002epackages"><code>update.packages</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Updating-packages">Updating packages</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table summary=""><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Function-and-variable-index_vr_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Function-and-variable-index_vr_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Function-and-variable-index_vr_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Function-and-variable-index_vr_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Function-and-variable-index_vr_letter-U"><b>U</b></a>
 &nbsp; 
</td></tr></table>

<hr>
</div>
<div class="unnumbered" id="Concept-index">
<div class="header">
<p>
Next: <a href="#Environment-variable-index" accesskey="n" rel="next">Environment variable index</a>, Previous: <a href="#Function-and-variable-index" accesskey="p" rel="prev">Function and variable index</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Concept-index-1"></span><h2 class="unnumbered">Concept index</h2>

<table summary=""><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concept-index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-V"><b>V</b></a>
 &nbsp; 
</td></tr></table>
<table summary="" class="index-cp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-B">B</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-BLAS-library">BLAS library</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Linear-algebra">Linear algebra</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-BLAS-library-1">BLAS library</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Other-libraries">Other libraries</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-C">C</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cairo">Cairo</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installing-R-under-macOS">Installing R under macOS</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cairo-1">Cairo</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Useful-libraries-and-programs">Useful libraries and programs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cairo-2">Cairo</a>:</td><td>&nbsp;</td><td valign="top"><a href="#X11-issues">X11 issues</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cairo-3">Cairo</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cairo-graphics">Cairo graphics</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-F">F</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Fortran">Fortran</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-Fortran">Using Fortran</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FreeBSD">FreeBSD</a>:</td><td>&nbsp;</td><td valign="top"><a href="#FreeBSD">FreeBSD</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-I">I</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Installation">Installation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installation">Installation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Installing-under-Unix_002dalikes">Installing under Unix-alikes</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installing-R-under-Unix_002dalikes">Installing R under Unix-alikes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Installing-under-Windows">Installing under Windows</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installing-R-under-Windows">Installing R under Windows</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Internationalization">Internationalization</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Internationalization">Internationalization</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-L">L</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-LAPACK-library">LAPACK library</a>:</td><td>&nbsp;</td><td valign="top"><a href="#LAPACK">LAPACK</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LAPACK-library-1">LAPACK library</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Other-libraries">Other libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Libraries">Libraries</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add_002don-packages">Add-on packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Libraries_002c-managing">Libraries, managing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Managing-libraries">Managing libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Libraries_002c-site">Libraries, site</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Managing-libraries">Managing libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Libraries_002c-user">Libraries, user</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Managing-libraries">Managing libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Linux">Linux</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installing-R-under-Unix_002dalikes">Installing R under Unix-alikes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Linux-1">Linux</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Linux">Linux</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Locale">Locale</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Internationalization">Internationalization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Locale-1">Locale</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Locales">Locales</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Localization">Localization</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Internationalization">Internationalization</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-M">M</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-macOS">macOS</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installing-R-under-Unix_002dalikes">Installing R under Unix-alikes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macOS-1">macOS</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installing-R-under-macOS">Installing R under macOS</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macOS-2">macOS</a>:</td><td>&nbsp;</td><td valign="top"><a href="#macOS">macOS</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Manuals">Manuals</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Making-the-manuals">Making the manuals</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Manuals_002c-installing">Manuals, installing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installation">Installation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-O">O</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Obtaining-R">Obtaining R</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-R">Obtaining R</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-OpenBSD">OpenBSD</a>:</td><td>&nbsp;</td><td valign="top"><a href="#OpenBSD">OpenBSD</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-P">P</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packages">Packages</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add_002don-packages">Add-on packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packages_002c-default">Packages, default</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Default-packages">Default packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packages_002c-installing">Packages, installing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installing-packages">Installing packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packages_002c-removing">Packages, removing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Removing-packages">Removing packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packages_002c-updating">Packages, updating</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Updating-packages">Updating packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Pango">Pango</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Useful-libraries-and-programs">Useful libraries and programs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Pango-1">Pango</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cairo-graphics">Cairo graphics</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-R">R</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Repositories">Repositories</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-up-a-package-repository">Setting up a package repository</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-S">S</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Site-libraries">Site libraries</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Managing-libraries">Managing libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Sources-for-R">Sources for R</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Getting-and-unpacking-the-sources">Getting and unpacking the sources</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Subversion">Subversion</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-Subversion-and-rsync">Using Subversion and rsync</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Subversion-1">Subversion</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Essential-programs-and-libraries">Essential programs and libraries</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-U">U</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-User-libraries">User libraries</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Managing-libraries">Managing libraries</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-V">V</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Vignettes">Vignettes</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Essential-programs-and-libraries">Essential programs and libraries</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table summary=""><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concept-index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-V"><b>V</b></a>
 &nbsp; 
</td></tr></table>

<hr>
</div>
<div class="unnumbered" id="Environment-variable-index">
<div class="header">
<p>
Previous: <a href="#Concept-index" accesskey="p" rel="prev">Concept index</a>, Up: <a href="#Top" accesskey="u" rel="up">R Installation and Administration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Function-and-variable-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Environment-variable-index-1"></span><h2 class="unnumbered">Environment variable index</h2>

<table summary=""><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Environment-variable-index_en_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-T"><b>T</b></a>
 &nbsp; 
</td></tr></table>
<table summary="" class="index-en" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Environment-variable-index_en_letter-B">B</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-BLAS_005fLIBS"><code>BLAS_LIBS</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#BLAS">BLAS</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Environment-variable-index_en_letter-C">C</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-CONFIG_005fSITE"><code>CONFIG_SITE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Configuration-variables">Configuration variables</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Environment-variable-index_en_letter-D">D</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-DESTDIR"><code>DESTDIR</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installation">Installation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-DESTDIR-1"><code>DESTDIR</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Unix_002dalike-standalone">Unix-alike standalone</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Environment-variable-index_en_letter-J">J</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-JAVA_005fHOME"><code>JAVA_HOME</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Java-support">Java support</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Environment-variable-index_en_letter-L">L</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-LANG"><code>LANG</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Localization-of-messages">Localization of messages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LANGUAGE"><code>LANGUAGE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Localization-of-messages">Localization of messages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LANGUAGE-1"><code>LANGUAGE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Localization-of-messages">Localization of messages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LAPACK_005fLIBS"><code>LAPACK_LIBS</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#LAPACK">LAPACK</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LC_005fALL"><code>LC_ALL</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Localization-of-messages">Localization of messages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LC_005fCOLLATE"><code>LC_COLLATE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Testing-a-Unix_002dalike-Installation">Testing a Unix-alike Installation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LC_005fMESSAGES"><code>LC_MESSAGES</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Localization-of-messages">Localization of messages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LD_005fLIBRARY_005fPATH"><code>LD_LIBRARY_PATH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Unix_002dalike-standalone">Unix-alike standalone</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LD_005fLIBRARY_005fPATH-1"><code>LD_LIBRARY_PATH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-Fortran">Using Fortran</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LD_005fLIBRARY_005fPATH-2"><code>LD_LIBRARY_PATH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Compile-and-load-flags">Compile and load flags</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Environment-variable-index_en_letter-P">P</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-PAPERSIZE"><code>PAPERSIZE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-paper-size">Setting paper size</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PATH"><code>PATH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Essential-programs-and-libraries">Essential programs and libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PATH-1"><code>PATH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-Fortran">Using Fortran</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Environment-variable-index_en_letter-R">R</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fARCH"><code>R_ARCH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Sub_002darchitectures">Sub-architectures</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fARCH-1"><code>R_ARCH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Sub_002darchitectures">Sub-architectures</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fBROWSER"><code>R_BROWSER</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-the-browsers">Setting the browsers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fDEFAULT_005fPACKAGES"><code>R_DEFAULT_PACKAGES</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Default-packages">Default packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fDISABLE_005fHTTPD"><code>R_DISABLE_HTTPD</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Help-options">Help options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fGSCMD"><code>R_GSCMD</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Useful-libraries-and-programs">Useful libraries and programs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fINSTALL_005fTAR"><code>R_INSTALL_TAR</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Windows-packages">Windows packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fJAVA_005fLD_005fLIBRARY_005fPATH"><code>R_JAVA_LD_LIBRARY_PATH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Java-support">Java support</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fJAVA_005fLD_005fLIBRARY_005fPATH-1"><code>R_JAVA_LD_LIBRARY_PATH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Java-support">Java support</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fLIBS"><code>R_LIBS</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add_002don-packages">Add-on packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fLIBS_005fSITE"><code>R_LIBS_SITE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Managing-libraries">Managing libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fLIBS_005fUSER"><code>R_LIBS_USER</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Managing-libraries">Managing libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fPAPERSIZE"><code>R_PAPERSIZE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Making-the-manuals">Making the manuals</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fPAPERSIZE-1"><code>R_PAPERSIZE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-R">Running R</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fPAPERSIZE-2"><code>R_PAPERSIZE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-paper-size">Setting paper size</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fPAPERSIZE-3"><code>R_PAPERSIZE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Making-manuals">Making manuals</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fPDFVIEWER"><code>R_PDFVIEWER</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-the-browsers">Setting the browsers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fRD4PDF"><code>R_RD4PDF</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Making-the-manuals">Making the manuals</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fRD4PDF-1"><code>R_RD4PDF</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Making-manuals">Making manuals</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fSCRIPT_005fDEFAULT_005fPACKAGES"><code>R_SCRIPT_DEFAULT_PACKAGES</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Default-packages">Default packages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-R_005fUSER"><code>R_USER</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-R">Running R</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Environment-variable-index_en_letter-T">T</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-TAR"><code>TAR</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Essential-programs-and-libraries">Essential programs and libraries</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TAR_005fOPTIONS"><code>TAR_OPTIONS</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Getting-and-unpacking-the-sources">Getting and unpacking the sources</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TEMP"><code>TEMP</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-R">Running R</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TMP"><code>TMP</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-R">Running R</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TMPDIR"><code>TMPDIR</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Simple-compilation">Simple compilation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TMPDIR-1"><code>TMPDIR</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-R">Running R</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TMPDIR-2"><code>TMPDIR</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-R">Running R</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TMPDIR-3"><code>TMPDIR</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installing-packages">Installing packages</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table summary=""><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Environment-variable-index_en_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Environment-variable-index_en_letter-T"><b>T</b></a>
 &nbsp; 
</td></tr></table>


</div>
</div>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5><a id="FOOT1" href="#DOCF1">(1)</a></h5>
<p>e.g. <acronym>GNU</acronym>
<code>tar</code> version 1.15 or later, or that from the &lsquo;<samp>libarchive</samp>&rsquo;
(as used on macOS) or &lsquo;Heirloom Toolchest&rsquo; distributions.</p>
<h5><a id="FOOT2" href="#DOCF2">(2)</a></h5>
<p>for some Subversion clients
&lsquo;<samp>http:</samp>&rsquo; may appear to work, but requires continual redirection.</p>
<h5><a id="FOOT3" href="#DOCF3">(3)</a></h5>
<p>aka &lsquo;Apple Silicon&rsquo;, known to
some as &lsquo;<samp>arm64-apple-darwin</samp>&rsquo;.</p>
<h5><a id="FOOT4" href="#DOCF4">(4)</a></h5>
<p>Most aspects will work with
paths containing spaces, but external software used by R may not.</p>
<h5><a id="FOOT5" href="#DOCF5">(5)</a></h5>
<p>which use <samp>lib</samp> rather than
<samp>lib64</samp> for their primary 64-bit library directories: attempts are
made to detect such systems.</p>
<h5><a id="FOOT6" href="#DOCF6">(6)</a></h5>
<p>Instructions
on how to install the latest version are at
<a href="https://www.ctan.org/tex-archive/fonts/inconsolata/">https://www.ctan.org/tex-archive/fonts/inconsolata/</a>.</p>
<h5><a id="FOOT7" href="#DOCF7">(7)</a></h5>
<p>on a
Unix-alike, &lsquo;<samp>inconsolata</samp>&rsquo; is omitted if not found by
<code>configure</code>.</p>
<h5><a id="FOOT8" href="#DOCF8">(8)</a></h5>
<p>This will be needed if more than one
sub-architecture is to be installed.</p>
<h5><a id="FOOT9" href="#DOCF9">(9)</a></h5>
<p>with possible values
&lsquo;<samp>i386</samp>&rsquo;, &lsquo;<samp>x64</samp>&rsquo;, &lsquo;<samp>32</samp>&rsquo; and &lsquo;<samp>64</samp>&rsquo;.</p>
<h5><a id="FOOT10" href="#DOCF10">(10)</a></h5>
<p>mainly on RedHat and Fedora, whose
layout is described here.</p>
<h5><a id="FOOT11" href="#DOCF11">(11)</a></h5>
<p>How to prepare such a directory is described in file
<samp>src/extra/tzone/Notes</samp> in the R sources.</p>
<h5><a id="FOOT12" href="#DOCF12">(12)</a></h5>
<p>But on Windows problems have been seen with
case-changing functions on accented Latin-1 characters.</p>
<h5><a id="FOOT13" href="#DOCF13">(13)</a></h5>
<p>for
example, <samp>-fopenmp</samp>, <samp>-xopenmp</samp> or <samp>-qopenmp</samp>.
This includes for <code>clang</code> and the Intel and Oracle compilers.</p>
<h5><a id="FOOT14" href="#DOCF14">(14)</a></h5>
<p>This does not necessarily disable <em>use</em> of
OpenMP &ndash; the <code>configure</code> code allows for platforms where OpenMP
is used without a flag. For the <code>flang</code> compiler in late 2017,
the Fortran runtime always used OpenMP.</p>
<h5><a id="FOOT15" href="#DOCF15">(15)</a></h5>
<p>This was a valid option for
<code>g++</code> 5 and later and 2016 versions of the Intel and Solaris
compilers.  For earlier versions of <code>g++</code> one could try
<samp>-std=c++1y</samp>.</p>
<h5><a id="FOOT16" href="#DOCF16">(16)</a></h5>
<p>Then recommended packages
installed as part of the R installation do use LTO, but not packages
installed later.</p>
<h5><a id="FOOT17" href="#DOCF17">(17)</a></h5>
<p>A complete <acronym>CRAN</acronym> installation reduced from 50
to 35GB.</p>
<h5><a id="FOOT18" href="#DOCF18">(18)</a></h5>
<p>although there is the possibility to
exclude Fortran but that misses some of the benefits.</p>
<h5><a id="FOOT19" href="#DOCF19">(19)</a></h5>
<p>not <code>NM</code> as we found <code>make</code>
overriding that.</p>
<h5><a id="FOOT20" href="#DOCF20">(20)</a></h5>
<p>probably
also 8.4 and later.</p>
<h5><a id="FOOT21" href="#DOCF21">(21)</a></h5>
<p>There are reports of segfaults when &lsquo;<samp>MiKTeX</samp>&rsquo;
installs additional packages when making <samp>NEWS.pdf</samp>: re-running
<code>make</code> seems to solve this.</p>
<h5><a id="FOOT22" href="#DOCF22">(22)</a></h5>
<p>You may be asked to install Rosetta
at first use &ndash; <a href="https://support.apple.com/en-us/HT211861">https://support.apple.com/en-us/HT211861</a> &ndash; which
may need administrator privileges.</p>
<h5><a id="FOOT23" href="#DOCF23">(23)</a></h5>
<p>At the time of
writing the Intel distribution was built/tested against 2.7.11 for
compatibility with R 4.0.0: the &lsquo;<samp>arm64</samp>&rsquo; one against 2.8.1.</p>
<h5><a id="FOOT24" href="#DOCF24">(24)</a></h5>
<p>If <code>otool</code> is installed: it is part of the macOS
Command Line Tools.</p>
<h5><a id="FOOT25" href="#DOCF25">(25)</a></h5>
<p>The installer puts links to <code>R</code> and
<code>Rscript</code> in <samp>/usr/local/bin</samp>.  If these are missing or
that is not on your path, you can run directly the copies in
<samp>/Library/Frameworks/R.framework/Resources/bin</samp> or link those
yourself to somewhere on your path.</p>
<h5><a id="FOOT26" href="#DOCF26">(26)</a></h5>
<p>At the
time of writing: use <code>pkgutil --pkgs | grep -i org.r-project</code> to
check..</p>
<h5><a id="FOOT27" href="#DOCF27">(27)</a></h5>
<p>More precisely,
of the Apple package of the same name: this means that installing a
package for 3.6.x does not remove an installation for 4.0 or later, and
that Intel and ARM versions can be installed together, apart from
<code>org.R-project.R.GUI.pkg</code>.</p>
<h5><a id="FOOT28" href="#DOCF28">(28)</a></h5>
<p>Including GCC 9 on Linux.</p>
<h5><a id="FOOT29" href="#DOCF29">(29)</a></h5>
<p>unless they were excluded in the build.</p>
<h5><a id="FOOT30" href="#DOCF30">(30)</a></h5>
<p>its binding is locked once the startup files have been
read, so users cannot easily change it. See <code>?.libPaths</code> for how
to make use of the new value.</p>
<h5><a id="FOOT31" href="#DOCF31">(31)</a></h5>
<p>If a proxy needs to be set, see
<code>?download.file</code>.</p>
<h5><a id="FOOT32" href="#DOCF32">(32)</a></h5>
<p>for a small number of
<acronym>CRAN</acronym> packages where this is known to be safe and is needed by
the autobuilder this is the default.  Look at the source of
<samp>tools:::.install_packages</samp> for the list.  It can also be specified
in the package&rsquo;s <samp>DESCRIPTION</samp> file.</p>
<h5><a id="FOOT33" href="#DOCF33">(33)</a></h5>
<p>Note that capitalization and versioning may
differ from the Open Source project.</p>
<h5><a id="FOOT34" href="#DOCF34">(34)</a></h5>
<p>no longer a system library in macOS 11.</p>
<h5><a id="FOOT35" href="#DOCF35">(35)</a></h5>
<p>From Big Sur those libraries are not
publicly visible: rather the system compilers link to &lsquo;text-based
definition&rsquo; (<samp>.tbd</samp>) files.</p>
<h5><a id="FOOT36" href="#DOCF36">(36)</a></h5>
<p>using a path containing spaces is likely to cause
problems</p>
<h5><a id="FOOT37" href="#DOCF37">(37)</a></h5>
<p>They need
to have been created using <samp>-headerpad_max_install_names</samp>, which
is the default for an R package.</p>
<h5><a id="FOOT38" href="#DOCF38">(38)</a></h5>
<p>&lsquo;X/Open Portability Guide&rsquo;, which has
had several versions.</p>
<h5><a id="FOOT39" href="#DOCF39">(39)</a></h5>
<p>On some systems setting
<code>LC_ALL</code> or <code>LC_MESSAGES</code> to &lsquo;<samp>C</samp>&rsquo; disables <code>LANGUAGE</code>.</p>
<h5><a id="FOOT40" href="#DOCF40">(40)</a></h5>
<p>If you try changing from French
to Russian except in a UTF-8 locale, you may find messages change to
English.</p>
<h5><a id="FOOT41" href="#DOCF41">(41)</a></h5>
<p>the
language written in England: some people living in the USA appropriate
this name for their language.</p>
<h5><a id="FOOT42" href="#DOCF42">(42)</a></h5>
<p>with
Americanisms.</p>
<h5><a id="FOOT43" href="#DOCF43">(43)</a></h5>
<p>also
known as <acronym>IEEE</acronym>&nbsp;754</p>
<h5><a id="FOOT44" href="#DOCF44">(44)</a></h5>
<p>at least when storing quantities: the
on-FPU precision is allowed to vary</p>
<h5><a id="FOOT45" href="#DOCF45">(45)</a></h5>
<p>e.g. Bessel, beta and gamma functions</p>
<h5><a id="FOOT46" href="#DOCF46">(46)</a></h5>
<p>including copying <samp>MkRules.dist</samp> to
<samp>MkRule.local</samp> and selecting the architecture.</p>
<h5><a id="FOOT47" href="#DOCF47">(47)</a></h5>
<p>also known as
<acronym>IEEE</acronym>&nbsp;754</p>
<h5><a id="FOOT48" href="#DOCF48">(48)</a></h5>
<p>Note
that C11 compilers need not be C99-compliant: R requires support for
<code>double complex</code> and variable-length arrays which are optional in
C11 but are mandatory in C99.  C18 (also known as C17) is a &lsquo;bugfix
release&rsquo; of C11, clarifying the standard.</p>
<h5><a id="FOOT49" href="#DOCF49">(49)</a></h5>
<p>Examples are <samp>-std=gnu99</samp>, <samp>-std=c99</samp> and
<samp>-c99</samp>.</p>
<h5><a id="FOOT50" href="#DOCF50">(50)</a></h5>
<p><samp>-std=c99</samp> excludes POSIX
functionality, but <samp>config.h</samp> will turn on all <acronym>GNU</acronym>
extensions to include the POSIX functionality for R itself: this does
not apply to badly-written packages.  The default mode for GCC 5.1 and
later is <samp>-std=gnu11</samp>, which currently includes the optional
features R needs.</p>
<h5><a id="FOOT51" href="#DOCF51">(51)</a></h5>
<p>However, it is possible to break
the default behaviour of <code>glibc</code> by re-specifying the <code>gconv</code>
modules to be loaded.</p>
<h5><a id="FOOT52" href="#DOCF52">(52)</a></h5>
<p>specifically, the C99
functionality of headers <samp>wchar.h</samp> and <samp>wctype.h</samp>, types
<code>wctans_t</code> and <code>mbstate_t</code> and functions <code>mbrtowc</code>,
<code>mbstowcs</code>, <code>wcrtomb</code>, <code>wcscoll</code>, <code>wcstombs</code>,
<code>wctrans</code>, <code>wctype</code>, and <code>iswctype</code>.</p>
<h5><a id="FOOT53" href="#DOCF53">(53)</a></h5>
<p>including <code>expm1</code>, <code>hypot</code>, <code>log1p</code>,
<code>nearbyint</code> and <code>va_copy</code>.</p>
<h5><a id="FOOT54" href="#DOCF54">(54)</a></h5>
<p>including
<code>opendir</code>, <code>readdir</code>, <code>closedir</code>, <code>popen</code>,
<code>stat</code>, <code>glob</code>, <code>access</code>, <code>getcwd</code> and <code>chdir</code>
system calls, <code>select</code> on a Unix-alike, and either <code>putenv</code> or
<code>setenv</code>.</p>
<h5><a id="FOOT55" href="#DOCF55">(55)</a></h5>
<p>such as
<code>realpath</code>, <code>symlink</code>.</p>
<h5><a id="FOOT56" href="#DOCF56">(56)</a></h5>
<p>most often distributed as part of <code>xz</code>:
possible names in Linux distributions include
<code>xz-devel</code>/<code>xz-libs</code> and <code>liblzma-dev</code>.</p>
<h5><a id="FOOT57" href="#DOCF57">(57)</a></h5>
<p>but not a major
version greater than 7 should there ever be one: the major version has
been 7 since 2000.</p>
<h5><a id="FOOT58" href="#DOCF58">(58)</a></h5>
<p>for example to specify static linking with a
build which has both shared and static libraries.</p>
<h5><a id="FOOT59" href="#DOCF59">(59)</a></h5>
<p>Such as
<acronym>GNU</acronym> <code>tar</code> 1.15 or later, <code>bsdtar</code> (from
<a href="https://github.com/libarchive/libarchive/">https://github.com/libarchive/libarchive/</a>, used as
<code>tar</code> by FreeBSD and macOS 10.6 and later) or <code>tar</code> from
the Heirloom Toolchest
(<a href="http://heirloom.sourceforge.net/tools.html">http://heirloom.sourceforge.net/tools.html</a>), although the
latter does not support <code>xz</code> compression.</p>
<h5><a id="FOOT60" href="#DOCF60">(60)</a></h5>
<p><code>texi2dvi</code> is normally a shell
script.  Some of the issues which have been observed with broken
versions of <code>texi2dvi</code> can be circumvented by setting the
environment variable <code>R_TEXI2DVICMD</code> to the value <code>emulation</code>.</p>
<h5><a id="FOOT61" href="#DOCF61">(61)</a></h5>
<p>If necessary the path to
<code>pkg-config</code> can be specified by setting <code>PKG_CONFIG</code> in
<samp>config.site</samp>, on the <code>configure</code> command line or in the
environment. There is a compatible re-implementation of
<code>pkg-config</code> called <code>pkgconf</code> which can be used in the
unlikely event that is installed but not linked to
<code>pkg-config</code>.</p>
<h5><a id="FOOT62" href="#DOCF62">(62)</a></h5>
<p>also known as <code>ttf-mscorefonts-installer</code> in the
Debian/Ubuntu world: see also
<a href="https://en.wikipedia.org/wiki/Core_fonts_for_the_Web">https://en.wikipedia.org/wiki/Core_fonts_for_the_Web</a>.</p>
<h5><a id="FOOT63" href="#DOCF63">(63)</a></h5>
<p><code>ttf-liberation</code>
in Debian/Ubuntu.</p>
<h5><a id="FOOT64" href="#DOCF64">(64)</a></h5>
<p>Including that used by
Fedora.</p>
<h5><a id="FOOT65" href="#DOCF65">(65)</a></h5>
<p>R
uses <samp>rpc/xdr.h</samp> but that includes <samp>netconfig.h</samp> from the top
<samp>tirpc</samp> directory.</p>
<h5><a id="FOOT66" href="#DOCF66">(66)</a></h5>
<p>This is true even for
the &lsquo;Aqua&rsquo; version of Tk on macOS, but distributions of that include a
copy of the X11 files needed.</p>
<h5><a id="FOOT67" href="#DOCF67">(67)</a></h5>
<p>The search
order is currently OpenBLAS, BLIS, ATLAS, platform-specific choices (see
below) and finally a generic <samp>libblas</samp>.</p>
<h5><a id="FOOT68" href="#DOCF68">(68)</a></h5>
<p>Using
the Oracle Developer Studio <code>cc</code> and <code>f95</code> compilers</p>
<h5><a id="FOOT69" href="#DOCF69">(69)</a></h5>
<p>The only way to see
exactly which CPUs the distributed libraries have been tuned for is to
read the <samp>atlas.spec</samp> file.</p>
<h5><a id="FOOT70" href="#DOCF70">(70)</a></h5>
<p><a href="http://math-atlas.sourceforge.net/atlas_install/">http://math-atlas.sourceforge.net/atlas_install/</a></p>
<h5><a id="FOOT71" href="#DOCF71">(71)</a></h5>
<p><a href="http://math-atlas.sourceforge.net/faq.html#tnum">http://math-atlas.sourceforge.net/faq.html#tnum</a></p>
<h5><a id="FOOT72" href="#DOCF72">(72)</a></h5>
<p>(and more, e.g. for 64-bit ints and static versions).</p>
<h5><a id="FOOT73" href="#DOCF73">(73)</a></h5>
<p>Sometimes known as
&lsquo;Intel oneAPI Math Kernel Library&rsquo; or even &lsquo;oneMKL&rsquo;.</p>
<h5><a id="FOOT74" href="#DOCF74">(74)</a></h5>
<p>The issue for macOS
has been the use of double-complex routines.</p>
<h5><a id="FOOT75" href="#DOCF75">(75)</a></h5>
<p>We have measured 15&ndash;20% on &lsquo;<samp>i686</samp>&rsquo; Linux
and around 10% on &lsquo;<samp>x86_64</samp>&rsquo; Linux.</p>
<h5><a id="FOOT76" href="#DOCF76">(76)</a></h5>
<p>We believe that
versions 3.4.0 to 3.15.0 are compatible.</p>
<h5><a id="FOOT77" href="#DOCF77">(77)</a></h5>
<p>at the time of revision of
this para in late 2021, <strong>autoconf-2.71</strong> and <strong>automake-1.16.5</strong>.</p>
<h5><a id="FOOT78" href="#DOCF78">(78)</a></h5>
<p>The links
there have proved difficult to access, in which case grab the copy
made available at
<a href="https://developer.r-project.org/noweb-2.11b.tgz">https://developer.r-project.org/noweb-2.11b.tgz</a>.</p>
<h5><a id="FOOT79" href="#DOCF79">(79)</a></h5>
<p>for example, <code>X11 font at size 14 could not
be loaded</code>.</p>
<h5><a id="FOOT80" href="#DOCF80">(80)</a></h5>
<p>For example, <code>glibc</code>: other C libraries such as
<code>musl</code> have been used but are not routinely tested.</p>
<h5><a id="FOOT81" href="#DOCF81">(81)</a></h5>
<p>Likely all since
2005, including Pentium 4 and all &lsquo;<samp>x86_64</samp>&rsquo; CPUs with 32-bit
compilers.</p>
<h5><a id="FOOT82" href="#DOCF82">(82)</a></h5>
<p>This
also needs the OpenMP runtime which has sometimes been distributed
separately.</p>
<h5><a id="FOOT83" href="#DOCF83">(83)</a></h5>
<p>If compiling it from source on
&lsquo;<samp>arm64</samp>&rsquo;, <code>pcre2</code> (at least up to version 10.39) needs to
be built without JIT support (the default) as the R build segfaults
if that is enabled, so do run <code>make check</code> on your build.</p>
<h5><a id="FOOT84" href="#DOCF84">(84)</a></h5>
<p>For licence reasons this is version
5.2 of <code>readline</code>: for those who want a more recent version it is
straightforward to compile it from its sources.</p>
<h5><a id="FOOT85" href="#DOCF85">(85)</a></h5>
<p>but as a stub invoking an executable provided by the
Command Line Tools and the latter is not in versions 11.5 and later of
the Command Line Tools.</p>
<h5><a id="FOOT86" href="#DOCF86">(86)</a></h5>
<p>See
<a href="https://developer.apple.com/documentation/xcode/notarizing_macos_software_before_distribution">https://developer.apple.com/documentation/xcode/notarizing_macos_software_before_distribution</a>.</p>
<h5><a id="FOOT87" href="#DOCF87">(87)</a></h5>
<p>such
as being unable to find <code>-lm</code>.</p>
<h5><a id="FOOT88" href="#DOCF88">(88)</a></h5>
<p>with <code>gcc</code> 10.2.</p>
<h5><a id="FOOT89" href="#DOCF89">(89)</a></h5>
<p><a href="https://developer.apple.com/documentation/accelerate">https://developer.apple.com/documentation/accelerate</a>.</p>
<h5><a id="FOOT90" href="#DOCF90">(90)</a></h5>
<p>It has been reported that for some
non-Apple toolchains <code>CPPFLAGS</code> needed to contain
<code>-D__ACCELERATE__</code>: not needed for <code>clang</code> from
<a href="https://releases.llvm.org">https://releases.llvm.org</a>.</p>
<h5><a id="FOOT91" href="#DOCF91">(91)</a></h5>
<p><a href="https://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html#Which-BLAS-is-used-and-how-can-it-be-changed_003f">https://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html#Which-BLAS-is-used-and-how-can-it-be-changed_003f</a></p>
<h5><a id="FOOT92" href="#DOCF92">(92)</a></h5>
<p>An essentially equivalent TeX installation can be
obtained by the Unix TeX Live installation scripts.</p>
<h5><a id="FOOT93" href="#DOCF93">(93)</a></h5>
<p>E.g. <em>via</em> <code>tlmgr install helvetic
inconsolata texinfo</code> .</p>
<h5><a id="FOOT94" href="#DOCF94">(94)</a></h5>
<p>Adding all the
packages needed to check <acronym>CRAN</acronym> increased this to about 600MB.</p>
<h5><a id="FOOT95" href="#DOCF95">(95)</a></h5>
<p>which amount to installing MacTeX 2020 (whose
LaTeX packages are frozen) or TeXLive 2022 (which has been tried and has
current updates).</p>
<h5><a id="FOOT96" href="#DOCF96">(96)</a></h5>
<p>Just that component can be selected from the installer
for R: at the &lsquo;Installation Type&rsquo; screen select &lsquo;Customise&rsquo; and then
just the &lsquo;Tcl/Tk 8.6.11&rsquo; component.</p>
<h5><a id="FOOT97" href="#DOCF97">(97)</a></h5>
<p>At the time of writing the
Intel distribution used 2.7.11 and the &lsquo;<samp>arm64</samp>&rsquo; one used 2.8.1.</p>
<h5><a id="FOOT98" href="#DOCF98">(98)</a></h5>
<p>Configure
Tk with <samp>--enable-aqua</samp>.</p>
<h5><a id="FOOT99" href="#DOCF99">(99)</a></h5>
<p>In the unlikely event that the version reported does
not start with <code>1.8.0</code>, <code>11</code> or higher you need to update your
Java.</p>
<h5><a id="FOOT100" href="#DOCF100">(100)</a></h5>
<p>Not at the time of
writing for &lsquo;<samp>arm64</samp>&rsquo;.</p>
</div>



</body>
</html>
